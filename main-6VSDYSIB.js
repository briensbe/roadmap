import{$ as ro,$a as ho,$b as Gr,A as no,Aa as go,Ab as xn,Ac as ne,B as Wt,Ba as R,Bb as Dr,Bc as K,C as Gn,Ca as Sr,Cb as bt,Cc as di,D as Ct,Da as Or,Db as Ar,Dc as ie,E as io,Ea as fo,Eb as Nr,Ec as oe,F as dr,Fa as B,Fb as Xn,Fc as ke,G as pr,Ga as Je,Gb as Lr,Gc as Ee,H as ur,Ha as Cn,Hb as ei,Hc as re,I as Ve,Ia as w,Ib as bn,Ic as Te,J as oo,Ja as kr,Jb as zr,Jc as Pt,K as he,Ka as Er,Kb as Fr,Kc as Fe,L as le,La as Tr,Lb as qr,Lc as qe,M as mr,Ma as Ir,Mb as ti,Mc as Ue,N as A,Na as _e,Nb as ni,Nc as oa,O as He,Oa as F,Ob as Oe,Oc as Zt,P as gr,Pa as q,Pb as te,Pc as Ie,Q as Ce,Qa as Bt,Qb as Ur,Qc as pi,R as V,Ra as ue,Rb as Wr,Rc as X,S as j,Sa as me,Sb as ii,Sc as ra,T as fr,Ta as g,Tb as G,Tc as H,U as hr,Ua as s,Ub as $r,Uc as aa,V as $t,Va as l,Vb as Br,W as Ge,Wa as y,Wb as Hr,X as f,Xa as pt,Xb as oi,Y as h,Ya as ut,Yb as wt,Z as xt,Za as be,Zb as ri,_ as Dt,_a as we,_b as ai,a as I,aa as ze,ab as S,ac as yt,b as ge,ba as _r,bb as jr,bc as Jr,c as ir,ca as ao,cb as v,cc as Mt,d as _,da as Jn,db as Kn,dc as Yr,e as or,ea as ee,eb as u,ec as Gt,f as rr,fa as vr,fb as Rr,fc as Qr,g as ar,ga as dt,gb as At,gc as Jt,h as Zi,ha as so,hb as mt,hc as Kr,i as Xi,ia as Cr,ib as gt,ic as Yt,j as lt,ja as lo,jb as Ht,jc as Qt,k as Pe,ka as xr,kb as z,kc as Zr,l as ct,la as co,lb as $,lc as si,m as je,ma as br,mb as p,mc as Xr,n as N,na as Yn,nb as O,o as hn,oa as po,ob as P,oc as Kt,p as sr,pa as uo,pb as Se,pc as ea,q as lr,qa as mo,qb as Zn,r as Z,ra as wr,rb as k,rc as Ye,s as eo,sa as Qn,sb as E,t as Re,ta as c,tb as T,tc as ta,u as to,ua as _n,ub as Vr,uc as na,v as cr,va as yr,vb as ft,vc as li,w as Hn,wa as Mr,wb as _o,wc as ci,x as vt,xa as xe,xb as vo,xc as Ze,y as Vt,ya as vn,yb as ce,yc as Xe,z as Ut,za as Pr,zb as de,zc as ia}from"./chunk-DKK5APDB.js";var wn=class{_doc;constructor(r){this._doc=r}manager},ui=(()=>{class i extends wn{constructor(n){super(n)}supports(n){return!0}addEventListener(n,e,t,o){return n.addEventListener(e,t,o),()=>this.removeEventListener(n,e,t,o)}removeEventListener(n,e,t,o){return n.removeEventListener(e,t,o)}static \u0275fac=function(e){return new(e||i)(V(ze))};static \u0275prov=A({token:i,factory:i.\u0275fac})}return i})(),gi=new Ce(""),yo=(()=>{class i{_zone;_plugins;_eventNameToPlugin=new Map;constructor(n,e){this._zone=e,n.forEach(a=>{a.manager=this});let t=n.filter(a=>!(a instanceof ui));this._plugins=t.slice().reverse();let o=n.find(a=>a instanceof ui);o&&this._plugins.push(o)}addEventListener(n,e,t,o){return this._findPluginFor(e).addEventListener(n,e,t,o)}getZone(){return this._zone}_findPluginFor(n){let e=this._eventNameToPlugin.get(n);if(e)return e;if(e=this._plugins.find(o=>o.supports(n)),!e)throw new le(5101,!1);return this._eventNameToPlugin.set(n,e),e}static \u0275fac=function(e){return new(e||i)(V(gi),V(vn))};static \u0275prov=A({token:i,factory:i.\u0275fac})}return i})(),Co="ng-app-id";function sa(i){for(let r of i)r.remove()}function la(i,r){let n=r.createElement("style");return n.textContent=i,n}function js(i,r,n,e){let t=i.head?.querySelectorAll(`style[${Co}="${r}"],link[${Co}="${r}"]`);if(t)for(let o of t)o.removeAttribute(Co),o instanceof HTMLLinkElement?e.set(o.href.slice(o.href.lastIndexOf("/")+1),{usage:0,elements:[o]}):o.textContent&&n.set(o.textContent,{usage:0,elements:[o]})}function bo(i,r){let n=r.createElement("link");return n.setAttribute("rel","stylesheet"),n.setAttribute("href",i),n}var Mo=(()=>{class i{doc;appId;nonce;inline=new Map;external=new Map;hosts=new Set;constructor(n,e,t,o={}){this.doc=n,this.appId=e,this.nonce=t,js(n,e,this.inline,this.external),this.hosts.add(n.head)}addStyles(n,e){for(let t of n)this.addUsage(t,this.inline,la);e?.forEach(t=>this.addUsage(t,this.external,bo))}removeStyles(n,e){for(let t of n)this.removeUsage(t,this.inline);e?.forEach(t=>this.removeUsage(t,this.external))}addUsage(n,e,t){let o=e.get(n);o?o.usage++:e.set(n,{usage:1,elements:[...this.hosts].map(a=>this.addElement(a,t(n,this.doc)))})}removeUsage(n,e){let t=e.get(n);t&&(t.usage--,t.usage<=0&&(sa(t.elements),e.delete(n)))}ngOnDestroy(){for(let[,{elements:n}]of[...this.inline,...this.external])sa(n);this.hosts.clear()}addHost(n){this.hosts.add(n);for(let[e,{elements:t}]of this.inline)t.push(this.addElement(n,la(e,this.doc)));for(let[e,{elements:t}]of this.external)t.push(this.addElement(n,bo(e,this.doc)))}removeHost(n){this.hosts.delete(n)}addElement(n,e){return this.nonce&&e.setAttribute("nonce",this.nonce),n.appendChild(e)}static \u0275fac=function(e){return new(e||i)(V(ze),V(co),V(po,8),V(Yn))};static \u0275prov=A({token:i,factory:i.\u0275fac})}return i})(),xo={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/",math:"http://www.w3.org/1998/Math/MathML"},Po=/%COMP%/g;var da="%COMP%",Rs=`_nghost-${da}`,Vs=`_ngcontent-${da}`,Ds=!0,As=new Ce("",{providedIn:"root",factory:()=>Ds});function Ns(i){return Vs.replace(Po,i)}function Ls(i){return Rs.replace(Po,i)}function pa(i,r){return r.map(n=>n.replace(Po,i))}var So=(()=>{class i{eventManager;sharedStylesHost;appId;removeStylesOnCompDestroy;doc;ngZone;nonce;tracingService;rendererByCompId=new Map;defaultRenderer;platformIsServer;constructor(n,e,t,o,a,d,m=null,C=null){this.eventManager=n,this.sharedStylesHost=e,this.appId=t,this.removeStylesOnCompDestroy=o,this.doc=a,this.ngZone=d,this.nonce=m,this.tracingService=C,this.platformIsServer=!1,this.defaultRenderer=new yn(n,a,d,this.platformIsServer,this.tracingService)}createRenderer(n,e){if(!n||!e)return this.defaultRenderer;let t=this.getOrCreateRenderer(n,e);return t instanceof mi?t.applyToHost(n):t instanceof Mn&&t.applyStyles(),t}getOrCreateRenderer(n,e){let t=this.rendererByCompId,o=t.get(e.id);if(!o){let a=this.doc,d=this.ngZone,m=this.eventManager,C=this.sharedStylesHost,b=this.removeStylesOnCompDestroy,x=this.platformIsServer,M=this.tracingService;switch(e.encapsulation){case uo.Emulated:o=new mi(m,C,e,this.appId,b,a,d,x,M);break;case uo.ShadowDom:return new wo(m,C,n,e,a,d,this.nonce,x,M);default:o=new Mn(m,C,e,b,a,d,x,M);break}t.set(e.id,o)}return o}ngOnDestroy(){this.rendererByCompId.clear()}componentReplaced(n){this.rendererByCompId.delete(n)}static \u0275fac=function(e){return new(e||i)(V(yo),V(Mo),V(co),V(As),V(ze),V(vn),V(po),V(Mr,8))};static \u0275prov=A({token:i,factory:i.\u0275fac})}return i})(),yn=class{eventManager;doc;ngZone;platformIsServer;tracingService;data=Object.create(null);throwOnSyntheticProps=!0;constructor(r,n,e,t,o){this.eventManager=r,this.doc=n,this.ngZone=e,this.platformIsServer=t,this.tracingService=o}destroy(){}destroyNode=null;createElement(r,n){return n?this.doc.createElementNS(xo[n]||n,r):this.doc.createElement(r)}createComment(r){return this.doc.createComment(r)}createText(r){return this.doc.createTextNode(r)}appendChild(r,n){(ca(r)?r.content:r).appendChild(n)}insertBefore(r,n,e){r&&(ca(r)?r.content:r).insertBefore(n,e)}removeChild(r,n){n.remove()}selectRootElement(r,n){let e=typeof r=="string"?this.doc.querySelector(r):r;if(!e)throw new le(-5104,!1);return n||(e.textContent=""),e}parentNode(r){return r.parentNode}nextSibling(r){return r.nextSibling}setAttribute(r,n,e,t){if(t){n=t+":"+n;let o=xo[t];o?r.setAttributeNS(o,n,e):r.setAttribute(n,e)}else r.setAttribute(n,e)}removeAttribute(r,n,e){if(e){let t=xo[e];t?r.removeAttributeNS(t,n):r.removeAttribute(`${e}:${n}`)}else r.removeAttribute(n)}addClass(r,n){r.classList.add(n)}removeClass(r,n){r.classList.remove(n)}setStyle(r,n,e,t){t&(_n.DashCase|_n.Important)?r.style.setProperty(n,e,t&_n.Important?"important":""):r.style[n]=e}removeStyle(r,n,e){e&_n.DashCase?r.style.removeProperty(n):r.style[n]=""}setProperty(r,n,e){r!=null&&(r[n]=e)}setValue(r,n){r.nodeValue=n}listen(r,n,e,t){if(typeof r=="string"&&(r=bn().getGlobalEventTarget(this.doc,r),!r))throw new le(5102,!1);let o=this.decoratePreventDefault(e);return this.tracingService?.wrapEventListener&&(o=this.tracingService.wrapEventListener(r,n,o)),this.eventManager.addEventListener(r,n,o,t)}decoratePreventDefault(r){return n=>{if(n==="__ngUnwrap__")return r;r(n)===!1&&n.preventDefault()}}};function ca(i){return i.tagName==="TEMPLATE"&&i.content!==void 0}var wo=class extends yn{sharedStylesHost;hostEl;shadowRoot;constructor(r,n,e,t,o,a,d,m,C){super(r,o,a,m,C),this.sharedStylesHost=n,this.hostEl=e,this.shadowRoot=e.attachShadow({mode:"open"}),this.sharedStylesHost.addHost(this.shadowRoot);let b=t.styles;b=pa(t.id,b);for(let M of b){let D=document.createElement("style");d&&D.setAttribute("nonce",d),D.textContent=M,this.shadowRoot.appendChild(D)}let x=t.getExternalStyles?.();if(x)for(let M of x){let D=bo(M,o);d&&D.setAttribute("nonce",d),this.shadowRoot.appendChild(D)}}nodeOrShadowRoot(r){return r===this.hostEl?this.shadowRoot:r}appendChild(r,n){return super.appendChild(this.nodeOrShadowRoot(r),n)}insertBefore(r,n,e){return super.insertBefore(this.nodeOrShadowRoot(r),n,e)}removeChild(r,n){return super.removeChild(null,n)}parentNode(r){return this.nodeOrShadowRoot(super.parentNode(this.nodeOrShadowRoot(r)))}destroy(){this.sharedStylesHost.removeHost(this.shadowRoot)}},Mn=class extends yn{sharedStylesHost;removeStylesOnCompDestroy;styles;styleUrls;constructor(r,n,e,t,o,a,d,m,C){super(r,o,a,d,m),this.sharedStylesHost=n,this.removeStylesOnCompDestroy=t;let b=e.styles;this.styles=C?pa(C,b):b,this.styleUrls=e.getExternalStyles?.(C)}applyStyles(){this.sharedStylesHost.addStyles(this.styles,this.styleUrls)}destroy(){this.removeStylesOnCompDestroy&&yr.size===0&&this.sharedStylesHost.removeStyles(this.styles,this.styleUrls)}},mi=class extends Mn{contentAttr;hostAttr;constructor(r,n,e,t,o,a,d,m,C){let b=t+"-"+e.id;super(r,n,e,o,a,d,m,C,b),this.contentAttr=Ns(b),this.hostAttr=Ls(b)}applyToHost(r){this.applyStyles(),this.setAttribute(r,this.hostAttr,"")}createElement(r,n){let e=super.createElement(r,n);return super.setAttribute(e,this.contentAttr,""),e}};var fi=class i extends Fr{supportsDOMEvents=!0;static makeCurrent(){zr(new i)}onAndCancel(r,n,e,t){return r.addEventListener(n,e,t),()=>{r.removeEventListener(n,e,t)}}dispatchEvent(r,n){r.dispatchEvent(n)}remove(r){r.remove()}createElement(r,n){return n=n||this.getDefaultDocument(),n.createElement(r)}createHtmlDocument(){return document.implementation.createHTMLDocument("fakeTitle")}getDefaultDocument(){return document}isElementNode(r){return r.nodeType===Node.ELEMENT_NODE}isShadowRoot(r){return r instanceof DocumentFragment}getGlobalEventTarget(r,n){return n==="window"?window:n==="document"?r:n==="body"?r.body:null}getBaseHref(r){let n=zs();return n==null?null:Fs(n)}resetBaseElement(){Pn=null}getUserAgent(){return window.navigator.userAgent}getCookie(r){return $r(document.cookie,r)}},Pn=null;function zs(){return Pn=Pn||document.head.querySelector("base"),Pn?Pn.getAttribute("href"):null}function Fs(i){return new URL(i,document.baseURI).pathname}var qs=(()=>{class i{build(){return new XMLHttpRequest}static \u0275fac=function(e){return new(e||i)};static \u0275prov=A({token:i,factory:i.\u0275fac})}return i})(),ua=["alt","control","meta","shift"],Us={"\b":"Backspace","	":"Tab","\x7F":"Delete","\x1B":"Escape",Del:"Delete",Esc:"Escape",Left:"ArrowLeft",Right:"ArrowRight",Up:"ArrowUp",Down:"ArrowDown",Menu:"ContextMenu",Scroll:"ScrollLock",Win:"OS"},Ws={alt:i=>i.altKey,control:i=>i.ctrlKey,meta:i=>i.metaKey,shift:i=>i.shiftKey},ma=(()=>{class i extends wn{constructor(n){super(n)}supports(n){return i.parseEventName(n)!=null}addEventListener(n,e,t,o){let a=i.parseEventName(e),d=i.eventCallback(a.fullKey,t,this.manager.getZone());return this.manager.getZone().runOutsideAngular(()=>bn().onAndCancel(n,a.domEventName,d,o))}static parseEventName(n){let e=n.toLowerCase().split("."),t=e.shift();if(e.length===0||!(t==="keydown"||t==="keyup"))return null;let o=i._normalizeKey(e.pop()),a="",d=e.indexOf("code");if(d>-1&&(e.splice(d,1),a="code."),ua.forEach(C=>{let b=e.indexOf(C);b>-1&&(e.splice(b,1),a+=C+".")}),a+=o,e.length!=0||o.length===0)return null;let m={};return m.domEventName=t,m.fullKey=a,m}static matchEventFullKeyCode(n,e){let t=Us[n.key]||n.key,o="";return e.indexOf("code.")>-1&&(t=n.code,o="code."),t==null||!t?!1:(t=t.toLowerCase(),t===" "?t="space":t==="."&&(t="dot"),ua.forEach(a=>{if(a!==t){let d=Ws[a];d(n)&&(o+=a+".")}}),o+=t,o===e)}static eventCallback(n,e,t){return o=>{i.matchEventFullKeyCode(o,n)&&t.runGuarded(()=>e(o))}}static _normalizeKey(n){return n==="esc"?"escape":n}static \u0275fac=function(e){return new(e||i)(V(ze))};static \u0275prov=A({token:i,factory:i.\u0275fac})}return i})();function Oo(i,r,n){let e=I({rootComponent:i,platformRef:n?.platformRef},$s(r));return Lr(e)}function $s(i){return{appProviders:[...Ys,...i?.providers??[]],platformProviders:Js}}function Bs(){fi.makeCurrent()}function Hs(){return new ao}function Gs(){return xr(document),document}var Js=[{provide:Yn,useValue:Hr},{provide:br,useValue:Bs,multi:!0},{provide:ze,useFactory:Gs}];var Ys=[{provide:hr,useValue:"root"},{provide:ao,useFactory:Hs},{provide:gi,useClass:ui,multi:!0,deps:[ze]},{provide:gi,useClass:ma,multi:!0,deps:[ze]},So,Mo,yo,{provide:Pr,useExisting:So},{provide:Br,useClass:qs},[]];var ga=(()=>{class i{_doc;constructor(n){this._doc=n}getTitle(){return this._doc.title}setTitle(n){this._doc.title=n||""}static \u0275fac=function(e){return new(e||i)(V(ze))};static \u0275prov=A({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();var L="primary",Fn=Symbol("RouteTitle"),jo=class{params;constructor(r){this.params=r||{}}has(r){return Object.prototype.hasOwnProperty.call(this.params,r)}get(r){if(this.has(r)){let n=this.params[r];return Array.isArray(n)?n[0]:n}return null}getAll(r){if(this.has(r)){let n=this.params[r];return Array.isArray(n)?n:[n]}return[]}get keys(){return Object.keys(this.params)}};function zt(i){return new jo(i)}function wa(i,r,n){let e=n.path.split("/");if(e.length>i.length||n.pathMatch==="full"&&(r.hasChildren()||e.length<i.length))return null;let t={};for(let o=0;o<e.length;o++){let a=e[o],d=i[o];if(a[0]===":")t[a.substring(1)]=d;else if(a!==d.path)return null}return{consumed:i.slice(0,e.length),posParams:t}}function Ks(i,r){if(i.length!==r.length)return!1;for(let n=0;n<i.length;++n)if(!et(i[n],r[n]))return!1;return!0}function et(i,r){let n=i?Ro(i):void 0,e=r?Ro(r):void 0;if(!n||!e||n.length!=e.length)return!1;let t;for(let o=0;o<n.length;o++)if(t=n[o],!ya(i[t],r[t]))return!1;return!0}function Ro(i){return[...Object.keys(i),...Object.getOwnPropertySymbols(i)]}function ya(i,r){if(Array.isArray(i)&&Array.isArray(r)){if(i.length!==r.length)return!1;let n=[...i].sort(),e=[...r].sort();return n.every((t,o)=>e[o]===t)}else return i===r}function Ma(i){return i.length>0?i[i.length-1]:null}function _t(i){return sr(i)?i:Er(i)?je(Promise.resolve(i)):N(i)}var Zs={exact:Sa,subset:Oa},Pa={exact:Xs,subset:el,ignored:()=>!0};function fa(i,r,n){return Zs[n.paths](i.root,r.root,n.matrixParams)&&Pa[n.queryParams](i.queryParams,r.queryParams)&&!(n.fragment==="exact"&&i.fragment!==r.fragment)}function Xs(i,r){return et(i,r)}function Sa(i,r,n){if(!Nt(i.segments,r.segments)||!vi(i.segments,r.segments,n)||i.numberOfChildren!==r.numberOfChildren)return!1;for(let e in r.children)if(!i.children[e]||!Sa(i.children[e],r.children[e],n))return!1;return!0}function el(i,r){return Object.keys(r).length<=Object.keys(i).length&&Object.keys(r).every(n=>ya(i[n],r[n]))}function Oa(i,r,n){return ka(i,r,r.segments,n)}function ka(i,r,n,e){if(i.segments.length>n.length){let t=i.segments.slice(0,n.length);return!(!Nt(t,n)||r.hasChildren()||!vi(t,n,e))}else if(i.segments.length===n.length){if(!Nt(i.segments,n)||!vi(i.segments,n,e))return!1;for(let t in r.children)if(!i.children[t]||!Oa(i.children[t],r.children[t],e))return!1;return!0}else{let t=n.slice(0,i.segments.length),o=n.slice(i.segments.length);return!Nt(i.segments,t)||!vi(i.segments,t,e)||!i.children[L]?!1:ka(i.children[L],r,o,e)}}function vi(i,r,n){return r.every((e,t)=>Pa[n](i[t].parameters,e.parameters))}var nt=class{root;queryParams;fragment;_queryParamMap;constructor(r=new Y([],{}),n={},e=null){this.root=r,this.queryParams=n,this.fragment=e}get queryParamMap(){return this._queryParamMap??=zt(this.queryParams),this._queryParamMap}toString(){return il.serialize(this)}},Y=class{segments;children;parent=null;constructor(r,n){this.segments=r,this.children=n,Object.values(n).forEach(e=>e.parent=this)}hasChildren(){return this.numberOfChildren>0}get numberOfChildren(){return Object.keys(this.children).length}toString(){return Ci(this)}},St=class{path;parameters;_parameterMap;constructor(r,n){this.path=r,this.parameters=n}get parameterMap(){return this._parameterMap??=zt(this.parameters),this._parameterMap}toString(){return Ta(this)}};function tl(i,r){return Nt(i,r)&&i.every((n,e)=>et(n.parameters,r[e].parameters))}function Nt(i,r){return i.length!==r.length?!1:i.every((n,e)=>n.path===r[e].path)}function nl(i,r){let n=[];return Object.entries(i.children).forEach(([e,t])=>{e===L&&(n=n.concat(r(t,e)))}),Object.entries(i.children).forEach(([e,t])=>{e!==L&&(n=n.concat(r(t,e)))}),n}var qn=(()=>{class i{static \u0275fac=function(e){return new(e||i)};static \u0275prov=A({token:i,factory:()=>new Ft,providedIn:"root"})}return i})(),Ft=class{parse(r){let n=new Do(r);return new nt(n.parseRootSegment(),n.parseQueryParams(),n.parseFragment())}serialize(r){let n=`/${Sn(r.root,!0)}`,e=al(r.queryParams),t=typeof r.fragment=="string"?`#${ol(r.fragment)}`:"";return`${n}${e}${t}`}},il=new Ft;function Ci(i){return i.segments.map(r=>Ta(r)).join("/")}function Sn(i,r){if(!i.hasChildren())return Ci(i);if(r){let n=i.children[L]?Sn(i.children[L],!1):"",e=[];return Object.entries(i.children).forEach(([t,o])=>{t!==L&&e.push(`${t}:${Sn(o,!1)}`)}),e.length>0?`${n}(${e.join("//")})`:n}else{let n=nl(i,(e,t)=>t===L?[Sn(i.children[L],!1)]:[`${t}:${Sn(e,!1)}`]);return Object.keys(i.children).length===1&&i.children[L]!=null?`${Ci(i)}/${n[0]}`:`${Ci(i)}/(${n.join("//")})`}}function Ea(i){return encodeURIComponent(i).replace(/%40/g,"@").replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",")}function hi(i){return Ea(i).replace(/%3B/gi,";")}function ol(i){return encodeURI(i)}function Vo(i){return Ea(i).replace(/\(/g,"%28").replace(/\)/g,"%29").replace(/%26/gi,"&")}function xi(i){return decodeURIComponent(i)}function ha(i){return xi(i.replace(/\+/g,"%20"))}function Ta(i){return`${Vo(i.path)}${rl(i.parameters)}`}function rl(i){return Object.entries(i).map(([r,n])=>`;${Vo(r)}=${Vo(n)}`).join("")}function al(i){let r=Object.entries(i).map(([n,e])=>Array.isArray(e)?e.map(t=>`${hi(n)}=${hi(t)}`).join("&"):`${hi(n)}=${hi(e)}`).filter(n=>n);return r.length?`?${r.join("&")}`:""}var sl=/^[^\/()?;#]+/;function ko(i){let r=i.match(sl);return r?r[0]:""}var ll=/^[^\/()?;=#]+/;function cl(i){let r=i.match(ll);return r?r[0]:""}var dl=/^[^=?&#]+/;function pl(i){let r=i.match(dl);return r?r[0]:""}var ul=/^[^&#]+/;function ml(i){let r=i.match(ul);return r?r[0]:""}var Do=class{url;remaining;constructor(r){this.url=r,this.remaining=r}parseRootSegment(){return this.consumeOptional("/"),this.remaining===""||this.peekStartsWith("?")||this.peekStartsWith("#")?new Y([],{}):new Y([],this.parseChildren())}parseQueryParams(){let r={};if(this.consumeOptional("?"))do this.parseQueryParam(r);while(this.consumeOptional("&"));return r}parseFragment(){return this.consumeOptional("#")?decodeURIComponent(this.remaining):null}parseChildren(){if(this.remaining==="")return{};this.consumeOptional("/");let r=[];for(this.peekStartsWith("(")||r.push(this.parseSegment());this.peekStartsWith("/")&&!this.peekStartsWith("//")&&!this.peekStartsWith("/(");)this.capture("/"),r.push(this.parseSegment());let n={};this.peekStartsWith("/(")&&(this.capture("/"),n=this.parseParens(!0));let e={};return this.peekStartsWith("(")&&(e=this.parseParens(!1)),(r.length>0||Object.keys(n).length>0)&&(e[L]=new Y(r,n)),e}parseSegment(){let r=ko(this.remaining);if(r===""&&this.peekStartsWith(";"))throw new le(4009,!1);return this.capture(r),new St(xi(r),this.parseMatrixParams())}parseMatrixParams(){let r={};for(;this.consumeOptional(";");)this.parseParam(r);return r}parseParam(r){let n=cl(this.remaining);if(!n)return;this.capture(n);let e="";if(this.consumeOptional("=")){let t=ko(this.remaining);t&&(e=t,this.capture(e))}r[xi(n)]=xi(e)}parseQueryParam(r){let n=pl(this.remaining);if(!n)return;this.capture(n);let e="";if(this.consumeOptional("=")){let a=ml(this.remaining);a&&(e=a,this.capture(e))}let t=ha(n),o=ha(e);if(r.hasOwnProperty(t)){let a=r[t];Array.isArray(a)||(a=[a],r[t]=a),a.push(o)}else r[t]=o}parseParens(r){let n={};for(this.capture("(");!this.consumeOptional(")")&&this.remaining.length>0;){let e=ko(this.remaining),t=this.remaining[e.length];if(t!=="/"&&t!==")"&&t!==";")throw new le(4010,!1);let o;e.indexOf(":")>-1?(o=e.slice(0,e.indexOf(":")),this.capture(o),this.capture(":")):r&&(o=L);let a=this.parseChildren();n[o??L]=Object.keys(a).length===1&&a[L]?a[L]:new Y([],a),this.consumeOptional("//")}return n}peekStartsWith(r){return this.remaining.startsWith(r)}consumeOptional(r){return this.peekStartsWith(r)?(this.remaining=this.remaining.substring(r.length),!0):!1}capture(r){if(!this.consumeOptional(r))throw new le(4011,!1)}};function Ia(i){return i.segments.length>0?new Y([],{[L]:i}):i}function ja(i){let r={};for(let[e,t]of Object.entries(i.children)){let o=ja(t);if(e===L&&o.segments.length===0&&o.hasChildren())for(let[a,d]of Object.entries(o.children))r[a]=d;else(o.segments.length>0||o.hasChildren())&&(r[e]=o)}let n=new Y(i.segments,r);return gl(n)}function gl(i){if(i.numberOfChildren===1&&i.children[L]){let r=i.children[L];return new Y(i.segments.concat(r.segments),r.children)}return i}function Ot(i){return i instanceof nt}function Ra(i,r,n=null,e=null){let t=Va(i);return Da(t,r,n,e)}function Va(i){let r;function n(o){let a={};for(let m of o.children){let C=n(m);a[m.outlet]=C}let d=new Y(o.url,a);return o===i&&(r=d),d}let e=n(i.root),t=Ia(e);return r??t}function Da(i,r,n,e){let t=i;for(;t.parent;)t=t.parent;if(r.length===0)return Eo(t,t,t,n,e);let o=fl(r);if(o.toRoot())return Eo(t,t,new Y([],{}),n,e);let a=hl(o,t,i),d=a.processChildren?kn(a.segmentGroup,a.index,o.commands):Na(a.segmentGroup,a.index,o.commands);return Eo(t,a.segmentGroup,d,n,e)}function bi(i){return typeof i=="object"&&i!=null&&!i.outlets&&!i.segmentPath}function In(i){return typeof i=="object"&&i!=null&&i.outlets}function Eo(i,r,n,e,t){let o={};e&&Object.entries(e).forEach(([m,C])=>{o[m]=Array.isArray(C)?C.map(b=>`${b}`):`${C}`});let a;i===r?a=n:a=Aa(i,r,n);let d=Ia(ja(a));return new nt(d,o,t)}function Aa(i,r,n){let e={};return Object.entries(i.children).forEach(([t,o])=>{o===r?e[t]=n:e[t]=Aa(o,r,n)}),new Y(i.segments,e)}var wi=class{isAbsolute;numberOfDoubleDots;commands;constructor(r,n,e){if(this.isAbsolute=r,this.numberOfDoubleDots=n,this.commands=e,r&&e.length>0&&bi(e[0]))throw new le(4003,!1);let t=e.find(In);if(t&&t!==Ma(e))throw new le(4004,!1)}toRoot(){return this.isAbsolute&&this.commands.length===1&&this.commands[0]=="/"}};function fl(i){if(typeof i[0]=="string"&&i.length===1&&i[0]==="/")return new wi(!0,0,i);let r=0,n=!1,e=i.reduce((t,o,a)=>{if(typeof o=="object"&&o!=null){if(o.outlets){let d={};return Object.entries(o.outlets).forEach(([m,C])=>{d[m]=typeof C=="string"?C.split("/"):C}),[...t,{outlets:d}]}if(o.segmentPath)return[...t,o.segmentPath]}return typeof o!="string"?[...t,o]:a===0?(o.split("/").forEach((d,m)=>{m==0&&d==="."||(m==0&&d===""?n=!0:d===".."?r++:d!=""&&t.push(d))}),t):[...t,o]},[]);return new wi(n,r,e)}var tn=class{segmentGroup;processChildren;index;constructor(r,n,e){this.segmentGroup=r,this.processChildren=n,this.index=e}};function hl(i,r,n){if(i.isAbsolute)return new tn(r,!0,0);if(!n)return new tn(r,!1,NaN);if(n.parent===null)return new tn(n,!0,0);let e=bi(i.commands[0])?0:1,t=n.segments.length-1+e;return _l(n,t,i.numberOfDoubleDots)}function _l(i,r,n){let e=i,t=r,o=n;for(;o>t;){if(o-=t,e=e.parent,!e)throw new le(4005,!1);t=e.segments.length}return new tn(e,!1,t-o)}function vl(i){return In(i[0])?i[0].outlets:{[L]:i}}function Na(i,r,n){if(i??=new Y([],{}),i.segments.length===0&&i.hasChildren())return kn(i,r,n);let e=Cl(i,r,n),t=n.slice(e.commandIndex);if(e.match&&e.pathIndex<i.segments.length){let o=new Y(i.segments.slice(0,e.pathIndex),{});return o.children[L]=new Y(i.segments.slice(e.pathIndex),i.children),kn(o,0,t)}else return e.match&&t.length===0?new Y(i.segments,{}):e.match&&!i.hasChildren()?Ao(i,r,n):e.match?kn(i,0,t):Ao(i,r,n)}function kn(i,r,n){if(n.length===0)return new Y(i.segments,{});{let e=vl(n),t={};if(Object.keys(e).some(o=>o!==L)&&i.children[L]&&i.numberOfChildren===1&&i.children[L].segments.length===0){let o=kn(i.children[L],r,n);return new Y(i.segments,o.children)}return Object.entries(e).forEach(([o,a])=>{typeof a=="string"&&(a=[a]),a!==null&&(t[o]=Na(i.children[o],r,a))}),Object.entries(i.children).forEach(([o,a])=>{e[o]===void 0&&(t[o]=a)}),new Y(i.segments,t)}}function Cl(i,r,n){let e=0,t=r,o={match:!1,pathIndex:0,commandIndex:0};for(;t<i.segments.length;){if(e>=n.length)return o;let a=i.segments[t],d=n[e];if(In(d))break;let m=`${d}`,C=e<n.length-1?n[e+1]:null;if(t>0&&m===void 0)break;if(m&&C&&typeof C=="object"&&C.outlets===void 0){if(!va(m,C,a))return o;e+=2}else{if(!va(m,{},a))return o;e++}t++}return{match:!0,pathIndex:t,commandIndex:e}}function Ao(i,r,n){let e=i.segments.slice(0,r),t=0;for(;t<n.length;){let o=n[t];if(In(o)){let m=xl(o.outlets);return new Y(e,m)}if(t===0&&bi(n[0])){let m=i.segments[r];e.push(new St(m.path,_a(n[0]))),t++;continue}let a=In(o)?o.outlets[L]:`${o}`,d=t<n.length-1?n[t+1]:null;a&&d&&bi(d)?(e.push(new St(a,_a(d))),t+=2):(e.push(new St(a,{})),t++)}return new Y(e,{})}function xl(i){let r={};return Object.entries(i).forEach(([n,e])=>{typeof e=="string"&&(e=[e]),e!==null&&(r[n]=Ao(new Y([],{}),0,e))}),r}function _a(i){let r={};return Object.entries(i).forEach(([n,e])=>r[n]=`${e}`),r}function va(i,r,n){return i==n.path&&et(r,n.parameters)}var En="imperative",fe=(function(i){return i[i.NavigationStart=0]="NavigationStart",i[i.NavigationEnd=1]="NavigationEnd",i[i.NavigationCancel=2]="NavigationCancel",i[i.NavigationError=3]="NavigationError",i[i.RoutesRecognized=4]="RoutesRecognized",i[i.ResolveStart=5]="ResolveStart",i[i.ResolveEnd=6]="ResolveEnd",i[i.GuardsCheckStart=7]="GuardsCheckStart",i[i.GuardsCheckEnd=8]="GuardsCheckEnd",i[i.RouteConfigLoadStart=9]="RouteConfigLoadStart",i[i.RouteConfigLoadEnd=10]="RouteConfigLoadEnd",i[i.ChildActivationStart=11]="ChildActivationStart",i[i.ChildActivationEnd=12]="ChildActivationEnd",i[i.ActivationStart=13]="ActivationStart",i[i.ActivationEnd=14]="ActivationEnd",i[i.Scroll=15]="Scroll",i[i.NavigationSkipped=16]="NavigationSkipped",i})(fe||{}),Ae=class{id;url;constructor(r,n){this.id=r,this.url=n}},qt=class extends Ae{type=fe.NavigationStart;navigationTrigger;restoredState;constructor(r,n,e="imperative",t=null){super(r,n),this.navigationTrigger=e,this.restoredState=t}toString(){return`NavigationStart(id: ${this.id}, url: '${this.url}')`}},Ke=class extends Ae{urlAfterRedirects;type=fe.NavigationEnd;constructor(r,n,e){super(r,n),this.urlAfterRedirects=e}toString(){return`NavigationEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}')`}},ye=(function(i){return i[i.Redirect=0]="Redirect",i[i.SupersededByNewNavigation=1]="SupersededByNewNavigation",i[i.NoDataFromResolver=2]="NoDataFromResolver",i[i.GuardRejected=3]="GuardRejected",i[i.Aborted=4]="Aborted",i})(ye||{}),jn=(function(i){return i[i.IgnoredSameUrlNavigation=0]="IgnoredSameUrlNavigation",i[i.IgnoredByUrlHandlingStrategy=1]="IgnoredByUrlHandlingStrategy",i})(jn||{}),tt=class extends Ae{reason;code;type=fe.NavigationCancel;constructor(r,n,e,t){super(r,n),this.reason=e,this.code=t}toString(){return`NavigationCancel(id: ${this.id}, url: '${this.url}')`}},ht=class extends Ae{reason;code;type=fe.NavigationSkipped;constructor(r,n,e,t){super(r,n),this.reason=e,this.code=t}},on=class extends Ae{error;target;type=fe.NavigationError;constructor(r,n,e,t){super(r,n),this.error=e,this.target=t}toString(){return`NavigationError(id: ${this.id}, url: '${this.url}', error: ${this.error})`}},Rn=class extends Ae{urlAfterRedirects;state;type=fe.RoutesRecognized;constructor(r,n,e,t){super(r,n),this.urlAfterRedirects=e,this.state=t}toString(){return`RoutesRecognized(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},yi=class extends Ae{urlAfterRedirects;state;type=fe.GuardsCheckStart;constructor(r,n,e,t){super(r,n),this.urlAfterRedirects=e,this.state=t}toString(){return`GuardsCheckStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Mi=class extends Ae{urlAfterRedirects;state;shouldActivate;type=fe.GuardsCheckEnd;constructor(r,n,e,t,o){super(r,n),this.urlAfterRedirects=e,this.state=t,this.shouldActivate=o}toString(){return`GuardsCheckEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state}, shouldActivate: ${this.shouldActivate})`}},Pi=class extends Ae{urlAfterRedirects;state;type=fe.ResolveStart;constructor(r,n,e,t){super(r,n),this.urlAfterRedirects=e,this.state=t}toString(){return`ResolveStart(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Si=class extends Ae{urlAfterRedirects;state;type=fe.ResolveEnd;constructor(r,n,e,t){super(r,n),this.urlAfterRedirects=e,this.state=t}toString(){return`ResolveEnd(id: ${this.id}, url: '${this.url}', urlAfterRedirects: '${this.urlAfterRedirects}', state: ${this.state})`}},Oi=class{route;type=fe.RouteConfigLoadStart;constructor(r){this.route=r}toString(){return`RouteConfigLoadStart(path: ${this.route.path})`}},ki=class{route;type=fe.RouteConfigLoadEnd;constructor(r){this.route=r}toString(){return`RouteConfigLoadEnd(path: ${this.route.path})`}},Ei=class{snapshot;type=fe.ChildActivationStart;constructor(r){this.snapshot=r}toString(){return`ChildActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Ti=class{snapshot;type=fe.ChildActivationEnd;constructor(r){this.snapshot=r}toString(){return`ChildActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},Ii=class{snapshot;type=fe.ActivationStart;constructor(r){this.snapshot=r}toString(){return`ActivationStart(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}},ji=class{snapshot;type=fe.ActivationEnd;constructor(r){this.snapshot=r}toString(){return`ActivationEnd(path: '${this.snapshot.routeConfig&&this.snapshot.routeConfig.path||""}')`}};var Vn=class{},rn=class{url;navigationBehaviorOptions;constructor(r,n){this.url=r,this.navigationBehaviorOptions=n}};function bl(i){return!(i instanceof Vn)&&!(i instanceof rn)}function wl(i,r){return i.providers&&!i._injector&&(i._injector=fo(i.providers,r,`Route: ${i.path}`)),i._injector??r}function Qe(i){return i.outlet||L}function yl(i,r){let n=i.filter(e=>Qe(e)===r);return n.push(...i.filter(e=>Qe(e)!==r)),n}function ln(i){if(!i)return null;if(i.routeConfig?._injector)return i.routeConfig._injector;for(let r=i.parent;r;r=r.parent){let n=r.routeConfig;if(n?._loadedInjector)return n._loadedInjector;if(n?._injector)return n._injector}return null}var Ri=class{rootInjector;outlet=null;route=null;children;attachRef=null;get injector(){return ln(this.route?.snapshot)??this.rootInjector}constructor(r){this.rootInjector=r,this.children=new cn(this.rootInjector)}},cn=(()=>{class i{rootInjector;contexts=new Map;constructor(n){this.rootInjector=n}onChildOutletCreated(n,e){let t=this.getOrCreateContext(n);t.outlet=e,this.contexts.set(n,t)}onChildOutletDestroyed(n){let e=this.getContext(n);e&&(e.outlet=null,e.attachRef=null)}onOutletDeactivated(){let n=this.contexts;return this.contexts=new Map,n}onOutletReAttached(n){this.contexts=n}getOrCreateContext(n){let e=this.getContext(n);return e||(e=new Ri(this.rootInjector),this.contexts.set(n,e)),e}getContext(n){return this.contexts.get(n)||null}static \u0275fac=function(e){return new(e||i)(V($t))};static \u0275prov=A({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),Vi=class{_root;constructor(r){this._root=r}get root(){return this._root.value}parent(r){let n=this.pathFromRoot(r);return n.length>1?n[n.length-2]:null}children(r){let n=No(r,this._root);return n?n.children.map(e=>e.value):[]}firstChild(r){let n=No(r,this._root);return n&&n.children.length>0?n.children[0].value:null}siblings(r){let n=Lo(r,this._root);return n.length<2?[]:n[n.length-2].children.map(t=>t.value).filter(t=>t!==r)}pathFromRoot(r){return Lo(r,this._root).map(n=>n.value)}};function No(i,r){if(i===r.value)return r;for(let n of r.children){let e=No(i,n);if(e)return e}return null}function Lo(i,r){if(i===r.value)return[r];for(let n of r.children){let e=Lo(i,n);if(e.length)return e.unshift(r),e}return[]}var De=class{value;children;constructor(r,n){this.value=r,this.children=n}toString(){return`TreeNode(${this.value})`}};function en(i){let r={};return i&&i.children.forEach(n=>r[n.value.outlet]=n),r}var Dn=class extends Vi{snapshot;constructor(r,n){super(r),this.snapshot=n,Ho(this,r)}toString(){return this.snapshot.toString()}};function La(i){let r=Ml(i),n=new Pe([new St("",{})]),e=new Pe({}),t=new Pe({}),o=new Pe({}),a=new Pe(""),d=new Ne(n,e,o,a,t,L,i,r.root);return d.snapshot=r.root,new Dn(new De(d,[]),r)}function Ml(i){let r={},n={},e={},o=new Lt([],r,e,"",n,L,i,null,{});return new An("",new De(o,[]))}var Ne=class{urlSubject;paramsSubject;queryParamsSubject;fragmentSubject;dataSubject;outlet;component;snapshot;_futureSnapshot;_routerState;_paramMap;_queryParamMap;title;url;params;queryParams;fragment;data;constructor(r,n,e,t,o,a,d,m){this.urlSubject=r,this.paramsSubject=n,this.queryParamsSubject=e,this.fragmentSubject=t,this.dataSubject=o,this.outlet=a,this.component=d,this._futureSnapshot=m,this.title=this.dataSubject?.pipe(Z(C=>C[Fn]))??N(void 0),this.url=r,this.params=n,this.queryParams=e,this.fragment=t,this.data=o}get routeConfig(){return this._futureSnapshot.routeConfig}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=this.params.pipe(Z(r=>zt(r))),this._paramMap}get queryParamMap(){return this._queryParamMap??=this.queryParams.pipe(Z(r=>zt(r))),this._queryParamMap}toString(){return this.snapshot?this.snapshot.toString():`Future(${this._futureSnapshot})`}};function Di(i,r,n="emptyOnly"){let e,{routeConfig:t}=i;return r!==null&&(n==="always"||t?.path===""||!r.component&&!r.routeConfig?.loadComponent)?e={params:I(I({},r.params),i.params),data:I(I({},r.data),i.data),resolve:I(I(I(I({},i.data),r.data),t?.data),i._resolvedData)}:e={params:I({},i.params),data:I({},i.data),resolve:I(I({},i.data),i._resolvedData??{})},t&&Fa(t)&&(e.resolve[Fn]=t.title),e}var Lt=class{url;params;queryParams;fragment;data;outlet;component;routeConfig;_resolve;_resolvedData;_routerState;_paramMap;_queryParamMap;get title(){return this.data?.[Fn]}constructor(r,n,e,t,o,a,d,m,C){this.url=r,this.params=n,this.queryParams=e,this.fragment=t,this.data=o,this.outlet=a,this.component=d,this.routeConfig=m,this._resolve=C}get root(){return this._routerState.root}get parent(){return this._routerState.parent(this)}get firstChild(){return this._routerState.firstChild(this)}get children(){return this._routerState.children(this)}get pathFromRoot(){return this._routerState.pathFromRoot(this)}get paramMap(){return this._paramMap??=zt(this.params),this._paramMap}get queryParamMap(){return this._queryParamMap??=zt(this.queryParams),this._queryParamMap}toString(){let r=this.url.map(e=>e.toString()).join("/"),n=this.routeConfig?this.routeConfig.path:"";return`Route(url:'${r}', path:'${n}')`}},An=class extends Vi{url;constructor(r,n){super(n),this.url=r,Ho(this,n)}toString(){return za(this._root)}};function Ho(i,r){r.value._routerState=i,r.children.forEach(n=>Ho(i,n))}function za(i){let r=i.children.length>0?` { ${i.children.map(za).join(", ")} } `:"";return`${i.value}${r}`}function To(i){if(i.snapshot){let r=i.snapshot,n=i._futureSnapshot;i.snapshot=n,et(r.queryParams,n.queryParams)||i.queryParamsSubject.next(n.queryParams),r.fragment!==n.fragment&&i.fragmentSubject.next(n.fragment),et(r.params,n.params)||i.paramsSubject.next(n.params),Ks(r.url,n.url)||i.urlSubject.next(n.url),et(r.data,n.data)||i.dataSubject.next(n.data)}else i.snapshot=i._futureSnapshot,i.dataSubject.next(i._futureSnapshot.data)}function zo(i,r){let n=et(i.params,r.params)&&tl(i.url,r.url),e=!i.parent!=!r.parent;return n&&!e&&(!i.parent||zo(i.parent,r.parent))}function Fa(i){return typeof i.title=="string"||i.title===null}var qa=new Ce(""),Un=(()=>{class i{activated=null;get activatedComponentRef(){return this.activated}_activatedRoute=null;name=L;activateEvents=new xe;deactivateEvents=new xe;attachEvents=new xe;detachEvents=new xe;routerOutletData=Nr();parentContexts=j(cn);location=j(Sr);changeDetector=j(Xn);inputBinder=j(zi,{optional:!0});supportsBindingToComponentInputs=!0;ngOnChanges(n){if(n.name){let{firstChange:e,previousValue:t}=n.name;if(e)return;this.isTrackedInParentContexts(t)&&(this.deactivate(),this.parentContexts.onChildOutletDestroyed(t)),this.initializeOutletWithName()}}ngOnDestroy(){this.isTrackedInParentContexts(this.name)&&this.parentContexts.onChildOutletDestroyed(this.name),this.inputBinder?.unsubscribeFromRouteData(this)}isTrackedInParentContexts(n){return this.parentContexts.getContext(n)?.outlet===this}ngOnInit(){this.initializeOutletWithName()}initializeOutletWithName(){if(this.parentContexts.onChildOutletCreated(this.name,this),this.activated)return;let n=this.parentContexts.getContext(this.name);n?.route&&(n.attachRef?this.attach(n.attachRef,n.route):this.activateWith(n.route,n.injector))}get isActivated(){return!!this.activated}get component(){if(!this.activated)throw new le(4012,!1);return this.activated.instance}get activatedRoute(){if(!this.activated)throw new le(4012,!1);return this._activatedRoute}get activatedRouteData(){return this._activatedRoute?this._activatedRoute.snapshot.data:{}}detach(){if(!this.activated)throw new le(4012,!1);this.location.detach();let n=this.activated;return this.activated=null,this._activatedRoute=null,this.detachEvents.emit(n.instance),n}attach(n,e){this.activated=n,this._activatedRoute=e,this.location.insert(n.hostView),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.attachEvents.emit(n.instance)}deactivate(){if(this.activated){let n=this.component;this.activated.destroy(),this.activated=null,this._activatedRoute=null,this.deactivateEvents.emit(n)}}activateWith(n,e){if(this.isActivated)throw new le(4013,!1);this._activatedRoute=n;let t=this.location,a=n.snapshot.component,d=this.parentContexts.getOrCreateContext(this.name).children,m=new Fo(n,d,t.injector,this.routerOutletData);this.activated=t.createComponent(a,{index:t.length,injector:m,environmentInjector:e}),this.changeDetector.markForCheck(),this.inputBinder?.bindActivatedRouteToOutletComponent(this),this.activateEvents.emit(this.activated.instance)}static \u0275fac=function(e){return new(e||i)};static \u0275dir=Cn({type:i,selectors:[["router-outlet"]],inputs:{name:"name",routerOutletData:[1,"routerOutletData"]},outputs:{activateEvents:"activate",deactivateEvents:"deactivate",attachEvents:"attach",detachEvents:"detach"},exportAs:["outlet"],features:[dt]})}return i})(),Fo=class{route;childContexts;parent;outletData;constructor(r,n,e,t){this.route=r,this.childContexts=n,this.parent=e,this.outletData=t}get(r,n){return r===Ne?this.route:r===cn?this.childContexts:r===qa?this.outletData:this.parent.get(r,n)}},zi=new Ce("");var Go=(()=>{class i{static \u0275fac=function(e){return new(e||i)};static \u0275cmp=B({type:i,selectors:[["ng-component"]],exportAs:["emptyRouterOutlet"],decls:1,vars:0,template:function(e,t){e&1&&y(0,"router-outlet")},dependencies:[Un],encapsulation:2})}return i})();function Jo(i){let r=i.children&&i.children.map(Jo),n=r?ge(I({},i),{children:r}):I({},i);return!n.component&&!n.loadComponent&&(r||n.loadChildren)&&n.outlet&&n.outlet!==L&&(n.component=Go),n}function Pl(i,r,n){let e=Nn(i,r._root,n?n._root:void 0);return new Dn(e,r)}function Nn(i,r,n){if(n&&i.shouldReuseRoute(r.value,n.value.snapshot)){let e=n.value;e._futureSnapshot=r.value;let t=Sl(i,r,n);return new De(e,t)}else{if(i.shouldAttach(r.value)){let o=i.retrieve(r.value);if(o!==null){let a=o.route;return a.value._futureSnapshot=r.value,a.children=r.children.map(d=>Nn(i,d)),a}}let e=Ol(r.value),t=r.children.map(o=>Nn(i,o));return new De(e,t)}}function Sl(i,r,n){return r.children.map(e=>{for(let t of n.children)if(i.shouldReuseRoute(e.value,t.value.snapshot))return Nn(i,e,t);return Nn(i,e)})}function Ol(i){return new Ne(new Pe(i.url),new Pe(i.params),new Pe(i.queryParams),new Pe(i.fragment),new Pe(i.data),i.outlet,i.component,i)}var an=class{redirectTo;navigationBehaviorOptions;constructor(r,n){this.redirectTo=r,this.navigationBehaviorOptions=n}},Ua="ngNavigationCancelingError";function Ai(i,r){let{redirectTo:n,navigationBehaviorOptions:e}=Ot(r)?{redirectTo:r,navigationBehaviorOptions:void 0}:r,t=Wa(!1,ye.Redirect);return t.url=n,t.navigationBehaviorOptions=e,t}function Wa(i,r){let n=new Error(`NavigationCancelingError: ${i||""}`);return n[Ua]=!0,n.cancellationCode=r,n}function kl(i){return $a(i)&&Ot(i.url)}function $a(i){return!!i&&i[Ua]}var El=(i,r,n,e)=>Z(t=>(new qo(r,t.targetRouterState,t.currentRouterState,n,e).activate(i),t)),qo=class{routeReuseStrategy;futureState;currState;forwardEvent;inputBindingEnabled;constructor(r,n,e,t,o){this.routeReuseStrategy=r,this.futureState=n,this.currState=e,this.forwardEvent=t,this.inputBindingEnabled=o}activate(r){let n=this.futureState._root,e=this.currState?this.currState._root:null;this.deactivateChildRoutes(n,e,r),To(this.futureState.root),this.activateChildRoutes(n,e,r)}deactivateChildRoutes(r,n,e){let t=en(n);r.children.forEach(o=>{let a=o.value.outlet;this.deactivateRoutes(o,t[a],e),delete t[a]}),Object.values(t).forEach(o=>{this.deactivateRouteAndItsChildren(o,e)})}deactivateRoutes(r,n,e){let t=r.value,o=n?n.value:null;if(t===o)if(t.component){let a=e.getContext(t.outlet);a&&this.deactivateChildRoutes(r,n,a.children)}else this.deactivateChildRoutes(r,n,e);else o&&this.deactivateRouteAndItsChildren(n,e)}deactivateRouteAndItsChildren(r,n){r.value.component&&this.routeReuseStrategy.shouldDetach(r.value.snapshot)?this.detachAndStoreRouteSubtree(r,n):this.deactivateRouteAndOutlet(r,n)}detachAndStoreRouteSubtree(r,n){let e=n.getContext(r.value.outlet),t=e&&r.value.component?e.children:n,o=en(r);for(let a of Object.values(o))this.deactivateRouteAndItsChildren(a,t);if(e&&e.outlet){let a=e.outlet.detach(),d=e.children.onOutletDeactivated();this.routeReuseStrategy.store(r.value.snapshot,{componentRef:a,route:r,contexts:d})}}deactivateRouteAndOutlet(r,n){let e=n.getContext(r.value.outlet),t=e&&r.value.component?e.children:n,o=en(r);for(let a of Object.values(o))this.deactivateRouteAndItsChildren(a,t);e&&(e.outlet&&(e.outlet.deactivate(),e.children.onOutletDeactivated()),e.attachRef=null,e.route=null)}activateChildRoutes(r,n,e){let t=en(n);r.children.forEach(o=>{this.activateRoutes(o,t[o.value.outlet],e),this.forwardEvent(new ji(o.value.snapshot))}),r.children.length&&this.forwardEvent(new Ti(r.value.snapshot))}activateRoutes(r,n,e){let t=r.value,o=n?n.value:null;if(To(t),t===o)if(t.component){let a=e.getOrCreateContext(t.outlet);this.activateChildRoutes(r,n,a.children)}else this.activateChildRoutes(r,n,e);else if(t.component){let a=e.getOrCreateContext(t.outlet);if(this.routeReuseStrategy.shouldAttach(t.snapshot)){let d=this.routeReuseStrategy.retrieve(t.snapshot);this.routeReuseStrategy.store(t.snapshot,null),a.children.onOutletReAttached(d.contexts),a.attachRef=d.componentRef,a.route=d.route.value,a.outlet&&a.outlet.attach(d.componentRef,d.route.value),To(d.route.value),this.activateChildRoutes(r,null,a.children)}else a.attachRef=null,a.route=t,a.outlet&&a.outlet.activateWith(t,a.injector),this.activateChildRoutes(r,null,a.children)}else this.activateChildRoutes(r,null,e)}},Ni=class{path;route;constructor(r){this.path=r,this.route=this.path[this.path.length-1]}},nn=class{component;route;constructor(r,n){this.component=r,this.route=n}};function Tl(i,r,n){let e=i._root,t=r?r._root:null;return On(e,t,n,[e.value])}function Il(i){let r=i.routeConfig?i.routeConfig.canActivateChild:null;return!r||r.length===0?null:{node:i,guards:r}}function dn(i,r){let n=Symbol(),e=r.get(i,n);return e===n?typeof i=="function"&&!gr(i)?i:r.get(i):e}function On(i,r,n,e,t={canDeactivateChecks:[],canActivateChecks:[]}){let o=en(r);return i.children.forEach(a=>{jl(a,o[a.value.outlet],n,e.concat([a.value]),t),delete o[a.value.outlet]}),Object.entries(o).forEach(([a,d])=>Tn(d,n.getContext(a),t)),t}function jl(i,r,n,e,t={canDeactivateChecks:[],canActivateChecks:[]}){let o=i.value,a=r?r.value:null,d=n?n.getContext(i.value.outlet):null;if(a&&o.routeConfig===a.routeConfig){let m=Rl(a,o,o.routeConfig.runGuardsAndResolvers);m?t.canActivateChecks.push(new Ni(e)):(o.data=a.data,o._resolvedData=a._resolvedData),o.component?On(i,r,d?d.children:null,e,t):On(i,r,n,e,t),m&&d&&d.outlet&&d.outlet.isActivated&&t.canDeactivateChecks.push(new nn(d.outlet.component,a))}else a&&Tn(r,d,t),t.canActivateChecks.push(new Ni(e)),o.component?On(i,null,d?d.children:null,e,t):On(i,null,n,e,t);return t}function Rl(i,r,n){if(typeof n=="function")return n(i,r);switch(n){case"pathParamsChange":return!Nt(i.url,r.url);case"pathParamsOrQueryParamsChange":return!Nt(i.url,r.url)||!et(i.queryParams,r.queryParams);case"always":return!0;case"paramsOrQueryParamsChange":return!zo(i,r)||!et(i.queryParams,r.queryParams);case"paramsChange":default:return!zo(i,r)}}function Tn(i,r,n){let e=en(i),t=i.value;Object.entries(e).forEach(([o,a])=>{t.component?r?Tn(a,r.children.getContext(o),n):Tn(a,null,n):Tn(a,r,n)}),t.component?r&&r.outlet&&r.outlet.isActivated?n.canDeactivateChecks.push(new nn(r.outlet.component,t)):n.canDeactivateChecks.push(new nn(null,t)):n.canDeactivateChecks.push(new nn(null,t))}function Wn(i){return typeof i=="function"}function Vl(i){return typeof i=="boolean"}function Dl(i){return i&&Wn(i.canLoad)}function Al(i){return i&&Wn(i.canActivate)}function Nl(i){return i&&Wn(i.canActivateChild)}function Ll(i){return i&&Wn(i.canDeactivate)}function zl(i){return i&&Wn(i.canMatch)}function Ba(i){return i instanceof lr||i?.name==="EmptyError"}var _i=Symbol("INITIAL_VALUE");function sn(){return Ve(i=>eo(i.map(r=>r.pipe(Wt(1),ur(_i)))).pipe(Z(r=>{for(let n of r)if(n!==!0){if(n===_i)return _i;if(n===!1||Fl(n))return n}return!0}),vt(r=>r!==_i),Wt(1)))}function Fl(i){return Ot(i)||i instanceof an}function ql(i,r){return Re(n=>{let{targetSnapshot:e,currentSnapshot:t,guards:{canActivateChecks:o,canDeactivateChecks:a}}=n;return a.length===0&&o.length===0?N(ge(I({},n),{guardsResult:!0})):Ul(a,e,t,i).pipe(Re(d=>d&&Vl(d)?Wl(e,o,i,r):N(d)),Z(d=>ge(I({},n),{guardsResult:d})))})}function Ul(i,r,n,e){return je(i).pipe(Re(t=>Jl(t.component,t.route,n,r,e)),Ct(t=>t!==!0,!0))}function Wl(i,r,n,e){return je(r).pipe(Ut(t=>cr(Bl(t.route.parent,e),$l(t.route,e),Gl(i,t.path,n),Hl(i,t.route,n))),Ct(t=>t!==!0,!0))}function $l(i,r){return i!==null&&r&&r(new Ii(i)),N(!0)}function Bl(i,r){return i!==null&&r&&r(new Ei(i)),N(!0)}function Hl(i,r,n){let e=r.routeConfig?r.routeConfig.canActivate:null;if(!e||e.length===0)return N(!0);let t=e.map(o=>Hn(()=>{let a=ln(r)??n,d=dn(o,a),m=Al(d)?d.canActivate(r,i):Ge(a,()=>d(r,i));return _t(m).pipe(Ct())}));return N(t).pipe(sn())}function Gl(i,r,n){let e=r[r.length-1],o=r.slice(0,r.length-1).reverse().map(a=>Il(a)).filter(a=>a!==null).map(a=>Hn(()=>{let d=a.guards.map(m=>{let C=ln(a.node)??n,b=dn(m,C),x=Nl(b)?b.canActivateChild(e,i):Ge(C,()=>b(e,i));return _t(x).pipe(Ct())});return N(d).pipe(sn())}));return N(o).pipe(sn())}function Jl(i,r,n,e,t){let o=r&&r.routeConfig?r.routeConfig.canDeactivate:null;if(!o||o.length===0)return N(!0);let a=o.map(d=>{let m=ln(r)??t,C=dn(d,m),b=Ll(C)?C.canDeactivate(i,r,n,e):Ge(m,()=>C(i,r,n,e));return _t(b).pipe(Ct())});return N(a).pipe(sn())}function Yl(i,r,n,e){let t=r.canLoad;if(t===void 0||t.length===0)return N(!0);let o=t.map(a=>{let d=dn(a,i),m=Dl(d)?d.canLoad(r,n):Ge(i,()=>d(r,n));return _t(m)});return N(o).pipe(sn(),Ha(e))}function Ha(i){return rr(he(r=>{if(typeof r!="boolean")throw Ai(i,r)}),Z(r=>r===!0))}function Ql(i,r,n,e){let t=r.canMatch;if(!t||t.length===0)return N(!0);let o=t.map(a=>{let d=dn(a,i),m=zl(d)?d.canMatch(r,n):Ge(i,()=>d(r,n));return _t(m)});return N(o).pipe(sn(),Ha(e))}var Ln=class{segmentGroup;constructor(r){this.segmentGroup=r||null}},zn=class extends Error{urlTree;constructor(r){super(),this.urlTree=r}};function Xt(i){return hn(new Ln(i))}function Kl(i){return hn(new le(4e3,!1))}function Zl(i){return hn(Wa(!1,ye.GuardRejected))}var Uo=class{urlSerializer;urlTree;constructor(r,n){this.urlSerializer=r,this.urlTree=n}lineralizeSegments(r,n){let e=[],t=n.root;for(;;){if(e=e.concat(t.segments),t.numberOfChildren===0)return N(e);if(t.numberOfChildren>1||!t.children[L])return Kl(`${r.redirectTo}`);t=t.children[L]}}applyRedirectCommands(r,n,e,t,o){return Xl(n,t,o).pipe(Z(a=>{if(a instanceof nt)throw new zn(a);let d=this.applyRedirectCreateUrlTree(a,this.urlSerializer.parse(a),r,e);if(a[0]==="/")throw new zn(d);return d}))}applyRedirectCreateUrlTree(r,n,e,t){let o=this.createSegmentGroup(r,n.root,e,t);return new nt(o,this.createQueryParams(n.queryParams,this.urlTree.queryParams),n.fragment)}createQueryParams(r,n){let e={};return Object.entries(r).forEach(([t,o])=>{if(typeof o=="string"&&o[0]===":"){let d=o.substring(1);e[t]=n[d]}else e[t]=o}),e}createSegmentGroup(r,n,e,t){let o=this.createSegments(r,n.segments,e,t),a={};return Object.entries(n.children).forEach(([d,m])=>{a[d]=this.createSegmentGroup(r,m,e,t)}),new Y(o,a)}createSegments(r,n,e,t){return n.map(o=>o.path[0]===":"?this.findPosParam(r,o,t):this.findOrReturn(o,e))}findPosParam(r,n,e){let t=e[n.path.substring(1)];if(!t)throw new le(4001,!1);return t}findOrReturn(r,n){let e=0;for(let t of n){if(t.path===r.path)return n.splice(e),t;e++}return r}};function Xl(i,r,n){if(typeof i=="string")return N(i);let e=i,{queryParams:t,fragment:o,routeConfig:a,url:d,outlet:m,params:C,data:b,title:x}=r;return _t(Ge(n,()=>e({params:C,data:b,queryParams:t,fragment:o,routeConfig:a,url:d,outlet:m,title:x})))}var Wo={matched:!1,consumedSegments:[],remainingSegments:[],parameters:{},positionalParamSegments:{}};function ec(i,r,n,e,t){let o=Ga(i,r,n);return o.matched?(e=wl(r,e),Ql(e,r,n,t).pipe(Z(a=>a===!0?o:I({},Wo)))):N(o)}function Ga(i,r,n){if(r.path==="**")return tc(n);if(r.path==="")return r.pathMatch==="full"&&(i.hasChildren()||n.length>0)?I({},Wo):{matched:!0,consumedSegments:[],remainingSegments:n,parameters:{},positionalParamSegments:{}};let t=(r.matcher||wa)(n,i,r);if(!t)return I({},Wo);let o={};Object.entries(t.posParams??{}).forEach(([d,m])=>{o[d]=m.path});let a=t.consumed.length>0?I(I({},o),t.consumed[t.consumed.length-1].parameters):o;return{matched:!0,consumedSegments:t.consumed,remainingSegments:n.slice(t.consumed.length),parameters:a,positionalParamSegments:t.posParams??{}}}function tc(i){return{matched:!0,parameters:i.length>0?Ma(i).parameters:{},consumedSegments:i,remainingSegments:[],positionalParamSegments:{}}}function Ca(i,r,n,e){return n.length>0&&oc(i,n,e)?{segmentGroup:new Y(r,ic(e,new Y(n,i.children))),slicedSegments:[]}:n.length===0&&rc(i,n,e)?{segmentGroup:new Y(i.segments,nc(i,n,e,i.children)),slicedSegments:n}:{segmentGroup:new Y(i.segments,i.children),slicedSegments:n}}function nc(i,r,n,e){let t={};for(let o of n)if(Fi(i,r,o)&&!e[Qe(o)]){let a=new Y([],{});t[Qe(o)]=a}return I(I({},e),t)}function ic(i,r){let n={};n[L]=r;for(let e of i)if(e.path===""&&Qe(e)!==L){let t=new Y([],{});n[Qe(e)]=t}return n}function oc(i,r,n){return n.some(e=>Fi(i,r,e)&&Qe(e)!==L)}function rc(i,r,n){return n.some(e=>Fi(i,r,e))}function Fi(i,r,n){return(i.hasChildren()||r.length>0)&&n.pathMatch==="full"?!1:n.path===""}function ac(i,r,n){return r.length===0&&!i.children[n]}var $o=class{};function sc(i,r,n,e,t,o,a="emptyOnly"){return new Bo(i,r,n,e,t,a,o).recognize()}var lc=31,Bo=class{injector;configLoader;rootComponentType;config;urlTree;paramsInheritanceStrategy;urlSerializer;applyRedirects;absoluteRedirectCount=0;allowRedirects=!0;constructor(r,n,e,t,o,a,d){this.injector=r,this.configLoader=n,this.rootComponentType=e,this.config=t,this.urlTree=o,this.paramsInheritanceStrategy=a,this.urlSerializer=d,this.applyRedirects=new Uo(this.urlSerializer,this.urlTree)}noMatchError(r){return new le(4002,`'${r.segmentGroup}'`)}recognize(){let r=Ca(this.urlTree.root,[],[],this.config).segmentGroup;return this.match(r).pipe(Z(({children:n,rootSnapshot:e})=>{let t=new De(e,n),o=new An("",t),a=Ra(e,[],this.urlTree.queryParams,this.urlTree.fragment);return a.queryParams=this.urlTree.queryParams,o.url=this.urlSerializer.serialize(a),{state:o,tree:a}}))}match(r){let n=new Lt([],Object.freeze({}),Object.freeze(I({},this.urlTree.queryParams)),this.urlTree.fragment,Object.freeze({}),L,this.rootComponentType,null,{});return this.processSegmentGroup(this.injector,this.config,r,L,n).pipe(Z(e=>({children:e,rootSnapshot:n})),Vt(e=>{if(e instanceof zn)return this.urlTree=e.urlTree,this.match(e.urlTree.root);throw e instanceof Ln?this.noMatchError(e):e}))}processSegmentGroup(r,n,e,t,o){return e.segments.length===0&&e.hasChildren()?this.processChildren(r,n,e,o):this.processSegment(r,n,e,e.segments,t,!0,o).pipe(Z(a=>a instanceof De?[a]:[]))}processChildren(r,n,e,t){let o=[];for(let a of Object.keys(e.children))a==="primary"?o.unshift(a):o.push(a);return je(o).pipe(Ut(a=>{let d=e.children[a],m=yl(n,a);return this.processSegmentGroup(r,m,d,a,t)}),pr((a,d)=>(a.push(...d),a)),no(null),dr(),Re(a=>{if(a===null)return Xt(e);let d=Ja(a);return cc(d),N(d)}))}processSegment(r,n,e,t,o,a,d){return je(n).pipe(Ut(m=>this.processSegmentAgainstRoute(m._injector??r,n,m,e,t,o,a,d).pipe(Vt(C=>{if(C instanceof Ln)return N(null);throw C}))),Ct(m=>!!m),Vt(m=>{if(Ba(m))return ac(e,t,o)?N(new $o):Xt(e);throw m}))}processSegmentAgainstRoute(r,n,e,t,o,a,d,m){return Qe(e)!==a&&(a===L||!Fi(t,o,e))?Xt(t):e.redirectTo===void 0?this.matchSegmentAgainstRoute(r,t,e,o,a,m):this.allowRedirects&&d?this.expandSegmentAgainstRouteUsingRedirect(r,t,n,e,o,a,m):Xt(t)}expandSegmentAgainstRouteUsingRedirect(r,n,e,t,o,a,d){let{matched:m,parameters:C,consumedSegments:b,positionalParamSegments:x,remainingSegments:M}=Ga(n,t,o);if(!m)return Xt(n);typeof t.redirectTo=="string"&&t.redirectTo[0]==="/"&&(this.absoluteRedirectCount++,this.absoluteRedirectCount>lc&&(this.allowRedirects=!1));let D=new Lt(o,C,Object.freeze(I({},this.urlTree.queryParams)),this.urlTree.fragment,xa(t),Qe(t),t.component??t._loadedComponent??null,t,ba(t)),Q=Di(D,d,this.paramsInheritanceStrategy);return D.params=Object.freeze(Q.params),D.data=Object.freeze(Q.data),this.applyRedirects.applyRedirectCommands(b,t.redirectTo,x,D,r).pipe(Ve(se=>this.applyRedirects.lineralizeSegments(t,se)),Re(se=>this.processSegment(r,e,n,se.concat(M),a,!1,d)))}matchSegmentAgainstRoute(r,n,e,t,o,a){let d=ec(n,e,t,r,this.urlSerializer);return e.path==="**"&&(n.children={}),d.pipe(Ve(m=>m.matched?(r=e._injector??r,this.getChildConfig(r,e,t).pipe(Ve(({routes:C})=>{let b=e._loadedInjector??r,{parameters:x,consumedSegments:M,remainingSegments:D}=m,Q=new Lt(M,x,Object.freeze(I({},this.urlTree.queryParams)),this.urlTree.fragment,xa(e),Qe(e),e.component??e._loadedComponent??null,e,ba(e)),ae=Di(Q,a,this.paramsInheritanceStrategy);Q.params=Object.freeze(ae.params),Q.data=Object.freeze(ae.data);let{segmentGroup:se,slicedSegments:Me}=Ca(n,M,D,C);if(Me.length===0&&se.hasChildren())return this.processChildren(b,C,se,Q).pipe(Z(ve=>new De(Q,ve)));if(C.length===0&&Me.length===0)return N(new De(Q,[]));let Le=Qe(e)===o;return this.processSegment(b,C,se,Me,Le?L:o,!0,Q).pipe(Z(ve=>new De(Q,ve instanceof De?[ve]:[])))}))):Xt(n)))}getChildConfig(r,n,e){return n.children?N({routes:n.children,injector:r}):n.loadChildren?n._loadedRoutes!==void 0?N({routes:n._loadedRoutes,injector:n._loadedInjector}):Yl(r,n,e,this.urlSerializer).pipe(Re(t=>t?this.configLoader.loadChildren(r,n).pipe(he(o=>{n._loadedRoutes=o.routes,n._loadedInjector=o.injector})):Zl(n))):N({routes:[],injector:r})}};function cc(i){i.sort((r,n)=>r.value.outlet===L?-1:n.value.outlet===L?1:r.value.outlet.localeCompare(n.value.outlet))}function dc(i){let r=i.value.routeConfig;return r&&r.path===""}function Ja(i){let r=[],n=new Set;for(let e of i){if(!dc(e)){r.push(e);continue}let t=r.find(o=>e.value.routeConfig===o.value.routeConfig);t!==void 0?(t.children.push(...e.children),n.add(t)):r.push(e)}for(let e of n){let t=Ja(e.children);r.push(new De(e.value,t))}return r.filter(e=>!n.has(e))}function xa(i){return i.data||{}}function ba(i){return i.resolve||{}}function pc(i,r,n,e,t,o){return Re(a=>sc(i,r,n,e,a.extractedUrl,t,o).pipe(Z(({state:d,tree:m})=>ge(I({},a),{targetSnapshot:d,urlAfterRedirects:m}))))}function uc(i,r){return Re(n=>{let{targetSnapshot:e,guards:{canActivateChecks:t}}=n;if(!t.length)return N(n);let o=new Set(t.map(m=>m.route)),a=new Set;for(let m of o)if(!a.has(m))for(let C of Ya(m))a.add(C);let d=0;return je(a).pipe(Ut(m=>o.has(m)?mc(m,e,i,r):(m.data=Di(m,m.parent,i).resolve,N(void 0))),he(()=>d++),io(1),Re(m=>d===a.size?N(n):ct))})}function Ya(i){let r=i.children.map(n=>Ya(n)).flat();return[i,...r]}function mc(i,r,n,e){let t=i.routeConfig,o=i._resolve;return t?.title!==void 0&&!Fa(t)&&(o[Fn]=t.title),Hn(()=>(i.data=Di(i,i.parent,n).resolve,gc(o,i,r,e).pipe(Z(a=>(i._resolvedData=a,i.data=I(I({},i.data),a),null)))))}function gc(i,r,n,e){let t=Ro(i);if(t.length===0)return N({});let o={};return je(t).pipe(Re(a=>fc(i[a],r,n,e).pipe(Ct(),he(d=>{if(d instanceof an)throw Ai(new Ft,d);o[a]=d}))),io(1),Z(()=>o),Vt(a=>Ba(a)?ct:hn(a)))}function fc(i,r,n,e){let t=ln(r)??e,o=dn(i,t),a=o.resolve?o.resolve(r,n):Ge(t,()=>o(r,n));return _t(a)}function Io(i){return Ve(r=>{let n=i(r);return n?je(n).pipe(Z(()=>r)):N(r)})}var Yo=(()=>{class i{buildTitle(n){let e,t=n.root;for(;t!==void 0;)e=this.getResolvedTitleForRoute(t)??e,t=t.children.find(o=>o.outlet===L);return e}getResolvedTitleForRoute(n){return n.data[Fn]}static \u0275fac=function(e){return new(e||i)};static \u0275prov=A({token:i,factory:()=>j(Qa),providedIn:"root"})}return i})(),Qa=(()=>{class i extends Yo{title;constructor(n){super(),this.title=n}updateTitle(n){let e=this.buildTitle(n);e!==void 0&&this.title.setTitle(e)}static \u0275fac=function(e){return new(e||i)(V(ga))};static \u0275prov=A({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),pn=new Ce("",{providedIn:"root",factory:()=>({})}),$n=new Ce(""),Ka=(()=>{class i{componentLoaders=new WeakMap;childrenLoaders=new WeakMap;onLoadStartListener;onLoadEndListener;compiler=j(Dr);loadComponent(n,e){if(this.componentLoaders.get(e))return this.componentLoaders.get(e);if(e._loadedComponent)return N(e._loadedComponent);this.onLoadStartListener&&this.onLoadStartListener(e);let t=_t(Ge(n,()=>e.loadComponent())).pipe(Z(Xa),Ve(es),he(a=>{this.onLoadEndListener&&this.onLoadEndListener(e),e._loadedComponent=a}),Gn(()=>{this.componentLoaders.delete(e)})),o=new Xi(t,()=>new lt).pipe(Zi());return this.componentLoaders.set(e,o),o}loadChildren(n,e){if(this.childrenLoaders.get(e))return this.childrenLoaders.get(e);if(e._loadedRoutes)return N({routes:e._loadedRoutes,injector:e._loadedInjector});this.onLoadStartListener&&this.onLoadStartListener(e);let o=Za(e,this.compiler,n,this.onLoadEndListener).pipe(Gn(()=>{this.childrenLoaders.delete(e)})),a=new Xi(o,()=>new lt).pipe(Zi());return this.childrenLoaders.set(e,a),a}static \u0275fac=function(e){return new(e||i)};static \u0275prov=A({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function Za(i,r,n,e){return _t(Ge(n,()=>i.loadChildren())).pipe(Z(Xa),Ve(es),Re(t=>t instanceof Or||Array.isArray(t)?N(t):je(r.compileModuleAsync(t))),Z(t=>{e&&e(i);let o,a,d=!1;return Array.isArray(t)?(a=t,d=!0):(o=t.create(n).injector,a=o.get($n,[],{optional:!0,self:!0}).flat()),{routes:a.map(Jo),injector:o}}))}function hc(i){return i&&typeof i=="object"&&"default"in i}function Xa(i){return hc(i)?i.default:i}function es(i){return N(i)}var qi=(()=>{class i{static \u0275fac=function(e){return new(e||i)};static \u0275prov=A({token:i,factory:()=>j(_c),providedIn:"root"})}return i})(),_c=(()=>{class i{shouldProcessUrl(n){return!0}extract(n){return n}merge(n,e){return n}static \u0275fac=function(e){return new(e||i)};static \u0275prov=A({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),ts=new Ce("");var ns=new Ce(""),is=(()=>{class i{currentNavigation=ee(null,{equal:()=>!1});currentTransition=null;lastSuccessfulNavigation=null;events=new lt;transitionAbortWithErrorSubject=new lt;configLoader=j(Ka);environmentInjector=j($t);destroyRef=j(_r);urlSerializer=j(qn);rootContexts=j(cn);location=j(ti);inputBindingEnabled=j(zi,{optional:!0})!==null;titleStrategy=j(Yo);options=j(pn,{optional:!0})||{};paramsInheritanceStrategy=this.options.paramsInheritanceStrategy||"emptyOnly";urlHandlingStrategy=j(qi);createViewTransition=j(ts,{optional:!0});navigationErrorHandler=j(ns,{optional:!0});navigationId=0;get hasRequestedNavigation(){return this.navigationId!==0}transitions;afterPreactivation=()=>N(void 0);rootComponentType=null;destroyed=!1;constructor(){let n=t=>this.events.next(new Oi(t)),e=t=>this.events.next(new ki(t));this.configLoader.onLoadEndListener=e,this.configLoader.onLoadStartListener=n,this.destroyRef.onDestroy(()=>{this.destroyed=!0})}complete(){this.transitions?.complete()}handleNavigationRequest(n){let e=++this.navigationId;bt(()=>{this.transitions?.next(ge(I({},n),{extractedUrl:this.urlHandlingStrategy.extract(n.rawUrl),targetSnapshot:null,targetRouterState:null,guards:{canActivateChecks:[],canDeactivateChecks:[]},guardsResult:null,abortController:new AbortController,id:e}))})}setupNavigations(n){return this.transitions=new Pe(null),this.transitions.pipe(vt(e=>e!==null),Ve(e=>{let t=!1;return N(e).pipe(Ve(o=>{if(this.navigationId>e.id)return this.cancelNavigationTransition(e,"",ye.SupersededByNewNavigation),ct;this.currentTransition=e,this.currentNavigation.set({id:o.id,initialUrl:o.rawUrl,extractedUrl:o.extractedUrl,targetBrowserUrl:typeof o.extras.browserUrl=="string"?this.urlSerializer.parse(o.extras.browserUrl):o.extras.browserUrl,trigger:o.source,extras:o.extras,previousNavigation:this.lastSuccessfulNavigation?ge(I({},this.lastSuccessfulNavigation),{previousNavigation:null}):null,abort:()=>o.abortController.abort()});let a=!n.navigated||this.isUpdatingInternalState()||this.isUpdatedBrowserUrl(),d=o.extras.onSameUrlNavigation??n.onSameUrlNavigation;if(!a&&d!=="reload")return this.events.next(new ht(o.id,this.urlSerializer.serialize(o.rawUrl),"",jn.IgnoredSameUrlNavigation)),o.resolve(!1),ct;if(this.urlHandlingStrategy.shouldProcessUrl(o.rawUrl))return N(o).pipe(Ve(m=>(this.events.next(new qt(m.id,this.urlSerializer.serialize(m.extractedUrl),m.source,m.restoredState)),m.id!==this.navigationId?ct:Promise.resolve(m))),pc(this.environmentInjector,this.configLoader,this.rootComponentType,n.config,this.urlSerializer,this.paramsInheritanceStrategy),he(m=>{e.targetSnapshot=m.targetSnapshot,e.urlAfterRedirects=m.urlAfterRedirects,this.currentNavigation.update(b=>(b.finalUrl=m.urlAfterRedirects,b));let C=new Rn(m.id,this.urlSerializer.serialize(m.extractedUrl),this.urlSerializer.serialize(m.urlAfterRedirects),m.targetSnapshot);this.events.next(C)}));if(a&&this.urlHandlingStrategy.shouldProcessUrl(o.currentRawUrl)){let{id:m,extractedUrl:C,source:b,restoredState:x,extras:M}=o,D=new qt(m,this.urlSerializer.serialize(C),b,x);this.events.next(D);let Q=La(this.rootComponentType).snapshot;return this.currentTransition=e=ge(I({},o),{targetSnapshot:Q,urlAfterRedirects:C,extras:ge(I({},M),{skipLocationChange:!1,replaceUrl:!1})}),this.currentNavigation.update(ae=>(ae.finalUrl=C,ae)),N(e)}else return this.events.next(new ht(o.id,this.urlSerializer.serialize(o.extractedUrl),"",jn.IgnoredByUrlHandlingStrategy)),o.resolve(!1),ct}),he(o=>{let a=new yi(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot);this.events.next(a)}),Z(o=>(this.currentTransition=e=ge(I({},o),{guards:Tl(o.targetSnapshot,o.currentSnapshot,this.rootContexts)}),e)),ql(this.environmentInjector,o=>this.events.next(o)),he(o=>{if(e.guardsResult=o.guardsResult,o.guardsResult&&typeof o.guardsResult!="boolean")throw Ai(this.urlSerializer,o.guardsResult);let a=new Mi(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects),o.targetSnapshot,!!o.guardsResult);this.events.next(a)}),vt(o=>o.guardsResult?!0:(this.cancelNavigationTransition(o,"",ye.GuardRejected),!1)),Io(o=>{if(o.guards.canActivateChecks.length!==0)return N(o).pipe(he(a=>{let d=new Pi(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(d)}),Ve(a=>{let d=!1;return N(a).pipe(uc(this.paramsInheritanceStrategy,this.environmentInjector),he({next:()=>d=!0,complete:()=>{d||this.cancelNavigationTransition(a,"",ye.NoDataFromResolver)}}))}),he(a=>{let d=new Si(a.id,this.urlSerializer.serialize(a.extractedUrl),this.urlSerializer.serialize(a.urlAfterRedirects),a.targetSnapshot);this.events.next(d)}))}),Io(o=>{let a=d=>{let m=[];if(d.routeConfig?.loadComponent){let C=ln(d)??this.environmentInjector;m.push(this.configLoader.loadComponent(C,d.routeConfig).pipe(he(b=>{d.component=b}),Z(()=>{})))}for(let C of d.children)m.push(...a(C));return m};return eo(a(o.targetSnapshot.root)).pipe(no(null),Wt(1))}),Io(()=>this.afterPreactivation()),Ve(()=>{let{currentSnapshot:o,targetSnapshot:a}=e,d=this.createViewTransition?.(this.environmentInjector,o.root,a.root);return d?je(d).pipe(Z(()=>e)):N(e)}),Z(o=>{let a=Pl(n.routeReuseStrategy,o.targetSnapshot,o.currentRouterState);return this.currentTransition=e=ge(I({},o),{targetRouterState:a}),this.currentNavigation.update(d=>(d.targetRouterState=a,d)),e}),he(()=>{this.events.next(new Vn)}),El(this.rootContexts,n.routeReuseStrategy,o=>this.events.next(o),this.inputBindingEnabled),Wt(1),oo(new ar(o=>{let a=e.abortController.signal,d=()=>o.next();return a.addEventListener("abort",d),()=>a.removeEventListener("abort",d)}).pipe(vt(()=>!t&&!e.targetRouterState),he(()=>{this.cancelNavigationTransition(e,e.abortController.signal.reason+"",ye.Aborted)}))),he({next:o=>{t=!0,this.lastSuccessfulNavigation=bt(this.currentNavigation),this.events.next(new Ke(o.id,this.urlSerializer.serialize(o.extractedUrl),this.urlSerializer.serialize(o.urlAfterRedirects))),this.titleStrategy?.updateTitle(o.targetRouterState.snapshot),o.resolve(!0)},complete:()=>{t=!0}}),oo(this.transitionAbortWithErrorSubject.pipe(he(o=>{throw o}))),Gn(()=>{t||this.cancelNavigationTransition(e,"",ye.SupersededByNewNavigation),this.currentTransition?.id===e.id&&(this.currentNavigation.set(null),this.currentTransition=null)}),Vt(o=>{if(this.destroyed)return e.resolve(!1),ct;if(t=!0,$a(o))this.events.next(new tt(e.id,this.urlSerializer.serialize(e.extractedUrl),o.message,o.cancellationCode)),kl(o)?this.events.next(new rn(o.url,o.navigationBehaviorOptions)):e.resolve(!1);else{let a=new on(e.id,this.urlSerializer.serialize(e.extractedUrl),o,e.targetSnapshot??void 0);try{let d=Ge(this.environmentInjector,()=>this.navigationErrorHandler?.(a));if(d instanceof an){let{message:m,cancellationCode:C}=Ai(this.urlSerializer,d);this.events.next(new tt(e.id,this.urlSerializer.serialize(e.extractedUrl),m,C)),this.events.next(new rn(d.redirectTo,d.navigationBehaviorOptions))}else throw this.events.next(a),o}catch(d){this.options.resolveNavigationPromiseOnError?e.resolve(!1):e.reject(d)}}return ct}))}))}cancelNavigationTransition(n,e,t){let o=new tt(n.id,this.urlSerializer.serialize(n.extractedUrl),e,t);this.events.next(o),n.resolve(!1)}isUpdatingInternalState(){return this.currentTransition?.extractedUrl.toString()!==this.currentTransition?.currentUrlTree.toString()}isUpdatedBrowserUrl(){let n=this.urlHandlingStrategy.extract(this.urlSerializer.parse(this.location.path(!0))),e=bt(this.currentNavigation),t=e?.targetBrowserUrl??e?.extractedUrl;return n.toString()!==t?.toString()&&!e?.extras.skipLocationChange}static \u0275fac=function(e){return new(e||i)};static \u0275prov=A({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function vc(i){return i!==En}var os=(()=>{class i{static \u0275fac=function(e){return new(e||i)};static \u0275prov=A({token:i,factory:()=>j(Cc),providedIn:"root"})}return i})(),Li=class{shouldDetach(r){return!1}store(r,n){}shouldAttach(r){return!1}retrieve(r){return null}shouldReuseRoute(r,n){return r.routeConfig===n.routeConfig}},Cc=(()=>{class i extends Li{static \u0275fac=(()=>{let n;return function(t){return(n||(n=so(i)))(t||i)}})();static \u0275prov=A({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})(),rs=(()=>{class i{urlSerializer=j(qn);options=j(pn,{optional:!0})||{};canceledNavigationResolution=this.options.canceledNavigationResolution||"replace";location=j(ti);urlHandlingStrategy=j(qi);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";currentUrlTree=new nt;getCurrentUrlTree(){return this.currentUrlTree}rawUrlTree=this.currentUrlTree;getRawUrlTree(){return this.rawUrlTree}createBrowserPath({finalUrl:n,initialUrl:e,targetBrowserUrl:t}){let o=n!==void 0?this.urlHandlingStrategy.merge(n,e):e,a=t??o;return a instanceof nt?this.urlSerializer.serialize(a):a}commitTransition({targetRouterState:n,finalUrl:e,initialUrl:t}){e&&n?(this.currentUrlTree=e,this.rawUrlTree=this.urlHandlingStrategy.merge(e,t),this.routerState=n):this.rawUrlTree=t}routerState=La(null);getRouterState(){return this.routerState}stateMemento=this.createStateMemento();updateStateMemento(){this.stateMemento=this.createStateMemento()}createStateMemento(){return{rawUrlTree:this.rawUrlTree,currentUrlTree:this.currentUrlTree,routerState:this.routerState}}resetInternalState({finalUrl:n}){this.routerState=this.stateMemento.routerState,this.currentUrlTree=this.stateMemento.currentUrlTree,this.rawUrlTree=this.urlHandlingStrategy.merge(this.currentUrlTree,n??this.rawUrlTree)}static \u0275fac=function(e){return new(e||i)};static \u0275prov=A({token:i,factory:()=>j(xc),providedIn:"root"})}return i})(),xc=(()=>{class i extends rs{currentPageId=0;lastSuccessfulId=-1;restoredState(){return this.location.getState()}get browserPageId(){return this.canceledNavigationResolution!=="computed"?this.currentPageId:this.restoredState()?.\u0275routerPageId??this.currentPageId}registerNonRouterCurrentEntryChangeListener(n){return this.location.subscribe(e=>{e.type==="popstate"&&setTimeout(()=>{n(e.url,e.state,"popstate")})})}handleRouterEvent(n,e){n instanceof qt?this.updateStateMemento():n instanceof ht?this.commitTransition(e):n instanceof Rn?this.urlUpdateStrategy==="eager"&&(e.extras.skipLocationChange||this.setBrowserUrl(this.createBrowserPath(e),e)):n instanceof Vn?(this.commitTransition(e),this.urlUpdateStrategy==="deferred"&&!e.extras.skipLocationChange&&this.setBrowserUrl(this.createBrowserPath(e),e)):n instanceof tt&&n.code!==ye.SupersededByNewNavigation&&n.code!==ye.Redirect?this.restoreHistory(e):n instanceof on?this.restoreHistory(e,!0):n instanceof Ke&&(this.lastSuccessfulId=n.id,this.currentPageId=this.browserPageId)}setBrowserUrl(n,{extras:e,id:t}){let{replaceUrl:o,state:a}=e;if(this.location.isCurrentPathEqualTo(n)||o){let d=this.browserPageId,m=I(I({},a),this.generateNgRouterState(t,d));this.location.replaceState(n,"",m)}else{let d=I(I({},a),this.generateNgRouterState(t,this.browserPageId+1));this.location.go(n,"",d)}}restoreHistory(n,e=!1){if(this.canceledNavigationResolution==="computed"){let t=this.browserPageId,o=this.currentPageId-t;o!==0?this.location.historyGo(o):this.getCurrentUrlTree()===n.finalUrl&&o===0&&(this.resetInternalState(n),this.resetUrlToCurrentUrlTree())}else this.canceledNavigationResolution==="replace"&&(e&&this.resetInternalState(n),this.resetUrlToCurrentUrlTree())}resetUrlToCurrentUrlTree(){this.location.replaceState(this.urlSerializer.serialize(this.getRawUrlTree()),"",this.generateNgRouterState(this.lastSuccessfulId,this.currentPageId))}generateNgRouterState(n,e){return this.canceledNavigationResolution==="computed"?{navigationId:n,\u0275routerPageId:e}:{navigationId:n}}static \u0275fac=(()=>{let n;return function(t){return(n||(n=so(i)))(t||i)}})();static \u0275prov=A({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function Qo(i,r){i.events.pipe(vt(n=>n instanceof Ke||n instanceof tt||n instanceof on||n instanceof ht),Z(n=>n instanceof Ke||n instanceof ht?0:(n instanceof tt?n.code===ye.Redirect||n.code===ye.SupersededByNewNavigation:!1)?2:1),vt(n=>n!==2),Wt(1)).subscribe(()=>{r()})}var bc={paths:"exact",fragment:"ignored",matrixParams:"ignored",queryParams:"exact"},wc={paths:"subset",fragment:"ignored",matrixParams:"ignored",queryParams:"subset"},pe=(()=>{class i{get currentUrlTree(){return this.stateManager.getCurrentUrlTree()}get rawUrlTree(){return this.stateManager.getRawUrlTree()}disposed=!1;nonRouterCurrentEntryChangeSubscription;console=j(kr);stateManager=j(rs);options=j(pn,{optional:!0})||{};pendingTasks=j(vr);urlUpdateStrategy=this.options.urlUpdateStrategy||"deferred";navigationTransitions=j(is);urlSerializer=j(qn);location=j(ti);urlHandlingStrategy=j(qi);injector=j($t);_events=new lt;get events(){return this._events}get routerState(){return this.stateManager.getRouterState()}navigated=!1;routeReuseStrategy=j(os);onSameUrlNavigation=this.options.onSameUrlNavigation||"ignore";config=j($n,{optional:!0})?.flat()??[];componentInputBindingEnabled=!!j(zi,{optional:!0});currentNavigation=this.navigationTransitions.currentNavigation.asReadonly();constructor(){this.resetConfig(this.config),this.navigationTransitions.setupNavigations(this).subscribe({error:n=>{this.console.warn(n)}}),this.subscribeToNavigationEvents()}eventsSubscription=new or;subscribeToNavigationEvents(){let n=this.navigationTransitions.events.subscribe(e=>{try{let t=this.navigationTransitions.currentTransition,o=bt(this.navigationTransitions.currentNavigation);if(t!==null&&o!==null){if(this.stateManager.handleRouterEvent(e,o),e instanceof tt&&e.code!==ye.Redirect&&e.code!==ye.SupersededByNewNavigation)this.navigated=!0;else if(e instanceof Ke)this.navigated=!0;else if(e instanceof rn){let a=e.navigationBehaviorOptions,d=this.urlHandlingStrategy.merge(e.url,t.currentRawUrl),m=I({browserUrl:t.extras.browserUrl,info:t.extras.info,skipLocationChange:t.extras.skipLocationChange,replaceUrl:t.extras.replaceUrl||this.urlUpdateStrategy==="eager"||vc(t.source)},a);this.scheduleNavigation(d,En,null,m,{resolve:t.resolve,reject:t.reject,promise:t.promise})}}bl(e)&&this._events.next(e)}catch(t){this.navigationTransitions.transitionAbortWithErrorSubject.next(t)}});this.eventsSubscription.add(n)}resetRootComponentType(n){this.routerState.root.component=n,this.navigationTransitions.rootComponentType=n}initialNavigation(){this.setUpLocationChangeListener(),this.navigationTransitions.hasRequestedNavigation||this.navigateToSyncWithBrowser(this.location.path(!0),En,this.stateManager.restoredState())}setUpLocationChangeListener(){this.nonRouterCurrentEntryChangeSubscription??=this.stateManager.registerNonRouterCurrentEntryChangeListener((n,e,t)=>{this.navigateToSyncWithBrowser(n,t,e)})}navigateToSyncWithBrowser(n,e,t){let o={replaceUrl:!0},a=t?.navigationId?t:null;if(t){let m=I({},t);delete m.navigationId,delete m.\u0275routerPageId,Object.keys(m).length!==0&&(o.state=m)}let d=this.parseUrl(n);this.scheduleNavigation(d,e,a,o).catch(m=>{this.disposed||this.injector.get(Jn)(m)})}get url(){return this.serializeUrl(this.currentUrlTree)}getCurrentNavigation(){return bt(this.navigationTransitions.currentNavigation)}get lastSuccessfulNavigation(){return this.navigationTransitions.lastSuccessfulNavigation}resetConfig(n){this.config=n.map(Jo),this.navigated=!1}ngOnDestroy(){this.dispose()}dispose(){this._events.unsubscribe(),this.navigationTransitions.complete(),this.nonRouterCurrentEntryChangeSubscription&&(this.nonRouterCurrentEntryChangeSubscription.unsubscribe(),this.nonRouterCurrentEntryChangeSubscription=void 0),this.disposed=!0,this.eventsSubscription.unsubscribe()}createUrlTree(n,e={}){let{relativeTo:t,queryParams:o,fragment:a,queryParamsHandling:d,preserveFragment:m}=e,C=m?this.currentUrlTree.fragment:a,b=null;switch(d??this.options.defaultQueryParamsHandling){case"merge":b=I(I({},this.currentUrlTree.queryParams),o);break;case"preserve":b=this.currentUrlTree.queryParams;break;default:b=o||null}b!==null&&(b=this.removeEmptyProps(b));let x;try{let M=t?t.snapshot:this.routerState.snapshot.root;x=Va(M)}catch{(typeof n[0]!="string"||n[0][0]!=="/")&&(n=[]),x=this.currentUrlTree.root}return Da(x,n,b,C??null)}navigateByUrl(n,e={skipLocationChange:!1}){let t=Ot(n)?n:this.parseUrl(n),o=this.urlHandlingStrategy.merge(t,this.rawUrlTree);return this.scheduleNavigation(o,En,null,e)}navigate(n,e={skipLocationChange:!1}){return yc(n),this.navigateByUrl(this.createUrlTree(n,e),e)}serializeUrl(n){return this.urlSerializer.serialize(n)}parseUrl(n){try{return this.urlSerializer.parse(n)}catch{return this.console.warn(mr(4018,!1)),this.urlSerializer.parse("/")}}isActive(n,e){let t;if(e===!0?t=I({},bc):e===!1?t=I({},wc):t=e,Ot(n))return fa(this.currentUrlTree,n,t);let o=this.parseUrl(n);return fa(this.currentUrlTree,o,t)}removeEmptyProps(n){return Object.entries(n).reduce((e,[t,o])=>(o!=null&&(e[t]=o),e),{})}scheduleNavigation(n,e,t,o,a){if(this.disposed)return Promise.resolve(!1);let d,m,C;a?(d=a.resolve,m=a.reject,C=a.promise):C=new Promise((x,M)=>{d=x,m=M});let b=this.pendingTasks.add();return Qo(this,()=>{queueMicrotask(()=>this.pendingTasks.remove(b))}),this.navigationTransitions.handleNavigationRequest({source:e,restoredState:t,currentUrlTree:this.currentUrlTree,currentRawUrl:this.currentUrlTree,rawUrl:n,extras:o,resolve:d,reject:m,promise:C,currentSnapshot:this.routerState.snapshot,currentRouterState:this.routerState}),C.catch(x=>Promise.reject(x))}static \u0275fac=function(e){return new(e||i)};static \u0275prov=A({token:i,factory:i.\u0275fac,providedIn:"root"})}return i})();function yc(i){for(let r=0;r<i.length;r++)if(i[r]==null)throw new le(4008,!1)}var kt=(()=>{class i{router;route;tabIndexAttribute;renderer;el;locationStrategy;reactiveHref=ee(null);get href(){return bt(this.reactiveHref)}set href(n){this.reactiveHref.set(n)}target;queryParams;fragment;queryParamsHandling;state;info;relativeTo;isAnchorElement;subscription;onChanges=new lt;applicationErrorHandler=j(Jn);options=j(pn,{optional:!0});constructor(n,e,t,o,a,d){this.router=n,this.route=e,this.tabIndexAttribute=t,this.renderer=o,this.el=a,this.locationStrategy=d,this.reactiveHref.set(j(new Ar("href"),{optional:!0}));let m=a.nativeElement.tagName?.toLowerCase();this.isAnchorElement=m==="a"||m==="area"||!!(typeof customElements=="object"&&customElements.get(m)?.observedAttributes?.includes?.("href")),this.isAnchorElement?this.setTabIndexIfNotOnNativeEl("0"):this.subscribeToNavigationEventsIfNecessary()}subscribeToNavigationEventsIfNecessary(){if(this.subscription!==void 0||!this.isAnchorElement)return;let n=this.preserveFragment,e=t=>t==="merge"||t==="preserve";n||=e(this.queryParamsHandling),n||=!this.queryParamsHandling&&!e(this.options?.defaultQueryParamsHandling),n&&(this.subscription=this.router.events.subscribe(t=>{t instanceof Ke&&this.updateHref()}))}preserveFragment=!1;skipLocationChange=!1;replaceUrl=!1;setTabIndexIfNotOnNativeEl(n){this.tabIndexAttribute!=null||this.isAnchorElement||this.applyAttributeValue("tabindex",n)}ngOnChanges(n){this.isAnchorElement&&(this.updateHref(),this.subscribeToNavigationEventsIfNecessary()),this.onChanges.next(this)}routerLinkInput=null;set routerLink(n){n==null?(this.routerLinkInput=null,this.setTabIndexIfNotOnNativeEl(null)):(Ot(n)?this.routerLinkInput=n:this.routerLinkInput=Array.isArray(n)?n:[n],this.setTabIndexIfNotOnNativeEl("0"))}onClick(n,e,t,o,a){let d=this.urlTree;if(d===null||this.isAnchorElement&&(n!==0||e||t||o||a||typeof this.target=="string"&&this.target!="_self"))return!0;let m={skipLocationChange:this.skipLocationChange,replaceUrl:this.replaceUrl,state:this.state,info:this.info};return this.router.navigateByUrl(d,m)?.catch(C=>{this.applicationErrorHandler(C)}),!this.isAnchorElement}ngOnDestroy(){this.subscription?.unsubscribe()}updateHref(){let n=this.urlTree;this.reactiveHref.set(n!==null&&this.locationStrategy?this.locationStrategy?.prepareExternalUrl(this.router.serializeUrl(n))??"":null)}applyAttributeValue(n,e){let t=this.renderer,o=this.el.nativeElement;e!==null?t.setAttribute(o,n,e):t.removeAttribute(o,n)}get urlTree(){return this.routerLinkInput===null?null:Ot(this.routerLinkInput)?this.routerLinkInput:this.router.createUrlTree(this.routerLinkInput,{relativeTo:this.relativeTo!==void 0?this.relativeTo:this.route,queryParams:this.queryParams,fragment:this.fragment,queryParamsHandling:this.queryParamsHandling,preserveFragment:this.preserveFragment})}static \u0275fac=function(e){return new(e||i)(R(pe),R(Ne),Cr("tabindex"),R(go),R(lo),R(qr))};static \u0275dir=Cn({type:i,selectors:[["","routerLink",""]],hostVars:2,hostBindings:function(e,t){e&1&&v("click",function(a){return t.onClick(a.button,a.ctrlKey,a.shiftKey,a.altKey,a.metaKey)}),e&2&&_e("href",t.reactiveHref(),wr)("target",t.target)},inputs:{target:"target",queryParams:"queryParams",fragment:"fragment",queryParamsHandling:"queryParamsHandling",state:"state",info:"info",relativeTo:"relativeTo",preserveFragment:[2,"preserveFragment","preserveFragment",ei],skipLocationChange:[2,"skipLocationChange","skipLocationChange",ei],replaceUrl:[2,"replaceUrl","replaceUrl",ei],routerLink:"routerLink"},features:[dt]})}return i})(),Ko=(()=>{class i{router;element;renderer;cdr;link;links;classes=[];routerEventsSubscription;linkInputChangesSubscription;_isActive=!1;get isActive(){return this._isActive}routerLinkActiveOptions={exact:!1};ariaCurrentWhenActive;isActiveChange=new xe;constructor(n,e,t,o,a){this.router=n,this.element=e,this.renderer=t,this.cdr=o,this.link=a,this.routerEventsSubscription=n.events.subscribe(d=>{d instanceof Ke&&this.update()})}ngAfterContentInit(){N(this.links.changes,N(null)).pipe(to()).subscribe(n=>{this.update(),this.subscribeToEachLinkOnChanges()})}subscribeToEachLinkOnChanges(){this.linkInputChangesSubscription?.unsubscribe();let n=[...this.links.toArray(),this.link].filter(e=>!!e).map(e=>e.onChanges);this.linkInputChangesSubscription=je(n).pipe(to()).subscribe(e=>{this._isActive!==this.isLinkActive(this.router)(e)&&this.update()})}set routerLinkActive(n){let e=Array.isArray(n)?n:n.split(" ");this.classes=e.filter(t=>!!t)}ngOnChanges(n){this.update()}ngOnDestroy(){this.routerEventsSubscription.unsubscribe(),this.linkInputChangesSubscription?.unsubscribe()}update(){!this.links||!this.router.navigated||queueMicrotask(()=>{let n=this.hasActiveLinks();this.classes.forEach(e=>{n?this.renderer.addClass(this.element.nativeElement,e):this.renderer.removeClass(this.element.nativeElement,e)}),n&&this.ariaCurrentWhenActive!==void 0?this.renderer.setAttribute(this.element.nativeElement,"aria-current",this.ariaCurrentWhenActive.toString()):this.renderer.removeAttribute(this.element.nativeElement,"aria-current"),this._isActive!==n&&(this._isActive=n,this.cdr.markForCheck(),this.isActiveChange.emit(n))})}isLinkActive(n){let e=Pc(this.routerLinkActiveOptions)?this.routerLinkActiveOptions:this.routerLinkActiveOptions.exact||!1;return t=>{let o=t.urlTree;return o?n.isActive(o,e):!1}}hasActiveLinks(){let n=this.isLinkActive(this.router);return this.link&&n(this.link)||this.links.some(n)}static \u0275fac=function(e){return new(e||i)(R(pe),R(lo),R(go),R(Xn),R(kt,8))};static \u0275dir=Cn({type:i,selectors:[["","routerLinkActive",""]],contentQueries:function(e,t,o){if(e&1&&Rr(o,kt,5),e&2){let a;mt(a=gt())&&(t.links=a)}},inputs:{routerLinkActiveOptions:"routerLinkActiveOptions",ariaCurrentWhenActive:"ariaCurrentWhenActive",routerLinkActive:"routerLinkActive"},outputs:{isActiveChange:"isActiveChange"},exportAs:["routerLinkActive"],features:[dt]})}return i})();function Pc(i){return!!i.paths}var Sc=new Ce("");function Zo(i,...r){return fr([{provide:$n,multi:!0,useValue:i},[],{provide:Ne,useFactory:Oc,deps:[pe]},{provide:Tr,multi:!0,useFactory:kc},r.map(n=>n.\u0275providers)])}function Oc(i){return i.routerState.root}function kc(){let i=j(ro);return r=>{let n=i.get(Ir);if(r!==n.components[0])return;let e=i.get(pe),t=i.get(Ec);i.get(Tc)===1&&e.initialNavigation(),i.get(Ic,null,{optional:!0})?.setUpPreloading(),i.get(Sc,null,{optional:!0})?.init(),e.resetRootComponentType(n.componentTypes[0]),t.closed||(t.next(),t.complete(),t.unsubscribe())}}var Ec=new Ce("",{factory:()=>new lt}),Tc=new Ce("",{providedIn:"root",factory:()=>1});var Ic=new Ce("");var Ui=(()=>{let r=class r{constructor(){this.collapsedSubject=new Pe(!1),this.collapsed$=this.collapsedSubject.asObservable()}toggle(){this.collapsedSubject.next(!this.collapsedSubject.value)}setCollapsed(e){this.collapsedSubject.next(e)}isCollapsed(){return this.collapsedSubject.value}};r.\u0275fac=function(t){return new(t||r)},r.\u0275prov=A({token:r,factory:r.\u0275fac,providedIn:"root"});let i=r;return i})();var jc=()=>({exact:!1});function Rc(i,r){if(i&1&&(s(0,"div",9),y(1,"lucide-icon",6),l()),i&2){let n=u();c(),g("img",n.Building2)("size",24)}}function Vc(i,r){i&1&&(s(0,"span",10),p(1,"ResourceFlow"),l())}function Dc(i,r){if(i&1&&(s(0,"span",14),p(1),l()),i&2){let n=u().$implicit;c(),O(n.label)}}function Ac(i,r){if(i&1&&(s(0,"a",11)(1,"div",12),y(2,"lucide-icon",6),l(),w(3,Dc,2,1,"span",13),l()),i&2){let n=r.$implicit,e=u();g("routerLink",n.route)("routerLinkActiveOptions",ft(6,jc))("title",e.isCollapsed?n.label:""),c(2),g("img",n.icon)("size",20),c(),g("ngIf",!e.isCollapsed)}}var ss=(()=>{let r=class r{constructor(e){this.sidebarService=e,this.isCollapsed=!1,this.LayoutDashboard=ea,this.Calendar=ai,this.FolderKanban=si,this.Users=Xe,this.Building2=wt,this.Settings=na,this.ChevronLeft=Jr,this.ChevronRight=Mt,this.Gauge=Xr,this.Layers=Kt,this.Flag=Zr,this.User=Ze,this.navigationItems=[{label:"Tableau de bord",icon:this.LayoutDashboard,route:"/dashboard"},{label:"Capacit\xE9",icon:this.Gauge,route:"/capacite"},{label:"Plan Global",icon:this.Calendar,route:"/plan-globale"},{label:"Projets",icon:this.FolderKanban,route:"/projets"},{label:"Jalons",icon:this.Flag,route:"/jalons"},{label:"Ressources",icon:this.Users,route:"/ressources"},{label:"Organisation",icon:this.Building2,route:"/organisation"},{label:"Param\xE8tres",icon:this.Settings,route:"/settings"},{label:"Profil",icon:this.User,route:"/profile"}]}toggleSidebar(){this.isCollapsed=!this.isCollapsed,this.sidebarService.setCollapsed(this.isCollapsed)}};r.\u0275fac=function(t){return new(t||r)(R(Ui))},r.\u0275cmp=B({type:r,selectors:[["app-sidebar-navigation"]],decls:9,vars:8,consts:[[1,"sidebar"],[1,"sidebar-header"],[1,"logo-container"],["class","logo-icon",4,"ngIf"],["class","logo-text",4,"ngIf"],[1,"toggle-btn",3,"click","title"],[3,"img","size"],[1,"nav-items"],["class","nav-item","routerLinkActive","active",3,"routerLink","routerLinkActiveOptions","title",4,"ngFor","ngForOf"],[1,"logo-icon"],[1,"logo-text"],["routerLinkActive","active",1,"nav-item",3,"routerLink","routerLinkActiveOptions","title"],[1,"nav-item-icon"],["class","nav-item-label",4,"ngIf"],[1,"nav-item-label"]],template:function(t,o){t&1&&(s(0,"nav",0)(1,"div",1)(2,"div",2),w(3,Rc,2,2,"div",3)(4,Vc,2,0,"span",4),l(),s(5,"button",5),v("click",function(){return o.toggleSidebar()}),y(6,"lucide-icon",6),l()(),s(7,"div",7),w(8,Ac,4,7,"a",8),l()()),t&2&&($("collapsed",o.isCollapsed),c(3),g("ngIf",!o.isCollapsed),c(),g("ngIf",!o.isCollapsed),c(),g("title",o.isCollapsed?"Expand sidebar":"Collapse sidebar"),c(),g("img",o.isCollapsed?o.ChevronRight:o.ChevronLeft)("size",20),c(2),g("ngForOf",o.navigationItems))},dependencies:[G,Oe,te,K,ne,kt,Ko],styles:[".sidebar[_ngcontent-%COMP%]{position:fixed;left:0;top:0;height:100vh;background:#fff;border-right:1px solid #e5e7eb;transition:width .3s cubic-bezier(.4,0,.2,1);width:256px;display:flex;flex-direction:column;z-index:1000}.sidebar.collapsed[_ngcontent-%COMP%]{width:80px}.sidebar-header[_ngcontent-%COMP%]{padding:20px 16px;border-bottom:1px solid #e5e7eb;display:flex;align-items:center;justify-content:space-between;min-height:72px}.logo-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;flex:1;min-width:0}.logo-icon[_ngcontent-%COMP%]{width:40px;height:40px;background:linear-gradient(135deg,#667eea,#764ba2);border-radius:8px;display:flex;align-items:center;justify-content:center;color:#fff;flex-shrink:0}.logo-text[_ngcontent-%COMP%]{font-size:18px;font-weight:600;color:#111827;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.toggle-btn[_ngcontent-%COMP%]{width:28px;height:28px;border:none;background:#f3f4f6;border-radius:6px;display:flex;align-items:center;justify-content:center;cursor:pointer;transition:all .2s ease;flex-shrink:0;color:#6b7280}.toggle-btn[_ngcontent-%COMP%]:hover{background:#e5e7eb;color:#374151}.sidebar.collapsed[_ngcontent-%COMP%]   .toggle-btn[_ngcontent-%COMP%]{margin-left:auto}.nav-items[_ngcontent-%COMP%]{padding:16px 12px;flex:1;overflow-y:auto}.nav-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;padding:12px;margin-bottom:4px;border-radius:8px;cursor:pointer;transition:all .2s ease;text-decoration:none;color:#4b5563;position:relative}.sidebar.collapsed[_ngcontent-%COMP%]   .nav-item[_ngcontent-%COMP%]{justify-content:center;padding:12px}.nav-item[_ngcontent-%COMP%]:hover{background:#f3f4f6;color:#111827}.nav-item.active[_ngcontent-%COMP%]{background:#4f46e5;color:#fff}.nav-item.active[_ngcontent-%COMP%]:hover{background:#4338ca}.nav-item-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;flex-shrink:0}.nav-item-label[_ngcontent-%COMP%]{font-size:14px;font-weight:500;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.sidebar.collapsed[_ngcontent-%COMP%]   .nav-item-label[_ngcontent-%COMP%]{display:none}.nav-items[_ngcontent-%COMP%]::-webkit-scrollbar{width:6px}.nav-items[_ngcontent-%COMP%]::-webkit-scrollbar-track{background:transparent}.nav-items[_ngcontent-%COMP%]::-webkit-scrollbar-thumb{background:#d1d5db;border-radius:3px}.nav-items[_ngcontent-%COMP%]::-webkit-scrollbar-thumb:hover{background:#9ca3af}"]});let i=r;return i})();var un=(()=>{let r=class r{constructor(e){this.supabase=e,this._societesCache=null,this._departementsCache=null,this._servicesCache=null,this._equipesCache=null,this._rolesCache=null,this._personnesCache=null}clearCache(){this._societesCache=null,this._departementsCache=null,this._servicesCache=null,this._equipesCache=null,this._rolesCache=null,this._personnesCache=null}getAllSocietes(){return _(this,null,function*(){if(this._societesCache)return this._societesCache;let{data:e,error:t}=yield this.supabase.client.from("societes").select("*").order("nom");if(t)throw t;return this._societesCache=e||[],this._societesCache})}createSociete(e){return _(this,null,function*(){let{data:t,error:o}=yield this.supabase.client.from("societes").insert([e]).select().single();if(o)throw o;return this.clearCache(),t})}getAllDepartements(){return _(this,null,function*(){if(this._departementsCache)return this._departementsCache;let{data:e,error:t}=yield this.supabase.client.from("departements").select("*").order("nom");if(t)throw t;return this._departementsCache=e||[],this._departementsCache})}createDepartement(e){return _(this,null,function*(){let{data:t,error:o}=yield this.supabase.client.from("departements").insert([e]).select().single();if(o)throw o;return this.clearCache(),t})}getAllServices(){return _(this,null,function*(){if(this._servicesCache)return this._servicesCache;let{data:e,error:t}=yield this.supabase.client.from("services").select("*").order("nom");if(t)throw t;return this._servicesCache=e||[],this._servicesCache})}createService(e){return _(this,null,function*(){let{data:t,error:o}=yield this.supabase.client.from("services").insert([e]).select().single();if(o)throw o;return this.clearCache(),t})}getAllEquipes(){return _(this,null,function*(){if(this._equipesCache)return this._equipesCache;let{data:e,error:t}=yield this.supabase.client.from("equipes").select("*").order("nom");if(t)throw t;return this._equipesCache=e||[],this._equipesCache})}createEquipe(e){return _(this,null,function*(){let{data:t,error:o}=yield this.supabase.client.from("equipes").insert([e]).select().single();if(o)throw o;return this.clearCache(),t})}getAllRoles(){return _(this,null,function*(){if(this._rolesCache)return this._rolesCache;let{data:e,error:t}=yield this.supabase.client.from("roles").select("*").order("nom");if(t)throw t;return this._rolesCache=e||[],this._rolesCache})}createRole(e){return _(this,null,function*(){let{data:t,error:o}=yield this.supabase.client.from("roles").insert([e]).select().single();if(o)throw o;return this.clearCache(),t})}updateRole(e,t){return _(this,null,function*(){let{data:o,error:a}=yield this.supabase.client.from("roles").update(t).eq("id",e).select().single();if(a)throw a;return this.clearCache(),o})}deleteRole(e){return _(this,null,function*(){let{error:t}=yield this.supabase.client.from("roles").delete().eq("id",e);if(t)throw t;this.clearCache()})}getAllPersonnes(){return _(this,null,function*(){if(this._personnesCache)return this._personnesCache;let{data:e,error:t}=yield this.supabase.client.from("personnes").select("*").order("nom");if(t)throw t;return this._personnesCache=e||[],this._personnesCache})}createPersonne(e){return _(this,null,function*(){let{data:t,error:o}=yield this.supabase.client.from("personnes").insert([e]).select().single();if(o)throw o;return this.clearCache(),t})}deletePersonne(e){return _(this,null,function*(){let{error:t}=yield this.supabase.client.from("personnes").delete().eq("id",e);if(t)throw t;this.clearCache()})}updatePersonne(e,t){return _(this,null,function*(){let{data:o,error:a}=yield this.supabase.client.from("personnes").update(t).eq("id",e).select().single();if(a)throw a;return this.clearCache(),o})}addRoleToPersonne(e,t){return _(this,null,function*(){let{error:o}=yield this.supabase.client.from("personne_roles").insert([{personne_id:e,role_id:t}]);if(o)throw o;this.clearCache()})}updateSociete(e,t){return _(this,null,function*(){let{data:o,error:a}=yield this.supabase.client.from("societes").update(t).eq("id",e).select().single();if(a)throw a;return this.clearCache(),o})}deleteSociete(e){return _(this,null,function*(){let{error:t}=yield this.supabase.client.from("societes").delete().eq("id",e);if(t)throw t;this.clearCache()})}updateDepartement(e,t){return _(this,null,function*(){let{data:o,error:a}=yield this.supabase.client.from("departements").update(t).eq("id",e).select().single();if(a)throw a;return this.clearCache(),o})}deleteDepartement(e){return _(this,null,function*(){let{error:t}=yield this.supabase.client.from("departements").delete().eq("id",e);if(t)throw t;this.clearCache()})}updateService(e,t){return _(this,null,function*(){let{data:o,error:a}=yield this.supabase.client.from("services").update(t).eq("id",e).select().single();if(a)throw a;return this.clearCache(),o})}deleteService(e){return _(this,null,function*(){let{error:t}=yield this.supabase.client.from("services").delete().eq("id",e);if(t)throw t;this.clearCache()})}updateEquipe(e,t){return _(this,null,function*(){let{data:o,error:a}=yield this.supabase.client.from("equipes").update(t).eq("id",e).select().single();if(a)throw a;return this.clearCache(),o})}deleteEquipe(e){return _(this,null,function*(){let{error:t}=yield this.supabase.client.from("equipes").delete().eq("id",e);if(t)throw t;this.clearCache()})}};r.\u0275fac=function(t){return new(t||r)(V(H))},r.\u0275prov=A({token:r,factory:r.\u0275fac,providedIn:"root"});let i=r;return i})();var ls=i=>({$implicit:i}),mn=(i,r)=>r.id;function Nc(i,r){i&1&&ho(0)}function Lc(i,r){if(i&1&&w(0,Nc,1,0,"ng-container",29),i&2){let n=r.$implicit;u();let e=Ht(62);g("ngTemplateOutlet",e)("ngTemplateOutletContext",_o(2,ls,n))}}function zc(i,r){if(i&1){let n=S();s(0,"div",45),v("click",function(){let t=f(n).$implicit,o=u(2);return h(o.selectColor(t))}),l()}if(i&2){let n=r.$implicit,e=u(2);z("background-color",n),$("active",e.formData.color===n&&!e.isCustomColor)}}function Fc(i,r){i&1&&y(0,"lucide-icon",39),i&2&&g("size",16)}function qc(i,r){if(i&1&&y(0,"div",46),i&2){let n=u(2);z("background-color",n.formData.color)}}function Uc(i,r){if(i&1){let n=S();s(0,"div",41)(1,"input",47),T("ngModelChange",function(t){f(n);let o=u(2);return E(o.formData.color,t)||(o.formData.color=t),h(t)}),l(),s(2,"input",48),T("ngModelChange",function(t){f(n);let o=u(2);return E(o.formData.color,t)||(o.formData.color=t),h(t)}),l()()}if(i&2){let n=u(2);c(),k("ngModel",n.formData.color),c(),k("ngModel",n.formData.color)}}function Wc(i,r){if(i&1&&(s(0,"option",50),p(1),l()),i&2){let n=r.$implicit;g("value",n.id),c(),O(n.nom)}}function $c(i,r){if(i&1){let n=S();s(0,"div",33)(1,"label"),p(2,"Soci\xE9t\xE9 de rattachement"),l(),s(3,"select",49),T("ngModelChange",function(t){f(n);let o=u(2);return E(o.formData.societe_id,t)||(o.formData.societe_id=t),h(t)}),ue(4,Wc,2,2,"option",50,mn),l()()}if(i&2){let n=u(2);c(3),k("ngModel",n.formData.societe_id),c(),me(n.societes)}}function Bc(i,r){if(i&1&&(s(0,"option",50),p(1),l()),i&2){let n=r.$implicit;g("value",n.id),c(),O(n.nom)}}function Hc(i,r){if(i&1){let n=S();s(0,"div",33)(1,"label"),p(2,"D\xE9partement de rattachement"),l(),s(3,"select",49),T("ngModelChange",function(t){f(n);let o=u(2);return E(o.formData.departement_id,t)||(o.formData.departement_id=t),h(t)}),ue(4,Bc,2,2,"option",50,mn),l()()}if(i&2){let n=u(2);c(3),k("ngModel",n.formData.departement_id),c(),me(n.departements)}}function Gc(i,r){if(i&1){let n=S();s(0,"div",33)(1,"label"),p(2,"Rattachement (Service ou D\xE9partement)"),l(),s(3,"select",51),T("ngModelChange",function(t){f(n);let o=u(2);return E(o.formData.parentType,t)||(o.formData.parentType=t),h(t)}),v("change",function(){f(n);let t=u(2);return h(t.formData.parentId="")}),s(4,"option",52),p(5,"Service"),l(),s(6,"option",53),p(7,"D\xE9partement"),l()()()}if(i&2){let n=u(2);c(3),k("ngModel",n.formData.parentType)}}function Jc(i,r){if(i&1&&(s(0,"option",50),p(1),l()),i&2){let n=r.$implicit;g("value",n.id),c(),O(n.nom)}}function Yc(i,r){if(i&1){let n=S();s(0,"div",33)(1,"label"),p(2,"Service"),l(),s(3,"select",49),T("ngModelChange",function(t){f(n);let o=u(2);return E(o.formData.parentId,t)||(o.formData.parentId=t),h(t)}),ue(4,Jc,2,2,"option",50,mn),l()()}if(i&2){let n=u(2);c(3),k("ngModel",n.formData.parentId),c(),me(n.services)}}function Qc(i,r){if(i&1&&(s(0,"option",50),p(1),l()),i&2){let n=r.$implicit;g("value",n.id),c(),O(n.nom)}}function Kc(i,r){if(i&1){let n=S();s(0,"div",33)(1,"label"),p(2,"D\xE9partement"),l(),s(3,"select",49),T("ngModelChange",function(t){f(n);let o=u(2);return E(o.formData.parentId,t)||(o.formData.parentId=t),h(t)}),ue(4,Qc,2,2,"option",50,mn),l()()}if(i&2){let n=u(2);c(3),k("ngModel",n.formData.parentId),c(),me(n.departements)}}function Zc(i,r){if(i&1){let n=S();s(0,"div",30),v("click",function(){f(n);let t=u();return h(t.closeModals())}),s(1,"div",31),v("click",function(t){return f(n),h(t.stopPropagation())}),s(2,"h2",32),p(3),l(),s(4,"div",33)(5,"label"),p(6,"Nom"),l(),s(7,"input",34),T("ngModelChange",function(t){f(n);let o=u();return E(o.formData.nom,t)||(o.formData.nom=t),h(t)}),l()(),s(8,"div",33)(9,"label"),p(10,"Code"),l(),s(11,"input",35),T("ngModelChange",function(t){f(n);let o=u();return E(o.formData.code,t)||(o.formData.code=t),h(t)}),l()(),s(12,"div",33)(13,"label"),p(14,"Couleur"),l(),s(15,"div",36),ue(16,zc,1,4,"div",37,Bt),s(18,"div",38),v("click",function(){f(n);let t=u();return h(t.isCustomColor=!t.isCustomColor)}),F(19,Fc,1,1,"lucide-icon",39)(20,qc,1,2,"div",40),l()(),F(21,Uc,3,2,"div",41),l(),F(22,$c,6,1,"div",33),F(23,Hc,6,1,"div",33),F(24,Gc,8,1,"div",33),F(25,Yc,6,1,"div",33),F(26,Kc,6,1,"div",33),s(27,"div",42)(28,"button",43),v("click",function(){f(n);let t=u();return h(t.closeModals())}),p(29,"Annuler"),l(),s(30,"button",44),v("click",function(){f(n);let t=u();return h(t.showEditModal?t.handleUpdate():t.handleCreate())}),p(31,"Enregistrer"),l()()()()}if(i&2){let n=u();c(3),Se(" ",n.showEditModal?"Modifier":"Cr\xE9er"," ",n.getModalTitleType()," "),c(4),k("ngModel",n.formData.nom),c(4),k("ngModel",n.formData.code),c(5),me(n.predefinedColors),c(2),$("active",n.isCustomColor),c(),q(n.isCustomColor?20:19),c(2),q(n.isCustomColor?21:-1),c(),q(n.createModalType==="departement"||(n.editingNode==null?null:n.editingNode.type)==="departement"?22:-1),c(),q(n.createModalType==="service"||(n.editingNode==null?null:n.editingNode.type)==="service"?23:-1),c(),q(n.createModalType==="equipe"||(n.editingNode==null?null:n.editingNode.type)==="equipe"?24:-1),c(),q((n.createModalType==="equipe"||(n.editingNode==null?null:n.editingNode.type)==="equipe")&&n.formData.parentType==="service"?25:-1),c(),q((n.createModalType==="equipe"||(n.editingNode==null?null:n.editingNode.type)==="equipe")&&n.formData.parentType==="departement"?26:-1)}}function Xc(i,r){if(i&1&&(s(0,"div",55),y(1,"lucide-icon",65),l()),i&2){let n=u().$implicit;c(),g("name",n.expanded?"chevron-down":"chevron-right")("size",20)}}function ed(i,r){i&1&&y(0,"div",56)}function td(i,r){i&1&&y(0,"lucide-icon",11),i&2&&g("size",18)}function nd(i,r){i&1&&y(0,"lucide-icon",12),i&2&&g("size",18)}function id(i,r){i&1&&y(0,"lucide-icon",13),i&2&&g("size",18)}function od(i,r){i&1&&y(0,"lucide-icon",14),i&2&&g("size",18)}function rd(i,r){if(i&1&&(s(0,"span",60),p(1),l()),i&2){let n=u().$implicit;c(),P("(",n.code,")")}}function ad(i,r){if(i&1){let n=S();s(0,"div",64)(1,"button",66),v("click",function(){f(n);let t=u().$implicit,o=u();return h(o.openEditModal(t))}),p(2,"Modifier"),l(),s(3,"button",67),v("click",function(){f(n);let t=u().$implicit,o=u();return h(o.handleDelete(t))}),p(4,"Supprimer"),l()()}}function sd(i,r){i&1&&ho(0)}function ld(i,r){if(i&1&&w(0,sd,1,0,"ng-container",29),i&2){let n=r.$implicit;u(3);let e=Ht(62);g("ngTemplateOutlet",e)("ngTemplateOutletContext",_o(2,ls,n))}}function cd(i,r){if(i&1&&ue(0,ld,1,4,"ng-container",null,mn),i&2){let n=u().$implicit;me(n.children)}}function dd(i,r){if(i&1){let n=S();s(0,"div",54),v("click",function(){let t=f(n).$implicit,o=u();return h(o.toggleNode(t))}),F(1,Xc,2,2,"div",55)(2,ed,1,0,"div",56),s(3,"div",57),F(4,td,1,1,"lucide-icon",11),F(5,nd,1,1,"lucide-icon",12),F(6,id,1,1,"lucide-icon",13),F(7,od,1,1,"lucide-icon",14),l(),s(8,"div",58)(9,"span",59),p(10),l(),F(11,rd,2,1,"span",60),l(),s(12,"div",61),v("click",function(t){return f(n),h(t.stopPropagation())}),s(13,"button",62),v("click",function(t){let o=f(n).$implicit,a=u();return h(a.toggleMenu(o,t))}),y(14,"lucide-icon",63),l(),F(15,ad,5,0,"div",64),l()(),F(16,cd,2,0)}if(i&2){let n=r.$implicit,e=u();z("margin-left",n.level*32,"px"),$("menu-active",e.activeMenuId===n.id),c(),q(n.children.length>0?1:2),c(2),z("background-color",n.color||"#e5e7eb")("color","#fff"),g("ngClass",n.type),c(),q(n.type==="societe"?4:-1),c(),q(n.type==="departement"?5:-1),c(),q(n.type==="service"?6:-1),c(),q(n.type==="equipe"?7:-1),c(3),O(n.nom),c(),q(n.code?11:-1),c(3),g("size",16),c(),q(e.activeMenuId===n.id?15:-1),c(),q(n.expanded?16:-1)}}var pd=(()=>{let r=class r{};r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=Je({type:r}),r.\u0275inj=He({imports:[K.pick({Building2:wt,Layers:Kt,Box:oi,Users:Xe,ChevronRight:Mt,ChevronDown:yt,MoreVertical:Jt,Plus:Ye}),K]});let i=r;return i})(),cs=(()=>{let r=class r{selectColor(e){this.formData.color=e,this.isCustomColor=!1}constructor(e){this.resourceService=e,this.societes=[],this.departements=[],this.services=[],this.equipes=[],this.orgTree=[],this.showCreateModal=!1,this.showEditModal=!1,this.createModalType=null,this.editingNode=null,this.activeMenuId=null,this.formData={nom:"",code:"",color:"#3b82f6",societe_id:"",departement_id:"",service_id:"",parentType:"service",parentId:""},this.predefinedColors=["#ef4444","#f97316","#f59e0b","#eab308","#84cc16","#22c55e","#10b981","#14b8a6","#06b6d4","#0ea5e9","#3b82f6","#6366f1","#8b5cf6","#a855f7","#d946ef","#ec4899","#f43f5e"],this.isCustomColor=!1,window.addEventListener("click",()=>{this.activeMenuId=null})}ngOnInit(){return _(this,null,function*(){yield this.loadData()})}loadData(){return _(this,null,function*(){try{this.societes=yield this.resourceService.getAllSocietes(),this.departements=yield this.resourceService.getAllDepartements(),this.services=yield this.resourceService.getAllServices(),this.equipes=yield this.resourceService.getAllEquipes(),this.buildOrgTree()}catch(e){console.error("Error loading data:",e)}})}buildOrgTree(){this.orgTree=this.societes.map(e=>{let o=this.departements.filter(a=>a.societe_id===e.id).map(a=>{let m=this.services.filter(x=>x.departement_id===a.id).map(x=>{let M=this.equipes.filter(D=>D.service_id===x.id);return{type:"service",id:x.id,nom:x.nom,code:x.code,color:x.color,originalData:x,children:M.map(D=>({type:"equipe",id:D.id,nom:D.nom,code:D.code,color:D.color,originalData:D,children:[],expanded:!1,level:3,parentId:x.id})),expanded:!1,level:2,parentId:a.id}}),b=this.equipes.filter(x=>x.departement_id===a.id).map(x=>({type:"equipe",id:x.id,nom:x.nom,code:x.code,color:x.color,originalData:x,children:[],expanded:!1,level:2,parentId:a.id}));return{type:"departement",id:a.id,nom:a.nom,code:a.code,color:a.color,originalData:a,children:[...m,...b],expanded:!1,level:1,parentId:e.id}});return{type:"societe",id:e.id,nom:e.nom,code:e.code,color:e.color||"#3b82f6",originalData:e,children:o,expanded:!1,level:0}})}toggleNode(e){e.expanded=!e.expanded}toggleMenu(e,t){t.stopPropagation(),this.activeMenuId===e.id?this.activeMenuId=null:this.activeMenuId=e.id}openCreateModal(e){this.createModalType=e,this.showCreateModal=!0,this.showEditModal=!1,this.formData={nom:"",code:"",color:"#3b82f6",societe_id:"",departement_id:"",service_id:"",parentType:"service",parentId:""},e==="departement"&&this.societes.length>0&&(this.formData.societe_id=this.societes[0].id??""),e==="service"&&this.departements.length>0&&(this.formData.departement_id=this.departements[0].id??""),e==="equipe"&&(this.services.length>0?(this.formData.parentType="service",this.formData.parentId=this.services[0].id??""):this.departements.length>0&&(this.formData.parentType="departement",this.formData.parentId=this.departements[0].id??""))}openEditModal(e){this.editingNode=e,this.createModalType=null,this.showEditModal=!0,this.showCreateModal=!1,this.activeMenuId=null,this.formData=I({},e.originalData),this.isCustomColor=!this.predefinedColors.includes(this.formData.color),e.type==="equipe"&&(console.log(e),e.originalData.service_id?(this.formData.parentType="service",this.formData.parentId=e.originalData.service_id??""):e.originalData.departement_id&&(this.formData.parentType="departement",this.formData.parentId=e.originalData.departement_id??""))}closeModals(){this.showCreateModal=!1,this.showEditModal=!1,this.createModalType=null,this.editingNode=null}getModalTitleType(){switch(this.showEditModal?this.editingNode?.type:this.createModalType){case"societe":return"une Soci\xE9t\xE9";case"departement":return"un D\xE9partement";case"service":return"un Service";case"equipe":return"une \xC9quipe";default:return""}}handleCreate(){return _(this,null,function*(){try{if(this.createModalType==="societe"){let e={nom:this.formData.nom,code:this.formData.code,color:this.formData.color};yield this.resourceService.createSociete(e)}else if(this.createModalType==="departement"){let e={nom:this.formData.nom,code:this.formData.code,color:this.formData.color,societe_id:this.formData.societe_id};yield this.resourceService.createDepartement(e)}else if(this.createModalType==="service"){let e={nom:this.formData.nom,code:this.formData.code,color:this.formData.color,departement_id:this.formData.departement_id};yield this.resourceService.createService(e)}else if(this.createModalType==="equipe"){let e={nom:this.formData.nom,code:this.formData.code,color:this.formData.color};this.formData.parentType==="service"?e.service_id=this.formData.parentId:this.formData.parentType==="departement"&&(e.departement_id=this.formData.parentId),yield this.resourceService.createEquipe(e)}this.closeModals(),yield this.loadData()}catch(e){console.error("Error creating:",e)}})}handleUpdate(){return _(this,null,function*(){if(this.editingNode)try{let e=this.editingNode.id;if(this.editingNode.type==="societe"){let t={nom:this.formData.nom,code:this.formData.code,color:this.formData.color};yield this.resourceService.updateSociete(e,t)}else if(this.editingNode.type==="departement"){let t={nom:this.formData.nom,code:this.formData.code,color:this.formData.color,societe_id:this.formData.societe_id};yield this.resourceService.updateDepartement(e,t)}else if(this.editingNode.type==="service"){let t={nom:this.formData.nom,code:this.formData.code,color:this.formData.color,departement_id:this.formData.departement_id};yield this.resourceService.updateService(e,t)}else if(this.editingNode.type==="equipe"){let t={nom:this.formData.nom,code:this.formData.code,color:this.formData.color};this.formData.parentType==="service"?t.service_id=this.formData.parentId:this.formData.parentType==="departement"&&(t.departement_id=this.formData.parentId),yield this.resourceService.updateEquipe(e,t)}this.closeModals(),yield this.loadData()}catch(e){console.error("Error updating:",e)}})}handleDelete(e){return _(this,null,function*(){if(confirm(`\xCAtes-vous s\xFBr de vouloir supprimer ${e.nom} ?`))try{e.type==="societe"?yield this.resourceService.deleteSociete(e.id):e.type==="departement"?yield this.resourceService.deleteDepartement(e.id):e.type==="service"?yield this.resourceService.deleteService(e.id):e.type==="equipe"&&(yield this.resourceService.deleteEquipe(e.id)),this.activeMenuId=null,yield this.loadData()}catch(t){console.error("Error deleting:",t)}})}};r.\u0275fac=function(t){return new(t||r)(R(un))},r.\u0275cmp=B({type:r,selectors:[["app-organization-view"]],decls:63,vars:13,consts:[["nodeTemplate",""],[1,"organization-view"],[1,"header"],[1,"header-left"],[1,"logo"],["width","24","height","24","viewBox","0 0 24 24","fill","none"],["d","M12 2L2 7L12 12L22 7L12 2Z","fill","#3b82f6"],["d","M2 17L12 22L22 17V12L12 17L2 12V17Z","fill","#3b82f6","opacity","0.6"],[1,"logo-text"],[1,"header-right"],[1,"header-btn",3,"click"],["name","building-2",3,"size"],["name","layers",3,"size"],["name","box",3,"size"],["name","users",3,"size"],[1,"main-content"],[1,"page-title"],[1,"page-subtitle"],[1,"stats-grid"],[1,"stat-card"],[1,"stat-icon","societe"],[1,"stat-value"],[1,"stat-label"],[1,"stat-icon","departement"],[1,"stat-icon","service"],[1,"stat-icon","equipe"],[1,"org-structure"],[1,"tree-container"],[1,"modal-overlay"],[4,"ngTemplateOutlet","ngTemplateOutletContext"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"modal-title"],[1,"form-group"],["type","text","placeholder","Nom",3,"ngModelChange","ngModel"],["type","text","placeholder","Code (e.g. CAT)",3,"ngModelChange","ngModel"],[1,"color-palette"],[1,"color-swatch",3,"background-color","active"],["title","Couleur personnalis\xE9e",1,"color-swatch","custom-trigger",3,"click"],["name","plus",3,"size"],[1,"custom-preview",3,"background-color"],[1,"custom-color-input-wrapper"],[1,"modal-actions"],[1,"btn-cancel",3,"click"],[1,"btn-confirm",3,"click"],[1,"color-swatch",3,"click"],[1,"custom-preview"],["type","color",1,"color-input",3,"ngModelChange","ngModel"],["type","text","placeholder","#000000",1,"color-hex-input",3,"ngModelChange","ngModel"],[3,"ngModelChange","ngModel"],[3,"value"],[3,"ngModelChange","change","ngModel"],["value","service","selected",""],["value","departement"],[1,"tree-node",3,"click"],[1,"toggle-icon"],[1,"toggle-placeholder"],[1,"node-icon",3,"ngClass"],[1,"node-info"],[1,"node-name"],[1,"node-code"],[1,"kebab-menu-container",3,"click"],[1,"kebab-btn",3,"click"],["name","more-vertical",3,"size"],[1,"menu-dropdown"],[3,"name","size"],[3,"click"],[1,"delete-btn",3,"click"]],template:function(t,o){if(t&1){let a=S();s(0,"div",1)(1,"header",2)(2,"div",3)(3,"div",4),xt(),s(4,"svg",5),y(5,"path",6)(6,"path",7),l(),Dt(),s(7,"span",8),p(8,"ResourceFlow"),l()()(),s(9,"div",9)(10,"button",10),v("click",function(){return f(a),h(o.openCreateModal("societe"))}),y(11,"lucide-icon",11),p(12," Soci\xE9t\xE9 "),l(),s(13,"button",10),v("click",function(){return f(a),h(o.openCreateModal("departement"))}),y(14,"lucide-icon",12),p(15," D\xE9partement "),l(),s(16,"button",10),v("click",function(){return f(a),h(o.openCreateModal("service"))}),y(17,"lucide-icon",13),p(18," Service "),l(),s(19,"button",10),v("click",function(){return f(a),h(o.openCreateModal("equipe"))}),y(20,"lucide-icon",14),p(21," \xC9quipe "),l()()(),s(22,"main",15)(23,"h1",16),p(24,"Organisation"),l(),s(25,"p",17),p(26,"Structurez votre organisation"),l(),s(27,"div",18)(28,"div",19)(29,"div",20),y(30,"lucide-icon",11),l(),s(31,"div",21),p(32),l(),s(33,"div",22),p(34,"Soci\xE9t\xE9s"),l()(),s(35,"div",19)(36,"div",23),y(37,"lucide-icon",12),l(),s(38,"div",21),p(39),l(),s(40,"div",22),p(41,"D\xE9partements"),l()(),s(42,"div",19)(43,"div",24),y(44,"lucide-icon",13),l(),s(45,"div",21),p(46),l(),s(47,"div",22),p(48,"Services"),l()(),s(49,"div",19)(50,"div",25),y(51,"lucide-icon",14),l(),s(52,"div",21),p(53),l(),s(54,"div",22),p(55,"\xC9quipes"),l()()(),s(56,"section",26)(57,"div",27),ue(58,Lc,1,4,"ng-container",null,mn),l()()(),F(60,Zc,32,13,"div",28),w(61,dd,17,19,"ng-template",null,0,xn),l()}t&2&&(c(11),g("size",20),c(3),g("size",20),c(3),g("size",20),c(3),g("size",20),c(10),g("size",24),c(2),O(o.societes.length),c(5),g("size",24),c(2),O(o.departements.length),c(5),g("size",24),c(2),O(o.services.length),c(5),g("size",24),c(2),O(o.equipes.length),c(5),me(o.orgTree),c(2),q(o.showCreateModal||o.showEditModal?60:-1))},dependencies:[G,ni,Ur,X,qe,Ue,ie,Fe,oe,re,pd,ne],styles:[".organization-view[_ngcontent-%COMP%]{min-height:100vh;background:#f3f4f6;font-family:Inter,sans-serif}.header[_ngcontent-%COMP%]{background:#fff;padding:16px 32px;display:flex;justify-content:space-between;align-items:center;border-bottom:1px solid #e5e7eb;position:sticky;top:0;z-index:10}.header-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:24px}.logo[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.logo-text[_ngcontent-%COMP%]{font-size:20px;font-weight:700;color:#111827}.header-right[_ngcontent-%COMP%]{display:flex;gap:12px}.header-btn[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 16px;background:#fff;border:1px solid #e5e7eb;border-radius:8px;cursor:pointer;font-size:14px;font-weight:500;color:#374151;transition:all .2s}.header-btn[_ngcontent-%COMP%]:hover{background:#f9fafb;border-color:#d1d5db;color:#111827}.main-content[_ngcontent-%COMP%]{padding:32px}.page-title[_ngcontent-%COMP%]{font-size:28px;font-weight:700;color:#111827;margin:0 0 4px}.page-subtitle[_ngcontent-%COMP%]{font-size:14px;color:#6b7280;margin:0 0 32px}.stats-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(4,1fr);gap:24px;margin-bottom:40px}.stat-card[_ngcontent-%COMP%]{background:#fff;padding:24px;border-radius:16px;box-shadow:0 4px 6px -1px #0000000d,0 2px 4px -1px #00000008;display:flex;flex-direction:column;align-items:center;transition:all .2s;border:1px solid #f3f4f6}.stat-card[_ngcontent-%COMP%]:hover{transform:translateY(-4px);box-shadow:0 10px 15px -3px #0000001a}.stat-icon[_ngcontent-%COMP%]{margin-bottom:12px;padding:12px;border-radius:12px;display:flex;align-items:center;justify-content:center}.stat-icon.societe[_ngcontent-%COMP%]{color:#3b82f6;background:#eff6ff}.stat-icon.departement[_ngcontent-%COMP%]{color:#8b5cf6;background:#f5f3ff}.stat-icon.service[_ngcontent-%COMP%]{color:#10b981;background:#ecfdf5}.stat-icon.equipe[_ngcontent-%COMP%]{color:#f97316;background:#fff7ed}.stat-value[_ngcontent-%COMP%]{font-size:24px;font-weight:700;color:#111827;line-height:1;margin-bottom:4px}.stat-label[_ngcontent-%COMP%]{font-size:14px;color:#6b7280;font-weight:500}.org-structure[_ngcontent-%COMP%]{background:transparent}.tree-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.tree-node[_ngcontent-%COMP%]{display:flex;align-items:center;padding:16px 20px;background:#fff;border-radius:16px;border:1px solid #e5e7eb;transition:all .2s;position:relative;cursor:pointer}.tree-node.menu-active[_ngcontent-%COMP%]{z-index:100}.tree-node[_ngcontent-%COMP%]:hover{border-color:#3b82f6;box-shadow:0 4px 12px #0000000d;transform:translateY(-1px)}.toggle-icon[_ngcontent-%COMP%]{cursor:pointer;color:#9ca3af;display:flex;align-items:center;justify-content:center;width:24px;height:24px;margin-right:12px;border-radius:4px}.toggle-icon[_ngcontent-%COMP%]:hover{background:#e5e7eb;color:#4b5563}.toggle-placeholder[_ngcontent-%COMP%]{width:32px}.node-icon[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:12px;display:flex;align-items:center;justify-content:center;margin-right:16px;background:#f3f4f6;color:#6b7280;flex-shrink:0}.node-info[_ngcontent-%COMP%]{flex:1;display:flex;align-items:baseline;gap:8px}.node-name[_ngcontent-%COMP%]{font-weight:700;color:#111827;font-size:16px}.node-code[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;font-weight:500}.kebab-menu-container[_ngcontent-%COMP%]{position:relative}.kebab-btn[_ngcontent-%COMP%]{background:transparent;border:none;cursor:pointer;padding:4px;border-radius:4px;color:#9ca3af;display:flex;opacity:0;transition:opacity .2s}.tree-node[_ngcontent-%COMP%]:hover   .kebab-btn[_ngcontent-%COMP%]{opacity:1}.kebab-btn[_ngcontent-%COMP%]:hover{background:#e5e7eb;color:#4b5563}.menu-dropdown[_ngcontent-%COMP%]{position:absolute;right:0;top:100%;background:#fff;border:1px solid #e5e7eb;border-radius:8px;box-shadow:0 4px 12px #0000001a;py:4px;min-width:120px;z-index:20;display:flex;flex-direction:column}.menu-dropdown[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;padding:8px 12px;text-align:left;cursor:pointer;font-size:13px;color:#374151;width:100%}.menu-dropdown[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#f3f4f6}.menu-dropdown[_ngcontent-%COMP%]   button.delete-btn[_ngcontent-%COMP%]{color:#ef4444}.menu-dropdown[_ngcontent-%COMP%]   button.delete-btn[_ngcontent-%COMP%]:hover{background:#fee2e2}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:50;-webkit-backdrop-filter:blur(2px);backdrop-filter:blur(2px)}.modal-content[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:24px;width:100%;max-width:480px;box-shadow:0 20px 25px -5px #0000001a}.modal-title[_ngcontent-%COMP%]{font-size:20px;font-weight:700;color:#111827;margin-bottom:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:16px;display:flex;flex-direction:column;gap:8px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;font-weight:500;color:#374151}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:10px 12px;border:1px solid #d1d5db;border-radius:8px;font-size:14px;color:#111827;transition:border-color .2s}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:#3b82f6;outline:none;ring:2px solid #fee2e2}.color-input[_ngcontent-%COMP%]{width:60px;height:36px;padding:2px;cursor:pointer;border-radius:6px;border:1px solid #d1d5db}.color-hex-input[_ngcontent-%COMP%]{flex:1;text-transform:uppercase}.color-palette[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:8px;margin-top:4px}.color-swatch[_ngcontent-%COMP%]{width:28px;height:28px;border-radius:8px;cursor:pointer;transition:all .2s;border:2px solid transparent}.color-swatch[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.color-swatch.active[_ngcontent-%COMP%]{border-color:#111827;box-shadow:0 0 0 2px #fff,0 0 0 4px #111827}.custom-trigger[_ngcontent-%COMP%]{background:#f3f4f6;border:1px dashed #d1d5db;display:flex;align-items:center;justify-content:center;color:#6b7280}.custom-trigger.active[_ngcontent-%COMP%]{border:2px solid #111827;background:#fff}.custom-preview[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:6px}.custom-color-input-wrapper[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center;margin-top:12px;padding:12px;background:#f9fafb;border-radius:12px;border:1px solid #e5e7eb}.modal-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px;margin-top:32px}.btn-cancel[_ngcontent-%COMP%]{padding:10px 20px;background:#fff;border:1px solid #d1d5db;border-radius:8px;font-weight:500;color:#374151;cursor:pointer}.btn-confirm[_ngcontent-%COMP%]{padding:10px 20px;background:#3b82f6;border:none;border-radius:8px;font-weight:500;color:#fff;cursor:pointer}.btn-confirm[_ngcontent-%COMP%]:hover{background:#2563eb}.btn-confirm[_ngcontent-%COMP%]:active{transform:translateY(1px)}"]});let i=r;return i})();var gn=(()=>{let r=class r{constructor(e){this.supabase=e,this._rolesCache=null,this._attachmentsCache=null}clearCache(){this._rolesCache=null,this._attachmentsCache=null}getAllRoles(){return _(this,null,function*(){if(this._rolesCache)return this._rolesCache;let{data:e,error:t}=yield this.supabase.client.from("roles").select("*").order("nom",{ascending:!0});if(t)throw t;return this._rolesCache=e||[],this._rolesCache})}getAllRoleAttachments(){return _(this,null,function*(){if(this._attachmentsCache)return this._attachmentsCache;let{data:e,error:t}=yield this.supabase.client.from("role_attachments").select("*");if(t)throw t;return this._attachmentsCache=e||[],this._attachmentsCache})}getRole(e){return _(this,null,function*(){return(yield this.getAllRoles()).find(o=>o.id===e)||null})}getIdServiceListFromRoleId(e){return _(this,null,function*(){return(yield this.getAllRoleAttachments()).filter(o=>o.role_id===e&&o.id_service!==void 0&&o.id_service!==null).map(o=>o.id_service)})}getServiceIdUUIDListFromRoleId(e){return _(this,null,function*(){return(yield this.getAllRoleAttachments()).filter(o=>o.role_id===e&&o.service_id!==void 0&&o.service_id!==null).map(o=>o.service_id)})}getAttachmentsByRoleId(e){return _(this,null,function*(){return(yield this.getAllRoleAttachments()).filter(o=>o.role_id===e)})}createRole(e){return _(this,null,function*(){let{data:t,error:o}=yield this.supabase.client.from("roles").insert([e]).select().single();if(o)throw o;return this.clearCache(),t})}updateRole(e,t){return _(this,null,function*(){let{data:o,error:a}=yield this.supabase.client.from("roles").update(t).eq("id",e).select().single();if(a)throw a;return this.clearCache(),o})}deleteRole(e){return _(this,null,function*(){let{error:t}=yield this.supabase.client.from("roles").delete().eq("id",e);if(t)throw t;this.clearCache()})}createRoleAttachment(e){return _(this,null,function*(){let{data:t,error:o}=yield this.supabase.client.from("role_attachments").insert([e]).select().single();if(o)throw o;return this.clearCache(),t})}deleteRoleAttachment(e){return _(this,null,function*(){let{error:t}=yield this.supabase.client.from("role_attachments").delete().eq("id",e);if(t)throw t;this.clearCache()})}updateRoleAttachment(e,t){return _(this,null,function*(){let{data:o,error:a}=yield this.supabase.client.from("role_attachments").update(t).eq("id",e).select().single();if(a)throw a;return this.clearCache(),o})}};r.\u0275fac=function(t){return new(t||r)(V(H))},r.\u0275prov=A({token:r,factory:r.\u0275fac,providedIn:"root"});let i=r;return i})();var nr=(i,r)=>r.id;function ud(i,r){if(i&1&&(s(0,"span"),p(1),l(),p(2," \u2022 ")),i&2){let n=u().$implicit;c(),O(n.code)}}function md(i,r){if(i&1&&(p(0," \u2022 "),s(1,"span"),p(2),l()),i&2){let n=u().$implicit,e=u(2);c(2),O(e.getRoleServiceName(n.id))}}function gd(i,r){if(i&1){let n=S();s(0,"div",29)(1,"button",30),v("click",function(){f(n);let t=u().$implicit,o=u(2);return h(o.openEditModal("role",t))}),y(2,"lucide-icon",31),p(3," Modifier"),l(),s(4,"button",32),v("click",function(){f(n);let t=u().$implicit,o=u(2);return h(o.handleDelete("role",t.id))}),y(5,"lucide-icon",33),p(6," Supprimer"),l()()}i&2&&(c(2),g("size",14),c(3),g("size",14))}function fd(i,r){if(i&1){let n=S();s(0,"div",19),v("click",function(){let t=f(n).$implicit,o=u(2);return h(o.openEditModal("role",t))}),s(1,"div",20)(2,"div",21),p(3),l(),s(4,"div",22)(5,"div",23),p(6),l(),s(7,"div",24),F(8,ud,3,1),s(9,"span"),p(10),l(),F(11,md,3,1),l()()(),s(12,"div",25)(13,"div",26),v("click",function(t){return f(n),h(t.stopPropagation())}),s(14,"button",27),v("click",function(t){let o=f(n).$implicit,a=u(2);return h(a.toggleMenu(o.id,t))}),y(15,"lucide-icon",28),l(),F(16,gd,7,2,"div",29),l()()()}if(i&2){let n=r.$implicit,e=u(2);c(2),z("background-color",n.color||"#3b82f6"),c(),P(" ",n.nom.charAt(0).toUpperCase()," "),c(3),O(n.nom),c(2),q(n.code?8:-1),c(2),P("",n.jours_par_semaine,"j/sem"),c(),q(e.getRoleServiceName(n.id)?11:-1),c(4),g("size",20),c(),q(e.activeMenuId===n.id?16:-1)}}function hd(i,r){i&1&&(s(0,"div",18),p(1,"Aucun r\xF4le trouv\xE9."),l())}function _d(i,r){if(i&1&&ue(0,fd,17,9,"div",17,nr,!1,hd,2,0,"div",18),i&2){let n=u();me(n.filteredRoles())}}function vd(i,r){if(i&1&&(s(0,"span"),p(1),l(),p(2," \u2022 ")),i&2){let n=u().$implicit;c(),O(n.email)}}function Cd(i,r){if(i&1&&(p(0," \u2022 "),s(1,"span"),p(2),l()),i&2){let n=u().$implicit,e=u(2);c(2),O(e.getServiceName(n.service_id))}}function xd(i,r){if(i&1){let n=S();s(0,"div",29)(1,"button",30),v("click",function(){f(n);let t=u().$implicit,o=u(2);return h(o.openEditModal("personne",t))}),y(2,"lucide-icon",31),p(3," Modifier"),l(),s(4,"button",32),v("click",function(){f(n);let t=u().$implicit,o=u(2);return h(o.handleDelete("personne",t.id))}),y(5,"lucide-icon",33),p(6," Supprimer"),l()()}i&2&&(c(2),g("size",14),c(3),g("size",14))}function bd(i,r){if(i&1){let n=S();s(0,"div",19),v("click",function(){let t=f(n).$implicit,o=u(2);return h(o.openEditModal("personne",t))}),s(1,"div",20)(2,"div",34),p(3),l(),s(4,"div",22)(5,"div",23),p(6),l(),s(7,"div",24),F(8,vd,3,1),s(9,"span"),p(10),l(),F(11,Cd,3,1),l()()(),s(12,"div",25)(13,"div",26),v("click",function(t){return f(n),h(t.stopPropagation())}),s(14,"button",27),v("click",function(t){let o=f(n).$implicit,a=u(2);return h(a.toggleMenu(o.id,t))}),y(15,"lucide-icon",28),l(),F(16,xd,7,2,"div",29),l()()()}if(i&2){let n=r.$implicit,e=u(2);c(2),z("background-color",n.color||"#10b981"),c(),P(" ",e.getPersonneInitials(n)," "),c(3),Se("",n.prenom," ",n.nom),c(2),q(n.email?8:-1),c(2),P("",n.jours_par_semaine,"j/sem"),c(),q(e.getServiceName(n.service_id)?11:-1),c(4),g("size",20),c(),q(e.activeMenuId===n.id?16:-1)}}function wd(i,r){i&1&&(s(0,"div",18),p(1,"Aucune personne trouv\xE9e."),l())}function yd(i,r){if(i&1&&ue(0,bd,17,10,"div",17,nr,!1,wd,2,0,"div",18),i&2){let n=u();me(n.filteredPersonnes())}}function Md(i,r){if(i&1){let n=S();s(0,"div",40)(1,"label"),p(2,"Pr\xE9nom"),l(),s(3,"input",56),T("ngModelChange",function(t){f(n);let o=u(2);return E(o.formData.prenom,t)||(o.formData.prenom=t),h(t)}),l()()}if(i&2){let n=u(2);c(3),k("ngModel",n.formData.prenom)}}function Pd(i,r){if(i&1){let n=S();s(0,"div",42)(1,"label"),p(2,"Email"),l(),s(3,"input",57),T("ngModelChange",function(t){f(n);let o=u(2);return E(o.formData.email,t)||(o.formData.email=t),h(t)}),l()()}if(i&2){let n=u(2);c(3),k("ngModel",n.formData.email)}}function Sd(i,r){if(i&1){let n=S();s(0,"div",40)(1,"label"),p(2,"Code"),l(),s(3,"input",58),T("ngModelChange",function(t){f(n);let o=u(2);return E(o.formData.code,t)||(o.formData.code=t),h(t)}),l()()}if(i&2){let n=u(2);c(3),k("ngModel",n.formData.code)}}function Od(i,r){if(i&1&&(s(0,"option",45),p(1),l()),i&2){let n=r.$implicit;g("value",n.id),c(),O(n.nom)}}function kd(i,r){if(i&1){let n=S();s(0,"div",59),v("click",function(){let t=f(n).$implicit,o=u(2);return h(o.selectColor(t))}),l()}if(i&2){let n=r.$implicit,e=u(2);z("background-color",n),$("active",e.formData.color===n)}}function Ed(i,r){i&1&&y(0,"lucide-icon",10),i&2&&g("size",16)}function Td(i,r){if(i&1&&y(0,"div",60),i&2){let n=u(2);z("background-color",n.formData.color)}}function Id(i,r){if(i&1){let n=S();s(0,"div",52)(1,"input",61),T("ngModelChange",function(t){f(n);let o=u(2);return E(o.formData.color,t)||(o.formData.color=t),h(t)}),l(),s(2,"input",62),T("ngModelChange",function(t){f(n);let o=u(2);return E(o.formData.color,t)||(o.formData.color=t),h(t)}),l()()}if(i&2){let n=u(2);c(),k("ngModel",n.formData.color),c(),k("ngModel",n.formData.color)}}function jd(i,r){if(i&1){let n=S();s(0,"div",35),v("click",function(){f(n);let t=u();return h(t.closeModal())}),s(1,"div",36),v("click",function(t){return f(n),h(t.stopPropagation())}),s(2,"h2",37),p(3),l(),s(4,"form",38),v("submit",function(t){f(n);let o=u();return t.preventDefault(),h(o.handleSave())}),s(5,"div",39),F(6,Md,4,1,"div",40),s(7,"div",40)(8,"label"),p(9,"Nom"),l(),s(10,"input",41),T("ngModelChange",function(t){f(n);let o=u();return E(o.formData.nom,t)||(o.formData.nom=t),h(t)}),l()(),F(11,Pd,4,1,"div",42),F(12,Sd,4,1,"div",40),s(13,"div",40)(14,"label"),p(15,"Service rattach\xE9"),l(),s(16,"select",43),T("ngModelChange",function(t){f(n);let o=u();return E(o.formData.service_id,t)||(o.formData.service_id=t),h(t)}),s(17,"option",44),p(18,"Aucun service"),l(),ue(19,Od,2,2,"option",45,nr),l()(),s(21,"div",40)(22,"label"),p(23,"Jours / Semaine"),l(),s(24,"input",46),T("ngModelChange",function(t){f(n);let o=u();return E(o.formData.jours_par_semaine,t)||(o.formData.jours_par_semaine=t),h(t)}),l()(),s(25,"div",42)(26,"label"),p(27,"Couleur"),l(),s(28,"div",47),ue(29,kd,1,4,"div",48,Bt),s(31,"div",49),v("click",function(){f(n);let t=u();return h(t.isCustomColor=!t.isCustomColor)}),w(32,Ed,1,1,"lucide-icon",50)(33,Td,1,2,"div",51),l()(),F(34,Id,3,2,"div",52),l()(),s(35,"div",53)(36,"button",54),v("click",function(){f(n);let t=u();return h(t.closeModal())}),p(37,"Annuler"),l(),s(38,"button",55),p(39),l()()()()()}if(i&2){let n=u();c(3),Se("",n.isEditing?"Modifier":"Ajouter"," ",n.activeTab==="role"?"un R\xF4le":"une Personne"),c(3),q(n.activeTab==="personne"?6:-1),c(4),k("ngModel",n.formData.nom),g("placeholder",n.activeTab==="role"?"Ex: D\xE9veloppeur Senior":"Ex: Dupont"),c(),q(n.activeTab==="personne"?11:-1),c(),q(n.activeTab==="role"?12:-1),c(4),k("ngModel",n.formData.service_id),c(3),me(n.services),c(5),k("ngModel",n.formData.jours_par_semaine),c(5),me(n.predefinedColors),c(2),$("active",n.isCustomColor),c(),g("ngIf",!n.isCustomColor),c(),g("ngIf",n.isCustomColor),c(),q(n.isCustomColor?34:-1),c(5),O(n.isEditing?"Mettre \xE0 jour":"Cr\xE9er")}}var Rd=(()=>{let r=class r{};r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=Je({type:r}),r.\u0275inj=He({imports:[K.pick({Building2:wt,Layers:Kt,Box:oi,Users:Xe,MoreVertical:Jt,Plus:Ye,Edit:li,Trash2:ci,Search:ta,Check:Gr,X:ia,ChevronDown:yt,User:Ze}),K]});let i=r;return i})(),ds=(()=>{let r=class r{constructor(e,t,o){this.resourceService=e,this.rolesService=t,this.route=o,this.resourceCreated=new xe,this.activeTab="role",this.searchQuery="",this.activeMenuId=null,this.roles=[],this.personnes=[],this.services=[],this.roleAttachments=[],this.showModal=!1,this.isEditing=!1,this.editingId=null,this.formData=this.resetFormData(),this.predefinedColors=["#ef4444","#f97316","#f59e0b","#eab308","#84cc16","#22c55e","#10b981","#14b8a6","#06b6d4","#0ea5e9","#3b82f6","#6366f1","#8b5cf6","#a855f7","#d946ef","#ec4899","#f43f5e"],this.isCustomColor=!1,window.addEventListener("click",()=>this.activeMenuId=null)}ngOnInit(){return _(this,null,function*(){this.route.queryParams.subscribe(e=>{(e.tab==="personne"||e.tab==="role")&&(this.activeTab=e.tab)}),yield this.loadData()})}loadData(){return _(this,null,function*(){try{this.roles=yield this.rolesService.getAllRoles(),this.personnes=yield this.resourceService.getAllPersonnes(),this.services=yield this.resourceService.getAllServices(),this.roleAttachments=yield this.rolesService.getAllRoleAttachments()}catch(e){console.error("Error loading resources:",e)}})}resetFormData(){return{nom:"",prenom:"",email:"",jours_par_semaine:5,code:"",color:"#3b82f6",service_id:""}}filteredRoles(){return this.roles.filter(e=>e.nom.toLowerCase().includes(this.searchQuery.toLowerCase())||e.code&&e.code.toLowerCase().includes(this.searchQuery.toLowerCase()))}filteredPersonnes(){return this.personnes.filter(e=>e.nom.toLowerCase().includes(this.searchQuery.toLowerCase())||e.prenom.toLowerCase().includes(this.searchQuery.toLowerCase()))}getPersonneInitials(e){return e.prenom&&!e.nom?e.prenom.charAt(0).toUpperCase():e.nom&&!e.prenom?e.nom.charAt(0).toUpperCase():!e.prenom&&!e.nom?"?":(e.prenom.charAt(0)+e.nom.charAt(0)).toUpperCase()}getServiceName(e){return e&&this.services.find(t=>t.id===e)?.nom||""}getRoleServiceName(e){let t=this.roleAttachments.find(o=>o.role_id===e);return t?this.getServiceName(t.service_id):""}toggleMenu(e,t){t.stopPropagation(),this.activeMenuId=this.activeMenuId===e?null:e}openCreateModal(){this.isEditing=!1,this.editingId=null,this.formData=this.resetFormData(),this.isCustomColor=!1,this.showModal=!0}openEditModal(e,t){return _(this,null,function*(){if(this.isEditing=!0,this.editingId=t.id,this.formData=ge(I({},t),{service_id:""}),e==="role"){let o=this.roleAttachments.find(a=>a.role_id===t.id);o&&(this.formData.service_id=o.service_id||"")}else this.formData.service_id=t.service_id||"";this.isCustomColor=!this.predefinedColors.includes(this.formData.color),this.showModal=!0,this.activeMenuId=null})}closeModal(){this.showModal=!1}selectColor(e){this.formData.color=e,this.isCustomColor=!1}handleSave(){return _(this,null,function*(){try{let e=this.services.find(a=>a.id===this.formData.service_id),t=e?.id_service||null,o=this.formData.service_id||null;if(this.activeTab==="role"){let a={nom:this.formData.nom,code:this.formData.code,jours_par_semaine:this.formData.jours_par_semaine,color:this.formData.color},d;this.isEditing&&this.editingId?d=yield this.rolesService.updateRole(this.editingId,a):d=yield this.rolesService.createRole(a);let m=this.roleAttachments.find(C=>C.role_id===d.id);if(o){let C={role_id:d.id,service_id:o,id_service:t,societe_id:e?.societe_id||null,departement_id:e?.departement_id||null};m?yield this.rolesService.updateRoleAttachment(m.id,C):yield this.rolesService.createRoleAttachment(C)}else m&&(yield this.rolesService.updateRoleAttachment(m.id,{service_id:null,id_service:null,societe_id:null,departement_id:null}))}else{let a={nom:this.formData.nom,prenom:this.formData.prenom||"",email:this.formData.email,jours_par_semaine:this.formData.jours_par_semaine,color:this.formData.color,service_id:o,id_service:t};this.isEditing&&this.editingId?yield this.resourceService.updatePersonne(this.editingId,a):yield this.resourceService.createPersonne(a)}this.closeModal(),yield this.loadData(),this.resourceCreated.emit()}catch(e){console.error("Error saving resource:",e)}})}handleDelete(e,t){return _(this,null,function*(){if(confirm("\xCAtes-vous s\xFBr de vouloir supprimer cette ressource ?"))try{e==="role"?yield this.rolesService.deleteRole(t):yield this.resourceService.deletePersonne(t),yield this.loadData(),this.resourceCreated.emit()}catch(o){console.error("Error deleting resource:",o)}})}};r.\u0275fac=function(t){return new(t||r)(R(un),R(gn),R(Ne))},r.\u0275cmp=B({type:r,selectors:[["app-resource-manager"]],outputs:{resourceCreated:"resourceCreated"},decls:25,vars:12,consts:[[1,"resource-manager"],[1,"view-header"],[1,"title-group"],[1,"view-title"],[1,"view-subtitle"],[1,"header-actions"],[1,"search-container"],["name","search",1,"search-icon",3,"size"],["type","text","placeholder","Rechercher par nom ou code...",1,"search-input",3,"ngModelChange","ngModel"],[1,"btn-create",3,"click"],["name","plus",3,"size"],[1,"tabs"],[1,"tab-btn",3,"click"],["name","layers",3,"size"],["name","users",3,"size"],[1,"resource-list"],[1,"modal-overlay"],[1,"resource-card"],[1,"empty-state"],[1,"resource-card",3,"click"],[1,"card-left"],[1,"avatar","role"],[1,"resource-info"],[1,"resource-name"],[1,"resource-meta"],[1,"card-right"],[1,"kebab-menu-container",3,"click"],[1,"kebab-btn",3,"click"],["name","more-vertical",3,"size"],[1,"menu-dropdown"],[3,"click"],["name","edit",3,"size"],[1,"delete-btn",3,"click"],["name","trash2",3,"size"],[1,"avatar","personne"],[1,"modal-overlay",3,"click"],[1,"modal-content",3,"click"],[1,"modal-title"],[3,"submit"],[1,"form-grid"],[1,"form-group"],["type","text","name","nom","required","",3,"ngModelChange","ngModel","placeholder"],[1,"form-group","full-width"],["name","service_id",3,"ngModelChange","ngModel"],["value",""],[3,"value"],["type","number","name","jours_par_semaine","step","0.5","min","0.5","max","7","required","",3,"ngModelChange","ngModel"],[1,"color-palette"],[1,"color-swatch",3,"background-color","active"],[1,"color-swatch","custom-trigger",3,"click"],["name","plus",3,"size",4,"ngIf"],["class","custom-preview",3,"background-color",4,"ngIf"],[1,"custom-color-input-wrapper"],[1,"modal-actions"],["type","button",1,"btn-cancel",3,"click"],["type","submit",1,"btn-confirm"],["type","text","name","prenom","placeholder","Ex: Jean","required","",3,"ngModelChange","ngModel"],["type","email","name","email","placeholder","jean.dupont@exemple.com",3,"ngModelChange","ngModel"],["type","text","name","code","placeholder","Ex: DEV-SEN",3,"ngModelChange","ngModel"],[1,"color-swatch",3,"click"],[1,"custom-preview"],["type","color","name","customColor",1,"color-input",3,"ngModelChange","ngModel"],["type","text","name","customColorText","placeholder","#HEXCODE",1,"color-hex-input",3,"ngModelChange","ngModel"]],template:function(t,o){t&1&&(s(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),p(4,"Ressources"),l(),s(5,"p",4),p(6,"G\xE9rez vos \xE9quipes et collaborateurs"),l()(),s(7,"div",5)(8,"div",6),y(9,"lucide-icon",7),s(10,"input",8),T("ngModelChange",function(d){return E(o.searchQuery,d)||(o.searchQuery=d),d}),l()(),s(11,"button",9),v("click",function(){return o.openCreateModal()}),y(12,"lucide-icon",10),p(13),l()()(),s(14,"div",11)(15,"button",12),v("click",function(){return o.activeTab="role"}),y(16,"lucide-icon",13),p(17," R\xF4les "),l(),s(18,"button",12),v("click",function(){return o.activeTab="personne"}),y(19,"lucide-icon",14),p(20," Personnes "),l()(),s(21,"div",15),F(22,_d,3,1)(23,yd,3,1),l(),F(24,jd,40,15,"div",16),l()),t&2&&(c(9),g("size",18),c(),k("ngModel",o.searchQuery),c(2),g("size",18),c(),P(" Ajouter ",o.activeTab==="role"?"un R\xF4le":"une Personne"," "),c(2),$("active",o.activeTab==="role"),c(),g("size",18),c(2),$("active",o.activeTab==="personne"),c(),g("size",18),c(3),q(o.activeTab==="role"?22:23),c(2),q(o.showModal?24:-1))},dependencies:[G,te,X,Te,qe,Ue,ie,Pt,Fe,oe,ke,Ie,Zt,oa,re,Ee,Rd,ne],styles:[".resource-manager[_ngcontent-%COMP%]{padding:20px;background:#f5f7fa;min-height:100vh;font-family:Inter,sans-serif}.view-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-end;margin-bottom:32px;gap:24px}.view-title[_ngcontent-%COMP%]{font-size:28px;font-weight:700;color:#1e293b;margin:0}.view-subtitle[_ngcontent-%COMP%]{font-size:14px;color:#64748b;margin:4px 0 0;font-weight:500}.header-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.search-container[_ngcontent-%COMP%]{position:relative;width:320px}.search-icon[_ngcontent-%COMP%]{position:absolute;left:12px;top:50%;transform:translateY(-50%);color:#94a3b8;pointer-events:none}.search-input[_ngcontent-%COMP%]{width:100%;padding:8px 12px 8px 36px;border:1px solid #e2e8f0;border-radius:8px;font-size:14px;transition:all .2s;background:#fff;color:#1e293b}.search-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#3b82f6;box-shadow:0 0 0 3px #3b82f61a}.btn-create[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 16px;background:#3b82f6;color:#fff;border:none;border-radius:8px;font-weight:600;cursor:pointer;transition:all .2s;white-space:nowrap;font-size:14px}.btn-create[_ngcontent-%COMP%]:hover{background:#2563eb;transform:translateY(-1px)}.btn-create[_ngcontent-%COMP%]:active{transform:translateY(0)}.tabs[_ngcontent-%COMP%]{display:flex;gap:8px;margin-bottom:24px;background:#f3f4f6;padding:6px;border-radius:14px;width:fit-content}.tab-btn[_ngcontent-%COMP%]{padding:10px 24px;border:none;border-radius:10px;cursor:pointer;font-weight:600;font-size:14px;color:#6b7280;display:flex;align-items:center;gap:8px;transition:all .2s;background:transparent}.tab-btn.active[_ngcontent-%COMP%]{background:#fff;color:#111827;box-shadow:0 1px 3px #0000001a}.tab-btn[_ngcontent-%COMP%]:hover:not(.active){color:#374151}.resource-list[_ngcontent-%COMP%]{display:grid;gap:16px}.resource-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e5e7eb;border-radius:16px;padding:16px 20px;display:flex;justify-content:space-between;align-items:center;transition:all .2s;cursor:pointer}.resource-card[_ngcontent-%COMP%]:hover{border-color:#3b82f6;box-shadow:0 4px 12px #0000000d}.card-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px}.avatar[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:12px;display:flex;align-items:center;justify-content:center;color:#fff;font-weight:700;font-size:18px;flex-shrink:0}.resource-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2px}.resource-name[_ngcontent-%COMP%]{font-weight:700;color:#111827;font-size:16px}.resource-meta[_ngcontent-%COMP%]{font-size:13px;color:#6b7280;font-weight:500}.kebab-menu-container[_ngcontent-%COMP%]{position:relative}.kebab-btn[_ngcontent-%COMP%]{background:transparent;border:none;cursor:pointer;padding:8px;border-radius:8px;color:#9ca3af;display:flex;transition:all .2s}.kebab-btn[_ngcontent-%COMP%]:hover{background:#f3f4f6;color:#374151}.menu-dropdown[_ngcontent-%COMP%]{position:absolute;right:0;top:100%;background:#fff;border:1px solid #e5e7eb;border-radius:12px;box-shadow:0 10px 15px -3px #0000001a;padding:6px;min-width:160px;z-index:50;display:flex;flex-direction:column;gap:2px;margin-top:4px}.menu-dropdown[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{background:none;border:none;padding:10px 12px;text-align:left;cursor:pointer;font-size:14px;color:#374151;width:100%;display:flex;align-items:center;gap:10px;border-radius:8px;font-weight:500}.menu-dropdown[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]:hover{background:#f3f4f6}.menu-dropdown[_ngcontent-%COMP%]   button.delete-btn[_ngcontent-%COMP%]{color:#ef4444}.menu-dropdown[_ngcontent-%COMP%]   button.delete-btn[_ngcontent-%COMP%]:hover{background:#fee2e2}.empty-state[_ngcontent-%COMP%]{padding:48px;text-align:center;color:#9ca3af;font-size:15px;background:#fff;border-radius:16px;border:2px dashed #e5e7eb}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#0009;display:flex;align-items:center;justify-content:center;z-index:100;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px);padding:20px}.modal-content[_ngcontent-%COMP%]{background:#fff;border-radius:20px;padding:32px;width:100%;max-width:540px;max-height:90vh;overflow-y:auto;box-shadow:0 25px 50px -12px #00000040}.modal-title[_ngcontent-%COMP%]{font-size:24px;font-weight:800;color:#111827;margin-bottom:16px}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(2,1fr);gap:8px}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:8px}.form-group.full-width[_ngcontent-%COMP%]{grid-column:span 2}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-size:14px;font-weight:600;color:#374151}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{padding:12px 14px;border:1px solid #d1d5db;border-radius:10px;font-size:15px;color:#111827;transition:all .2s}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{border-color:#3b82f6;outline:none;box-shadow:0 0 0 3px #3b82f61a}.color-palette[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px;margin-top:4px}.color-swatch[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:8px;cursor:pointer;transition:all .2s;border:2px solid transparent}.color-swatch[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.color-swatch.active[_ngcontent-%COMP%]{border-color:#111827;box-shadow:0 0 0 2px #fff,0 0 0 4px #111827}.color-input[_ngcontent-%COMP%]{width:60px;height:40px;padding:2px;cursor:pointer;border-radius:8px;border:1px solid #d1d5db}.color-hex-input[_ngcontent-%COMP%]{flex:1;text-transform:uppercase}.custom-trigger[_ngcontent-%COMP%]{background:#f3f4f6;border:2px dashed #d1d5db;display:flex;align-items:center;justify-content:center;color:#6b7280}.custom-trigger.active[_ngcontent-%COMP%]{border:2px solid #111827;background:#fff;color:#111827}.custom-preview[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:6px}.custom-color-input-wrapper[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center;margin-top:16px;padding:12px;background:#f9fafb;border-radius:12px;border:1px solid #e5e7eb}.modal-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px;margin-top:32px}.btn-cancel[_ngcontent-%COMP%]{padding:12px 24px;background:#fff;border:1px solid #d1d5db;border-radius:12px;font-weight:600;color:#374151;cursor:pointer}.btn-confirm[_ngcontent-%COMP%]{padding:12px 24px;background:#3b82f6;border:none;border-radius:12px;font-weight:600;color:#fff;cursor:pointer}.btn-confirm[_ngcontent-%COMP%]:hover{background:#2563eb}"]});let i=r;return i})();var Et=(()=>{let r=class r{constructor(e){this.supabase=e,this._equipesCache=null,this._rolesCache=null,this._personnesCache=null,this._equipeResourcesCache=new Map,this._capacitesCache=new Map,this._allCapacitiesCache=null}clearCache(){this._equipesCache=null,this._rolesCache=null,this._personnesCache=null,this._equipeResourcesCache.clear(),this._capacitesCache.clear(),this._allCapacitiesCache=null}getAllEquipes(){return _(this,null,function*(){if(this._equipesCache)return this._equipesCache;let{data:e,error:t}=yield this.supabase.client.from("equipes").select("*").order("nom");if(t)throw t;return this._equipesCache=e||[],this._equipesCache})}getEquipeResources(e){return _(this,null,function*(){if(this._equipeResourcesCache.has(e))return this._equipeResourcesCache.get(e);let t=[],{data:o,error:a}=yield this.supabase.client.from("role_attachments").select("id, role_id, roles(*)").eq("equipe_id",e);!a&&o&&o.forEach(C=>{C.roles&&t.push({type:"role",id:C.roles.id,uniqueId:C.id,nom:C.roles.nom,jours_par_semaine:C.roles.jours_par_semaine,color:C.roles.color})});let{data:d,error:m}=yield this.supabase.client.from("personnes").select("*").eq("equipe_id",e);return!m&&d&&d.forEach(C=>{t.push({type:"personne",id:C.id,uniqueId:C.id,nom:C.nom,prenom:C.prenom,jours_par_semaine:C.jours_par_semaine,color:C.color})}),this._equipeResourcesCache.set(e,t),t})}getAllRoles(){return _(this,null,function*(){if(this._rolesCache)return this._rolesCache;let{data:e,error:t}=yield this.supabase.client.from("roles").select("*").order("nom");if(t)throw t;return this._rolesCache=e||[],this._rolesCache})}getAvailableRolesForEquipe(e){return _(this,null,function*(){let t=yield this.getAllRoles(),{data:o,error:a}=yield this.supabase.client.from("role_attachments").select("role_id").eq("equipe_id",e);if(a)throw a;let d=new Set((o||[]).map(m=>m.role_id));return t.filter(m=>!d.has(m.id))})}getAllPersonnes(){return _(this,null,function*(){if(this._personnesCache)return this._personnesCache;let{data:e,error:t}=yield this.supabase.client.from("personnes").select("*").order("nom",{ascending:!0});if(t)throw t;return this._personnesCache=e||[],this._personnesCache})}getAvailablePersonnesForEquipe(e){return _(this,null,function*(){let t=yield this.getAllPersonnes(),{data:o,error:a}=yield this.supabase.client.from("personnes").select("id").eq("equipe_id",e);if(a)throw a;let d=new Set((o||[]).map(m=>m.id));return t.filter(m=>!d.has(m.id))})}addRoleToEquipe(e,t){return _(this,null,function*(){let{error:o}=yield this.supabase.client.from("role_attachments").insert({role_id:t,equipe_id:e});if(o)throw o.code==="23505"||o.message.includes("unique_role_per_team")?new Error("Ce r\xF4le est d\xE9j\xE0 attach\xE9 \xE0 cette \xE9quipe."):o;this.clearCache()})}addPersonneToEquipe(e,t){return _(this,null,function*(){let{error:o}=yield this.supabase.client.from("personnes").update({equipe_id:e}).eq("id",t);if(o)throw o;this.clearCache()})}removeRoleFromEquipe(e,t){return _(this,null,function*(){let{error:o}=yield this.supabase.client.from("role_attachments").delete().eq("role_id",e).eq("equipe_id",t);if(o)throw o;this.clearCache()})}removePersonneFromEquipe(e){return _(this,null,function*(){let{error:t}=yield this.supabase.client.from("personnes").update({equipe_id:null}).eq("id",e);if(t)throw t;this.clearCache()})}getCapacites(e,t,o){return _(this,null,function*(){let a=`${e}:${t}:${o}`;if(this._capacitesCache.has(a))return this._capacitesCache.get(a);let d=this.supabase.client.from("capacites").select("*").eq("equipe_id",o);t==="role"?d.eq("role_id",e):d.eq("personne_id",e);let{data:m,error:C}=yield d.order("semaine_debut");if(C)throw C;let b=m||[];return this._capacitesCache.set(a,b),b})}saveCapacite(e,t,o,a,d){return _(this,null,function*(){let m={semaine_debut:a,capacite:d,equipe_id:o};t==="role"?m.role_id=e:m.personne_id=e;let C=this.supabase.client.from("capacites").select("id").eq("semaine_debut",a).eq("equipe_id",o);t==="role"?C.eq("role_id",e):C.eq("personne_id",e);let{data:b}=yield C.single();if(b){let{error:x}=yield this.supabase.client.from("capacites").update({capacite:d}).eq("id",b.id);if(x)throw x}else{let{error:x}=yield this.supabase.client.from("capacites").insert(m);if(x)throw x}this.clearCache()})}deleteCapacite(e,t,o){return _(this,null,function*(){let a=this.supabase.client.from("capacites").delete().eq("semaine_debut",o);t==="role"?a.eq("role_id",e):a.eq("personne_id",e);let{error:d}=yield a;if(d)throw d;this.clearCache()})}getAllCapacities(){return _(this,null,function*(){if(this._allCapacitiesCache)return this._allCapacitiesCache;let{data:e,error:t}=yield this.supabase.client.from("capacites").select("*");if(t)throw t;return this._allCapacitiesCache=e||[],this._allCapacitiesCache})}};r.\u0275fac=function(t){return new(t||r)(V(H))},r.\u0275prov=A({token:r,factory:r.\u0275fac,providedIn:"root"});let i=r;return i})();var $i=(()=>{let r=class r{constructor(e){this.supabase=e}getWeekStart(e){let t=new Date(e),o=t.getDay(),a=t.getDate()-o+(o===0?-6:1);return new Date(t.setDate(a))}getWeekNumber(e){let t=new Date(Date.UTC(e.getFullYear(),e.getMonth(),e.getDate())),o=t.getUTCDay()||7;t.setUTCDate(t.getUTCDate()+4-o);let a=new Date(Date.UTC(t.getUTCFullYear(),0,1));return Math.ceil(((t.getTime()-a.getTime())/864e5+1)/7)}isCurrentWeek(e){let t=new Date,o=this.getWeekStart(t);return this.formatWeekStart(e)===this.formatWeekStart(o)}formatWeekStart(e){return e.toISOString().split("T")[0]}getCapacites(e){return _(this,null,function*(){let t=this.supabase.client.from("capacites").select("*");e?.roleId&&(t=t.eq("role_id",e.roleId)),e?.personneId&&(t=t.eq("personne_id",e.personneId)),e?.equipeId&&(t=t.eq("equipe_id",e.equipeId)),e?.serviceId&&(t=t.eq("service_id",e.serviceId)),e?.departementId&&(t=t.eq("departement_id",e.departementId)),e?.societeId&&(t=t.eq("societe_id",e.societeId));let{data:o,error:a}=yield t.order("semaine_debut");if(a)throw a;return o||[]})}setCapacite(e){return _(this,null,function*(){let t=yield this.findExistingCapacite(e);if(t){let{data:o,error:a}=yield this.supabase.client.from("capacites").update({capacite:e.capacite}).eq("id",t.id).select().single();if(a)throw a;return o}else{let{data:o,error:a}=yield this.supabase.client.from("capacites").insert([e]).select().single();if(a)throw a;return o}})}findExistingCapacite(e){return _(this,null,function*(){let t=this.supabase.client.from("capacites").select("*").eq("semaine_debut",e.semaine_debut);e.role_id&&(t=t.eq("role_id",e.role_id)),e.personne_id&&(t=t.eq("personne_id",e.personne_id)),e.equipe_id&&(t=t.eq("equipe_id",e.equipe_id)),e.service_id&&(t=t.eq("service_id",e.service_id)),e.departement_id&&(t=t.eq("departement_id",e.departement_id)),e.societe_id&&(t=t.eq("societe_id",e.societe_id));let{data:o,error:a}=yield t.maybeSingle();if(a)throw a;return o})}setCapaciteForWeeks(e,t,o){return _(this,null,function*(){let a=e.map(d=>{let m={semaine_debut:this.formatWeekStart(d),capacite:t,role_id:o.roleId,personne_id:o.personneId,equipe_id:o.equipeId,service_id:o.serviceId,departement_id:o.departementId,societe_id:o.societeId};return this.setCapacite(m)});yield Promise.all(a)})}getCharges(e){return _(this,null,function*(){let t=this.supabase.client.from("charges").select("*");e&&(t=t.eq("projet_id",e));let{data:o,error:a}=yield t.order("semaine_debut");if(a)throw a;return o||[]})}createCharge(e){return _(this,null,function*(){let{data:t,error:o}=yield this.supabase.client.from("charges").insert([e]).select().single();if(o)throw o;return t})}updateCharge(e,t){return _(this,null,function*(){let{data:o,error:a}=yield this.supabase.client.from("charges").update(t).eq("id",e).select().single();if(a)throw a;return o})}deleteCharge(e){return _(this,null,function*(){let{error:t}=yield this.supabase.client.from("charges").delete().eq("id",e);if(t)throw t})}getJalons(e){return _(this,null,function*(){let t=this.supabase.client.from("jalons").select("*");e&&(t=t.eq("projet_id",e));let{data:o,error:a}=yield t.order("date_jalon");if(a)throw a;return o||[]})}createJalon(e){return _(this,null,function*(){let{data:t,error:o}=yield this.supabase.client.from("jalons").insert([e]).select().single();if(o)throw o;return t})}calculateDisponible(e,t){return e-t}calculateJoursCharges(e,t,o){return e*t*o}};r.\u0275fac=function(t){return new(t||r)(V(H))},r.\u0275prov=A({token:r,factory:r.\u0275fac,providedIn:"root"});let i=r;return i})();var Vd=["bulkCapaciteInput"];function Dd(i,r){if(i&1){let n=S();s(0,"div",37)(1,"div",38)(2,"div",39),y(3,"lucide-icon",40),l(),s(4,"span",41),p(5),l(),s(6,"button",42),v("click",function(){let t=f(n).$implicit,o=u(2).$implicit,a=u();return h(a.removeResource(t,o.equipe))}),p(7,"\xD7"),l()()()}if(i&2){let n=r.$implicit;c(2),z("background-color",n.color||"#e2e8f0"),c(),g("name",n.type==="role"?"contact":"user")("size",14),c(2),O(n.label)}}function Ad(i,r){if(i&1&&(be(0),w(1,Dd,8,5,"div",36),we()),i&2){let n=u().$implicit;c(),g("ngForOf",n.resources)}}function Nd(i,r){if(i&1){let n=S();be(0),s(1,"div",25)(2,"div",26),v("click",function(){let t=f(n).$implicit,o=u();return h(o.toggleTeam(t))}),y(3,"lucide-icon",27),s(4,"div",28)(5,"div",29),y(6,"div",30),l(),s(7,"div",31)(8,"span",32),p(9),l()()(),s(10,"button",33),v("click",function(t){let o=f(n).$implicit;return u().openAddResourceModal(o.equipe),h(t.stopPropagation())}),y(11,"lucide-icon",34),p(12," Ressource "),l()()(),w(13,Ad,2,1,"ng-container",35),we()}if(i&2){let n=r.$implicit;c(2),z("cursor",n.resources.length>0?"pointer":"default"),c(),z("visibility",n.resources.length>0?"visible":"hidden"),g("name",n.expanded?"chevron-down":"chevron-right")("size",18),c(3),z("background-color",n.equipe.color||"#94a3b8"),c(3),O(n.equipe.nom),c(2),g("name","plus")("size",14),c(2),g("ngIf",n.expanded)}}function Ld(i,r){i&1&&(s(0,"div",43)(1,"p"),p(2,"Aucune \xE9quipe"),l()())}function zd(i,r){if(i&1&&(s(0,"div",44)(1,"div",45),p(2),l(),s(3,"div",46),p(4),l()()),i&2){let n=r.$implicit,e=u();$("current-week",e.isCurrentWeek(n)),c(2),O(e.formatWeekHeader(n)),c(2),P("S",e.getWeekNumber(n))}}function Fd(i,r){if(i&1&&(s(0,"div",54),p(1),ce(2,"number"),l()),i&2){let n=u(2).$implicit,e=u().$implicit,t=u();c(),P(" ",de(2,1,t.getTeamTotalDays(e,n),"1.1-1"),"j ")}}function qd(i,r){if(i&1&&(s(0,"div",51)(1,"div",52),p(2),ce(3,"number"),l(),w(4,Fd,3,4,"div",53),l()),i&2){let n=u().$implicit,e=u().$implicit,t=u();c(2),P(" ",de(3,2,t.getTeamTotalCapacity(e,n),"1.0-1")," "),c(2),g("ngIf",t.showDaysInCells)}}function Ud(i,r){if(i&1&&(s(0,"div",49),w(1,qd,5,5,"div",50),l()),i&2){let n=r.$implicit,e=u().$implicit,t=u();c(),g("ngIf",t.getTeamTotalCapacity(e,n)>0)}}function Wd(i,r){if(i&1&&(s(0,"div",54),p(1),ce(2,"number"),l()),i&2){let n=u(2).$implicit,e=u().$implicit,t=u(3);c(),P(" ",de(2,1,t.getCapacite(e,n)*e.jours_par_semaine,"1.1-1"),"j ")}}function $d(i,r){if(i&1&&(s(0,"div",60)(1,"div",52),p(2),l(),w(3,Wd,3,4,"div",53),l()),i&2){let n=u().$implicit,e=u().$implicit,t=u(3);c(2),O(t.getCapacite(e,n)),c(),g("ngIf",t.showDaysInCells)}}function Bd(i,r){if(i&1&&(s(0,"div",58),w(1,$d,4,2,"div",59),l()),i&2){let n=r.$implicit,e=r.index,t=u().$implicit,o=u(3);$("selected",o.isCellSelected(t,n))("has-capacity",o.getCapacite(t,n)>0),_e("data-week-index",e),c(),g("ngIf",o.getCapacite(t,n)>0)}}function Hd(i,r){if(i&1){let n=S();s(0,"div",56),v("mousedown",function(t){let o=f(n).$implicit,a=u(3);return h(a.onMouseDown(t,o))})("mousemove",function(t){let o=f(n).$implicit,a=u(3);return h(a.onMouseMove(t,o))})("mouseup",function(){f(n);let t=u(3);return h(t.onMouseUp())})("mouseleave",function(){f(n);let t=u(3);return h(t.onMouseUp())}),w(1,Bd,2,6,"div",57),l()}if(i&2){let n=r.$implicit,e=u(3);_e("data-resource-id",n.uniqueId),c(),g("ngForOf",e.displayedWeeks)}}function Gd(i,r){if(i&1&&(be(0),w(1,Hd,2,2,"div",55),we()),i&2){let n=u().$implicit;c(),g("ngForOf",n.resources)}}function Jd(i,r){if(i&1&&(be(0),s(1,"div",47),w(2,Ud,2,1,"div",48),l(),w(3,Gd,2,1,"ng-container",35),we()),i&2){let n=r.$implicit,e=u();c(2),g("ngForOf",e.displayedWeeks),c(),g("ngIf",n.expanded)}}function Yd(i,r){i&1&&(s(0,"div",61)(1,"p"),p(2,"Aucune donn\xE9e"),l()())}function Qd(i,r){if(i&1){let n=S();s(0,"div",62)(1,"div",63),p(2),s(3,"div",64),p(4),ce(5,"number"),l()(),s(6,"div",65)(7,"input",66,0),T("ngModelChange",function(t){f(n);let o=u();return E(o.bulkCapaciteValue,t)||(o.bulkCapaciteValue=t),h(t)}),v("keydown.enter",function(){f(n);let t=u();return h(t.applyBulkCapacite())}),l()(),s(9,"div",67)(10,"button",68),v("click",function(){f(n);let t=u();return h(t.clearSelection())}),p(11,"Annuler"),l(),s(12,"button",8),v("click",function(){f(n);let t=u();return h(t.applyBulkCapacite())}),p(13,"Appliquer"),l()()()}if(i&2){let n=u();z("top",n.toolbarPosition==null?null:n.toolbarPosition.top,"px")("left",n.toolbarPosition==null?null:n.toolbarPosition.left,"px")("transform","translate(-50%, 10px)")("opacity",n.toolbarVisible?1:0),c(2),P(" ",n.selectedCells.length," semaine(s) s\xE9lectionn\xE9e(s) "),c(2),P(" Total jours s\xE9lectionn\xE9s: ",de(5,11,n.totalSelectedDays,"1.1-1"),"j "),c(3),k("ngModel",n.bulkCapaciteValue)}}function Kd(i,r){i&1&&(s(0,"div",83)(1,"p"),p(2,"Aucun r\xF4le disponible. Tous les r\xF4les sont d\xE9j\xE0 utilis\xE9s."),l()())}function Zd(i,r){if(i&1&&(s(0,"option",86),p(1),l()),i&2){let n=r.$implicit;g("value",n.id),c(),Se(" ",n.nom," (",n.jours_par_semaine,"j/sem) ")}}function Xd(i,r){if(i&1){let n=S();s(0,"select",75),T("ngModelChange",function(t){f(n);let o=u(3);return E(o.selectedResourceId,t)||(o.selectedResourceId=t),h(t)}),s(1,"option",84),p(2,"-- Choisir un r\xF4le --"),l(),w(3,Zd,2,3,"option",85),l()}if(i&2){let n=u(3);k("ngModel",n.selectedResourceId),c(3),g("ngForOf",n.availableRoles)}}function ep(i,r){if(i&1&&(s(0,"div",74)(1,"label"),p(2,"S\xE9lectionner un r\xF4le"),l(),w(3,Kd,3,0,"div",81)(4,Xd,4,2,"select",82),l()),i&2){let n=u(2);c(3),g("ngIf",n.availableRoles.length===0),c(),g("ngIf",n.availableRoles.length>0)}}function tp(i,r){i&1&&(s(0,"div",83)(1,"p"),p(2,"Aucune personne disponible."),l()())}function np(i,r){if(i&1&&(s(0,"option",86),p(1),l()),i&2){let n=r.$implicit;g("value",n.id),c(),Zn(" ",n.prenom," ",n.nom," (",n.jours_par_semaine,"j/sem) ")}}function ip(i,r){if(i&1){let n=S();s(0,"select",75),T("ngModelChange",function(t){f(n);let o=u(3);return E(o.selectedResourceId,t)||(o.selectedResourceId=t),h(t)}),s(1,"option",84),p(2,"-- Choisir une personne --"),l(),w(3,np,2,4,"option",85),l()}if(i&2){let n=u(3);k("ngModel",n.selectedResourceId),c(3),g("ngForOf",n.availablePersonnes)}}function op(i,r){if(i&1&&(s(0,"div",74)(1,"label"),p(2,"S\xE9lectionner une personne"),l(),w(3,tp,3,0,"div",81)(4,ip,4,2,"select",82),l()),i&2){let n=u(2);c(3),g("ngIf",n.availablePersonnes.length===0),c(),g("ngIf",n.availablePersonnes.length>0)}}function rp(i,r){if(i&1){let n=S();s(0,"div",69),v("click",function(){f(n);let t=u();return h(t.showAddResourceModal=!1)}),s(1,"div",70),v("click",function(t){return f(n),h(t.stopPropagation())}),s(2,"div",71)(3,"h2"),p(4),l(),s(5,"button",72),v("click",function(){f(n);let t=u();return h(t.showAddResourceModal=!1)}),p(6,"\xD7"),l()(),s(7,"div",73)(8,"div",74)(9,"label"),p(10,"Type de ressource"),l(),s(11,"select",75),T("ngModelChange",function(t){f(n);let o=u();return E(o.resourceTypeToAdd,t)||(o.resourceTypeToAdd=t),h(t)}),s(12,"option",76),p(13,"R\xF4le"),l(),s(14,"option",77),p(15,"Personne"),l()()(),w(16,ep,5,2,"div",78)(17,op,5,2,"div",78),s(18,"div",79)(19,"button",80),v("click",function(){f(n);let t=u();return h(t.addResourceToTeam())}),p(20," Ajouter "),l(),s(21,"button",4),v("click",function(){f(n);let t=u();return h(t.showAddResourceModal=!1)}),p(22,"Annuler"),l()()()()()}if(i&2){let n=u();c(4),P("Ajouter une Ressource \xE0 ",n.selectedEquipe==null?null:n.selectedEquipe.nom),c(7),k("ngModel",n.resourceTypeToAdd),c(5),g("ngIf",n.resourceTypeToAdd==="role"),c(),g("ngIf",n.resourceTypeToAdd==="personne"),c(2),g("disabled",!n.selectedResourceId||n.resourceTypeToAdd==="role"&&n.availableRoles.length===0||n.resourceTypeToAdd==="personne"&&n.availablePersonnes.length===0)}}var ap=(()=>{let r=class r{};r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=Je({type:r}),r.\u0275inj=He({imports:[K.pick({ChevronDown:yt,ChevronRight:Mt,Plus:Ye,User:Ze,Users:Xe,Contact:Gt}),K]});let i=r;return i})(),us=(()=>{let r=class r{constructor(e,t){this.teamService=e,this.calendarService=t,this.displayedWeeks=[],this.currentDate=new Date,this.teamRows=[],this.availableRoles=[],this.availablePersonnes=[],this.showAddResourceModal=!1,this.selectedEquipe=null,this.resourceTypeToAdd="role",this.selectedResourceId="",this.isDragging=!1,this.dragStartResource=null,this.dragStartWeekIndex=-1,this.dragEndWeekIndex=-1,this.selectedCells=[],this.isSelectionFinished=!1,this.toolbarPosition=null,this.toolbarVisible=!1,this.bulkCapaciteValue=null,this.Contact=Gt,this.User=Ze,this.showDaysInCells=!1}ngOnInit(){return _(this,null,function*(){this.generateWeeks(),yield this.loadData()})}generateWeeks(){this.displayedWeeks=[];let e=new Date(this.currentDate);e.setDate(1);let t=this.calendarService.getWeekStart(e);for(let o=0;o<32;o++){let a=new Date(t);a.setDate(a.getDate()+o*7),this.displayedWeeks.push(a)}}loadData(){return _(this,null,function*(){try{let e=yield this.teamService.getAllEquipes();this.availableRoles=yield this.teamService.getAllRoles(),this.availablePersonnes=yield this.teamService.getAllPersonnes(),this.teamRows=[];for(let t of e){let o=yield this.teamService.getEquipeResources(t.id),a=[];for(let d of o){let m=yield this.teamService.getCapacites(d.id,d.type,t.id),C=new Map;m.forEach(b=>{let x=this.calendarService.formatWeekStart(new Date(b.semaine_debut));C.set(x,b.capacite)}),a.push({type:d.type,id:d.id,uniqueId:d.uniqueId,label:d.type==="role"?d.nom:`${d.prenom} ${d.nom}`,equipeId:t.id,weeks:C,jours_par_semaine:d.jours_par_semaine,color:d.color})}this.teamRows.push({equipe:t,resources:a,expanded:!0})}}catch(e){console.error("Error loading data:",e)}})}formatWeekHeader(e){let t=e.getDate().toString().padStart(2,"0"),o=(e.getMonth()+1).toString().padStart(2,"0");return`${t}/${o}`}getWeekNumber(e){return this.calendarService.getWeekNumber(e)}isCurrentWeek(e){let t=new Date,o=this.calendarService.getWeekStart(t);return this.calendarService.formatWeekStart(e)===this.calendarService.formatWeekStart(o)}getCapacite(e,t){let o=this.calendarService.formatWeekStart(t);return e.weeks.get(o)||0}toggleTeam(e){e.resources.length>0&&(e.expanded=!e.expanded)}openAddResourceModal(e){return _(this,null,function*(){this.selectedEquipe=e,this.resourceTypeToAdd="role",this.selectedResourceId="",this.showAddResourceModal=!0,this.availableRoles=yield this.teamService.getAvailableRolesForEquipe(e.id),this.availablePersonnes=yield this.teamService.getAvailablePersonnesForEquipe(e.id)})}addResourceToTeam(){return _(this,null,function*(){if(!(!this.selectedEquipe||!this.selectedResourceId))try{this.resourceTypeToAdd==="role"?yield this.teamService.addRoleToEquipe(this.selectedEquipe.id,this.selectedResourceId):yield this.teamService.addPersonneToEquipe(this.selectedEquipe.id,this.selectedResourceId),this.showAddResourceModal=!1,yield this.loadData()}catch(e){console.error("Error adding resource:",e),e.message&&e.message.includes("d\xE9j\xE0 attach\xE9")?alert(e.message):alert("Erreur lors de l'ajout de la ressource. Veuillez r\xE9essayer.")}})}removeResource(e,t){return _(this,null,function*(){if(confirm(`Retirer ${e.label} de l'\xE9quipe ${t.nom} ?`))try{e.type==="role"?yield this.teamService.removeRoleFromEquipe(e.id,t.id):yield this.teamService.removePersonneFromEquipe(e.id),yield this.loadData()}catch(o){console.error("Error removing resource:",o)}})}onMouseDown(e,t){this.isDragging=!0,this.isSelectionFinished=!1,this.dragStartResource=t;let a=e.target.closest(".week-cell");if(a){let d=a.getAttribute("data-week-index");d&&(this.dragStartWeekIndex=parseInt(d,10),this.dragEndWeekIndex=this.dragStartWeekIndex,this.updateSelection())}}onMouseMove(e,t){if(!this.isDragging||!this.dragStartResource||t.uniqueId!==this.dragStartResource.uniqueId)return;let a=e.target.closest(".week-cell");if(a){let d=a.getAttribute("data-week-index");if(d){let m=parseInt(d,10);m!==this.dragEndWeekIndex&&(this.dragEndWeekIndex=m,this.updateSelection())}}}onMouseUp(){this.isDragging=!1,this.selectedCells.length>0&&(this.isSelectionFinished=!0,this.updateToolbarPosition())}updateToolbarPosition(){!this.dragStartResource||this.dragEndWeekIndex<0||setTimeout(()=>{let e=`[data-resource-id="${this.dragStartResource.uniqueId}"]`,t=document.querySelector(e);if(t){let o=`[data-week-index="${this.dragEndWeekIndex}"]`,a=t.querySelector(o);if(a){let d=a.getBoundingClientRect();this.toolbarPosition={top:d.bottom,left:d.left+d.width/2},this.toolbarVisible=!0,setTimeout(()=>{this.bulkCapaciteInput?.nativeElement.focus()},50)}}},0)}updateSelection(){if(!this.dragStartResource||this.dragStartWeekIndex<0||this.dragEndWeekIndex<0)return;this.selectedCells=[];let e=Math.min(this.dragStartWeekIndex,this.dragEndWeekIndex),t=Math.max(this.dragStartWeekIndex,this.dragEndWeekIndex);for(let o=e;o<=t;o++)this.selectedCells.push({resource:this.dragStartResource,week:this.displayedWeeks[o]})}isCellSelected(e,t){return this.selectedCells.some(o=>o.resource.uniqueId===e.uniqueId&&o.week.getTime()===t.getTime())}clearSelection(){this.selectedCells=[],this.isSelectionFinished=!1,this.toolbarPosition=null,this.toolbarVisible=!1,this.dragStartResource=null,this.dragStartWeekIndex=-1,this.dragEndWeekIndex=-1}applyBulkCapacite(){return _(this,null,function*(){if(!(this.selectedCells.length===0||this.bulkCapaciteValue==null))try{for(let e of this.selectedCells){let t=this.calendarService.formatWeekStart(e.week);yield this.teamService.saveCapacite(e.resource.id,e.resource.type,e.resource.equipeId,t,this.bulkCapaciteValue),e.resource.weeks.set(t,this.bulkCapaciteValue)}this.clearSelection()}catch(e){console.error("Error saving capacities:",e)}})}get totalSelectedDays(){let e=0;for(let t of this.selectedCells){let o=this.getCapacite(t.resource,t.week)||0,a=t.resource.jours_par_semaine||0;e+=o*a}return e}goToPreviousMonth(){this.currentDate.setMonth(this.currentDate.getMonth()-1),this.generateWeeks()}goToNextMonth(){this.currentDate.setMonth(this.currentDate.getMonth()+1),this.generateWeeks()}goToToday(){this.currentDate=new Date,this.generateWeeks()}getTeamTotalCapacity(e,t){return e.resources.reduce((o,a)=>o+this.getCapacite(a,t),0)}getTeamTotalDays(e,t){return e.resources.reduce((o,a)=>o+this.getCapacite(a,t)*a.jours_par_semaine,0)}};r.\u0275fac=function(t){return new(t||r)(R(Et),R($i))},r.\u0275cmp=B({type:r,selectors:[["app-capacity-view"]],viewQuery:function(t,o){if(t&1&&At(Vd,5),t&2){let a;mt(a=gt())&&(o.bulkCapaciteInput=a.first)}},decls:35,vars:8,consts:[["bulkCapaciteInput",""],[1,"capacity-container"],[1,"capacity-header"],[1,"header-actions"],[1,"btn","btn-secondary",3,"click"],[1,"calendar-controls"],[1,"date-navigation"],[1,"btn","btn-sm",3,"click"],[1,"btn","btn-sm","btn-primary",3,"click"],[1,"controls-right",2,"display","flex","align-items","center","gap","12px"],["title","Afficher les jours (j)",1,"ios-switch"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"ios-slider"],[2,"user-select","none"],[1,"calendar-wrapper"],[1,"labels-column"],[1,"labels-header"],[4,"ngFor","ngForOf"],["class","empty-state-label",4,"ngIf"],[1,"weeks-column"],[1,"weeks-header"],["class","week-header",3,"current-week",4,"ngFor","ngForOf"],["class","empty-state-weeks",4,"ngIf"],["class","selection-toolbar",3,"top","left","transform","opacity",4,"ngIf"],["class","modal-overlay",3,"click",4,"ngIf"],[1,"team-label-row","px-0"],[1,"row-label-content",3,"click"],[1,"expand-icon-l",3,"name","size"],[1,"row-info-stack-wrapper"],[1,"color-bar-container"],[1,"color-bar-v"],[1,"info-stack"],[1,"info-label"],[1,"btn-hover-add",3,"click"],[3,"name","size"],[4,"ngIf"],["class","resource-label-row px-0",4,"ngFor","ngForOf"],[1,"resource-label-row","px-0"],[1,"row-label-content","resource-row"],[1,"resource-icon-wrapper"],[1,"resource-icon",3,"name","size"],[1,"resource-name"],[1,"btn-hover-delete",3,"click"],[1,"empty-state-label"],[1,"week-header"],[1,"week-date"],[1,"week-number"],[1,"team-weeks-row"],["class","week-cell team-cell",4,"ngFor","ngForOf"],[1,"week-cell","team-cell"],["class","team-summary",4,"ngIf"],[1,"team-summary"],[1,"capacity-value"],["class","days-value",4,"ngIf"],[1,"days-value"],["class","resource-weeks-row",3,"mousedown","mousemove","mouseup","mouseleave",4,"ngFor","ngForOf"],[1,"resource-weeks-row",3,"mousedown","mousemove","mouseup","mouseleave"],["class","week-cell resource-cell",3,"selected","has-capacity",4,"ngFor","ngForOf"],[1,"week-cell","resource-cell"],["class","cell-content",4,"ngIf"],[1,"cell-content"],[1,"empty-state-weeks"],[1,"selection-toolbar"],[1,"selection-info"],[1,"selection-total"],[1,"selection-input-row"],["type","number","placeholder","Capacit\xE9 (unit\xE9s)","step","0.5","min","0",1,"bulk-input",3,"ngModelChange","keydown.enter","ngModel"],[1,"selection-actions"],[1,"btn","btn-sm","btn-secondary",3,"click"],[1,"modal-overlay",3,"click"],[1,"modal",3,"click"],[1,"modal-header"],[1,"modal-close",3,"click"],[1,"modal-body"],[1,"form-group"],[1,"form-control",3,"ngModelChange","ngModel"],["value","role"],["value","personne"],["class","form-group",4,"ngIf"],[1,"modal-actions"],[1,"btn","btn-primary",3,"click","disabled"],["class","no-roles-message",4,"ngIf"],["class","form-control",3,"ngModel","ngModelChange",4,"ngIf"],[1,"no-roles-message"],["value",""],[3,"value",4,"ngFor","ngForOf"],[3,"value"]],template:function(t,o){t&1&&(s(0,"div",1)(1,"div",2)(2,"h1"),p(3,"Gestion de Capacit\xE9 par \xC9quipe"),l(),s(4,"div",3)(5,"button",4),v("click",function(){return o.goToToday()}),p(6,"Aujourd'hui"),l()()(),s(7,"div",5)(8,"div",6)(9,"button",7),v("click",function(){return o.goToPreviousMonth()}),p(10,"\u2190 Mois pr\xE9c\xE9dent"),l(),s(11,"button",8),v("click",function(){return o.goToToday()}),p(12,"Aujourd'hui"),l(),s(13,"button",7),v("click",function(){return o.goToNextMonth()}),p(14,"Mois suivant \u2192"),l()(),s(15,"div",9)(16,"label",10)(17,"input",11),T("ngModelChange",function(d){return E(o.showDaysInCells,d)||(o.showDaysInCells=d),d}),l(),y(18,"span",12),l(),s(19,"span",13),p(20,"Afficher les jours (j) dans les cellules"),l()()(),s(21,"div",14)(22,"div",15)(23,"div",16)(24,"span"),p(25,"\xC9quipes / Ressources"),l()(),w(26,Nd,14,12,"ng-container",17)(27,Ld,3,0,"div",18),l(),s(28,"div",19)(29,"div",20),w(30,zd,5,4,"div",21),l(),w(31,Jd,4,2,"ng-container",17)(32,Yd,3,0,"div",22),l()(),w(33,Qd,14,14,"div",23),l(),w(34,rp,23,5,"div",24)),t&2&&(c(17),k("ngModel",o.showDaysInCells),c(9),g("ngForOf",o.teamRows),c(),g("ngIf",o.teamRows.length===0),c(3),g("ngForOf",o.displayedWeeks),c(),g("ngForOf",o.teamRows),c(),g("ngIf",o.teamRows.length===0),c(),g("ngIf",o.selectedCells.length>0&&o.isSelectionFinished),c(),g("ngIf",o.showAddResourceModal))},dependencies:[G,Oe,te,X,qe,Ue,ie,Pt,di,Fe,oe,Zt,re,ap,ne,ii],styles:['.capacity-container[_ngcontent-%COMP%]{padding:20px;background:#f5f7fa;min-height:100vh;display:flex;flex-direction:column;overflow-x:hidden}.capacity-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}.header-actions[_ngcontent-%COMP%]{display:flex;gap:12px}.calendar-controls[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;padding:16px;background:#fff;border-radius:8px;box-shadow:0 1px 3px #0000001a}.date-navigation[_ngcontent-%COMP%]{display:flex;gap:8px}.calendar-wrapper[_ngcontent-%COMP%]{display:flex;background:#fff;border-radius:8px;box-shadow:0 1px 3px #0000001a;overflow:hidden;max-height:calc(100vh - 200px);position:relative}.labels-column[_ngcontent-%COMP%]{width:300px;flex-shrink:0;border-right:2px solid #e2e8f0;overflow-y:auto;overflow-x:hidden}.labels-header[_ngcontent-%COMP%]{padding:12px 16px;background:#f8fafc;border-bottom:2px solid #e2e8f0;font-weight:600;position:sticky;top:0;z-index:10;min-height:60px;display:flex;align-items:center}.team-label-row[_ngcontent-%COMP%]{background:#f9fafb;border-bottom:1px solid #e2e8f0}.resource-label-row[_ngcontent-%COMP%]{background:#fff;border-bottom:1px solid #e2e8f0}.row-label-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;width:100%;height:100%;cursor:pointer;padding:0 12px;position:relative;min-height:48px}.row-info-stack-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;flex:1;overflow:hidden}.color-bar-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:12px}.color-bar-v[_ngcontent-%COMP%]{width:6px;height:32px;border-radius:3px;flex-shrink:0}.info-stack[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1px;overflow:hidden}.info-code[_ngcontent-%COMP%]{font-family:JetBrains Mono,Cascadia Code,monospace;font-size:10px;font-weight:600;color:#94a3b8;letter-spacing:.5px;text-transform:uppercase;white-space:nowrap}.info-label[_ngcontent-%COMP%]{font-size:13px;font-weight:700;color:#1e293b;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.row-label-content[_ngcontent-%COMP%]:hover{background:#f3f4f6}.row-label-content.resource-row[_ngcontent-%COMP%]{padding-left:40px}.btn-hover-add[_ngcontent-%COMP%]{margin-left:auto;padding:4px 10px;font-size:11px;font-weight:600;background:#fff;color:#6366f1;border:1px solid #e0e7ff;border-radius:6px;display:flex;align-items:center;gap:4px;cursor:pointer;opacity:0;position:absolute;right:12px;box-shadow:0 1px 2px #0000000d}.row-label-content[_ngcontent-%COMP%]:hover   .btn-hover-add[_ngcontent-%COMP%]{opacity:1}.btn-hover-add[_ngcontent-%COMP%]:hover{background:#f5f7ff;border-color:#6366f1;color:#4f46e5}.btn-hover-delete[_ngcontent-%COMP%]{background:transparent;border:none;color:#ef4444;cursor:pointer;padding:4px 8px;border-radius:4px;display:flex;align-items:center;justify-content:center;font-size:18px;font-weight:700;opacity:0;position:absolute;right:12px}.row-label-content[_ngcontent-%COMP%]:hover   .btn-hover-delete[_ngcontent-%COMP%]{opacity:1}.btn-hover-delete[_ngcontent-%COMP%]:hover{background-color:#fee2e2;color:#b91c1c}.px-0[_ngcontent-%COMP%]{padding-left:0!important;padding-right:0!important}.empty-state-label[_ngcontent-%COMP%]{padding:40px 20px;text-align:center;color:#6b7280}.weeks-column[_ngcontent-%COMP%]{flex:1;overflow-x:auto;overflow-y:auto}.weeks-header[_ngcontent-%COMP%]{display:flex;background:#f8fafc;border-bottom:2px solid #e2e8f0;position:sticky;top:0;z-index:10;min-height:60px}.week-header[_ngcontent-%COMP%]{min-width:80px;width:80px;padding:8px;text-align:center;border-right:1px solid #e2e8f0;font-size:12px;display:flex;flex-direction:column;justify-content:center;flex-shrink:0}.week-header.current-week[_ngcontent-%COMP%]{background:#dbeafe;border-left:2px solid #3b82f6;border-right:2px solid #3b82f6}.week-date[_ngcontent-%COMP%]{font-weight:600;margin-bottom:4px}.week-number[_ngcontent-%COMP%]{font-size:11px;color:#6b7280}.team-weeks-row[_ngcontent-%COMP%]{display:flex;border-bottom:1px solid #e2e8f0;background:#f9fafb;min-height:48px}.resource-weeks-row[_ngcontent-%COMP%]{display:flex;border-bottom:1px solid #e2e8f0;background:#fff;min-height:48px;-webkit-user-select:none;user-select:none}.resource-weeks-row[_ngcontent-%COMP%]:hover{background:#f9fafb}.week-cell[_ngcontent-%COMP%]{min-width:80px;width:80px;padding:8px;border-right:1px solid #e2e8f0;text-align:center;display:flex;align-items:center;justify-content:center;flex-shrink:0}.team-cell[_ngcontent-%COMP%]{background:#f9fafb}.resource-cell[_ngcontent-%COMP%]{cursor:pointer;transition:background .15s ease;position:relative}.resource-cell[_ngcontent-%COMP%]:hover{background:#f3f4f6}.resource-cell.selected[_ngcontent-%COMP%]{background:#dbeafe;border:2px solid #3b82f6}.resource-cell.has-capacity[_ngcontent-%COMP%]{background:#d1fae5;font-weight:600;color:#059669}.resource-cell.has-capacity.selected[_ngcontent-%COMP%]{background:#a7f3d0;border:2px solid #3b82f6}.cell-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;line-height:1.1}.capacity-value[_ngcontent-%COMP%]{font-size:13px;font-weight:600}.days-value[_ngcontent-%COMP%]{font-size:10px;opacity:.9}.team-summary[_ngcontent-%COMP%]{color:#6b7280;display:flex;flex-direction:column;align-items:center;justify-content:center;line-height:1.1}.empty-state-weeks[_ngcontent-%COMP%]{padding:40px;text-align:center;color:#6b7280}.selection-toolbar[_ngcontent-%COMP%]{position:fixed;background:#fff;padding:16px 24px;border-radius:12px;box-shadow:0 10px 25px #0003;align-items:center;gap:16px;z-index:1000;transition:top .2s ease,left .2s ease;min-width:260px}.selection-info[_ngcontent-%COMP%]{font-weight:600;color:#374151}.selection-total[_ngcontent-%COMP%]{font-weight:500;font-size:13px;margin-top:6px;margin-bottom:10px;color:#065f46}.selection-input-row[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{flex:1;display:flex;gap:8px;align-items:center;margin-bottom:12px;width:100%}.selection-actions[_ngcontent-%COMP%]{display:flex;flex:1;gap:8px;align-items:center;justify-content:center}.selection-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1}.bulk-input[_ngcontent-%COMP%]{width:150px;padding:6px 12px;border:1px solid #d1d5db;border-radius:6px}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:2000}.modal[_ngcontent-%COMP%]{background:#fff;border-radius:12px;min-width:500px;max-width:90vw;max-height:90vh;overflow:auto}.modal-header[_ngcontent-%COMP%]{padding:20px 24px;border-bottom:1px solid #e2e8f0;display:flex;justify-content:space-between;align-items:center}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:18px}.resource-type-icon[_ngcontent-%COMP%]{font-size:16px}.resource-icon-wrapper[_ngcontent-%COMP%]{width:24px;height:24px;border-radius:6px;display:flex;align-items:center;justify-content:center;flex-shrink:0;color:#fff}.resource-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.resource-name[_ngcontent-%COMP%]{flex:1;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;font-size:14px;color:#334155}.modal-close[_ngcontent-%COMP%]{background:none;border:none;font-size:24px;cursor:pointer;color:#6b7280;padding:0;width:32px;height:32px;display:flex;align-items:center;justify-content:center;border-radius:4px}.modal-close[_ngcontent-%COMP%]:hover{background:#f3f4f6}.modal-body[_ngcontent-%COMP%]{padding:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:16px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-weight:500;color:#374151}.form-control[_ngcontent-%COMP%]{width:100%;padding:8px 12px;border:1px solid #d1d5db;border-radius:6px;font-size:14px}.no-roles-message[_ngcontent-%COMP%]{padding:9px;background:#fef3c7;border:1px solid #f59e0b;border-radius:6px;color:#92400e;text-align:center}.no-roles-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px}.modal-actions[_ngcontent-%COMP%]{display:flex;gap:12px;margin-top:24px}.ios-switch[_ngcontent-%COMP%]{position:relative;display:inline-block;width:40px;height:20px;vertical-align:middle}.ios-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0;position:absolute;left:0;top:0}.ios-slider[_ngcontent-%COMP%]{position:absolute;cursor:pointer;inset:0;background-color:#e5e7eb;border-radius:999px;transition:background-color .18s ease;box-shadow:inset 0 0 0 1px #00000008}.ios-slider[_ngcontent-%COMP%]:before{content:"";position:absolute;height:14px;width:14px;left:3px;top:3px;background:#fff;border-radius:50%;transition:transform .22s cubic-bezier(.2,.8,.2,1),box-shadow .12s ease;box-shadow:0 1px 2px #0000002e}.ios-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .ios-slider[_ngcontent-%COMP%]{background-color:#34d399}.ios-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:checked + .ios-slider[_ngcontent-%COMP%]:before{transform:translate(20px)}.ios-switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus + .ios-slider[_ngcontent-%COMP%]{box-shadow:0 0 0 4px #3b82f61f}']});let i=r;return i})();var Bi=(()=>{let r=class r{constructor(e){this.supabase=e,this._servicesCache=null}clearCache(){this._servicesCache=null}getAllServices(){return _(this,null,function*(){if(this._servicesCache)return this._servicesCache;let{data:e,error:t}=yield this.supabase.client.from("services").select("*").order("nom",{ascending:!0});if(t)throw t;return this._servicesCache=e||[],this._servicesCache})}getIdByServiceId(e){return _(this,null,function*(){return(yield this.getAllServices()).find(a=>a.id_service===e)?.id||null})}getServiceByServiceId(e){return _(this,null,function*(){return(yield this.getAllServices()).find(o=>o.id_service===e)||null})}getServiceIdById(e){return _(this,null,function*(){return(yield this.getAllServices()).find(a=>a.id===e)?.id_service||null})}getService(e){return _(this,null,function*(){if(this._servicesCache){let a=this._servicesCache.find(d=>d.id===e);if(a)return a}let{data:t,error:o}=yield this.supabase.client.from("services").select("*").eq("id",e).maybeSingle();if(o)throw o;return t})}createService(e){return _(this,null,function*(){let{data:t,error:o}=yield this.supabase.client.from("services").insert([e]).select().single();if(o)throw o;return this.clearCache(),t})}updateService(e,t){return _(this,null,function*(){let{data:o,error:a}=yield this.supabase.client.from("services").update(t).eq("id",e).select().single();if(a)throw a;return this.clearCache(),o})}deleteService(e){return _(this,null,function*(){let{error:t}=yield this.supabase.client.from("services").delete().eq("id",e);if(t)throw t;this.clearCache()})}};r.\u0275fac=function(t){return new(t||r)(V(H))},r.\u0275prov=A({token:r,factory:r.\u0275fac,providedIn:"root"});let i=r;return i})();var Hi=(()=>{let r=class r{constructor(e){this.supabase=e,this._personnesCache=null}clearCache(){this._personnesCache=null}getAllPersonnes(){return _(this,null,function*(){if(this._personnesCache)return this._personnesCache;let{data:e,error:t}=yield this.supabase.client.from("personnes").select("*").order("nom",{ascending:!0});if(t)throw t;return this._personnesCache=e||[],this._personnesCache})}getPersonne(e){return _(this,null,function*(){if(this._personnesCache){let a=this._personnesCache.find(d=>d.id===e);if(a)return a}let{data:t,error:o}=yield this.supabase.client.from("personnes").select("*").eq("id",e).maybeSingle();if(o)throw o;return t})}getServiceIdsByPersonneId(e){return _(this,null,function*(){let t=yield this.getPersonne(e);return t?{service_id:t.service_id||null,id_service:t.id_service||null}:{service_id:null,id_service:null}})}createPersonne(e){return _(this,null,function*(){let{data:t,error:o}=yield this.supabase.client.from("personnes").insert([e]).select().single();if(o)throw o;return this.clearCache(),t})}updatePersonne(e,t){return _(this,null,function*(){let{data:o,error:a}=yield this.supabase.client.from("personnes").update(t).eq("id",e).select().single();if(a)throw a;return this.clearCache(),o})}deletePersonne(e){return _(this,null,function*(){let{error:t}=yield this.supabase.client.from("personnes").delete().eq("id",e);if(t)throw t;this.clearCache()})}};r.\u0275fac=function(t){return new(t||r)(V(H))},r.\u0275prov=A({token:r,factory:r.\u0275fac,providedIn:"root"});let i=r;return i})();var Gi=(()=>{let r=class r{constructor(e,t){this.supabase=e,this.teamService=t,this._chargesCache=null}clearCache(){this._chargesCache=null}getAllCharges(){return _(this,null,function*(){if(this._chargesCache)return this._chargesCache;let{data:e,error:t}=yield this.supabase.client.from("charges").select("*").order("semaine_debut");if(t)throw t;return this._chargesCache=e||[],this._chargesCache})}getChargesByProject(e){return _(this,null,function*(){if(this._chargesCache)return this._chargesCache.filter(a=>a.projet_id===e);let{data:t,error:o}=yield this.supabase.client.from("charges").select("*").eq("projet_id",e).order("semaine_debut");if(o)throw o;return t||[]})}getChargesByTeam(e){return _(this,null,function*(){if(this._chargesCache)return this._chargesCache.filter(a=>a.equipe_id===e);let{data:t,error:o}=yield this.supabase.client.from("charges").select("*").eq("equipe_id",e).order("semaine_debut");if(o)throw o;return t||[]})}createChargeWithoutDates(e,t,o,a,d=1){return _(this,null,function*(){let m={projet_id:e,equipe_id:t,unite_ressource:d,semaine_debut:null,semaine_fin:null};o&&(m.role_id=o),a&&(m.personne_id=a);let{data:C,error:b}=yield this.supabase.client.from("charges").insert([m]).select().single();if(b)throw b;return this.clearCache(),C})}createOrUpdateCharge(e,t,o,a,d,m){return _(this,null,function*(){let C=this.supabase.client.from("charges").select("*").eq("projet_id",e).eq("equipe_id",t).eq("semaine_debut",o);d?C=C.eq("role_id",d):C=C.is("role_id",null),m?C=C.eq("personne_id",m):C=C.is("personne_id",null);let{data:b,error:x}=yield C;if(x)throw x;let M={projet_id:e,equipe_id:t,semaine_debut:o,semaine_fin:o,unite_ressource:a};if(d&&(M.role_id=d),m&&(M.personne_id=m),b&&b.length>0){let{data:D,error:Q}=yield this.supabase.client.from("charges").update({unite_ressource:a}).eq("id",b[0].id).select().single();if(Q)throw Q;return this.clearCache(),D}else{let{data:D,error:Q}=yield this.supabase.client.from("charges").insert([M]).select().single();if(Q)throw Q;return this.clearCache(),D}})}getAvailableRolesForProjectTeam(e,t){return _(this,null,function*(){let o=yield this.teamService.getAllRoles(),a=yield this.supabase.client.from("charges").select("role_id").eq("projet_id",e).eq("equipe_id",t);if(a.error)throw a.error;let d=new Set((a.data||[]).filter(m=>m.role_id).map(m=>m.role_id));return o.filter(m=>!d.has(m.id))})}getAvailablePersonnesForProjectTeam(e,t){return _(this,null,function*(){let o=yield this.teamService.getAllPersonnes(),a=yield this.supabase.client.from("charges").select("personne_id").eq("projet_id",e).eq("equipe_id",t);if(a.error)throw a.error;let d=new Set((a.data||[]).filter(m=>m.personne_id).map(m=>m.personne_id));return o.filter(m=>!d.has(m.id))})}getChargesByProjectIdAndDate(e,t){return _(this,null,function*(){let o=this.getFirstDayOfWeek(t),{data:a,error:d}=yield this.supabase.client.from("charges").select("*").eq("projet_id",e).gte("semaine_debut",o);if(d)throw d;return a||[]})}getFirstDayOfWeek(e){let t=new Date(e),o=new Date(t);return o.setDate(t.getDate()-t.getDay()+(t.getDay()===0?-6:1)),o.toISOString().split("T")[0]}};r.\u0275fac=function(t){return new(t||r)(V(H),V(Et))},r.\u0275prov=A({token:r,factory:r.\u0275fac,providedIn:"root"});let i=r;return i})();var at=(()=>{let r=class r{constructor(e){this.supabase=e,this._projetsCache=null,this._equipeProjetLinksCache=null}clearCache(){this._projetsCache=null,this._equipeProjetLinksCache=null}getAllProjets(){return _(this,null,function*(){if(this._projetsCache)return this._projetsCache;let{data:e,error:t}=yield this.supabase.client.from("projets").select("*").order("created_at",{ascending:!1});if(t)throw t;return this._projetsCache=e||[],this._projetsCache})}getProjet(e){return _(this,null,function*(){if(this._projetsCache){let a=this._projetsCache.find(d=>d.id===e)||null;if(a)return a}let{data:t,error:o}=yield this.supabase.client.from("projets").select("*").eq("id",e).maybeSingle();if(o)throw o;return t})}getProjetIdUUID(e){return _(this,null,function*(){if(this._projetsCache){let a=this._projetsCache.find(d=>d.id_projet===e)||null;if(a)return a.id}let{data:t,error:o}=yield this.supabase.client.from("projets").select("id").eq("id_projet",e).single();if(o)throw o;return t.id})}createProjet(e){return _(this,null,function*(){let{data:t,error:o}=yield this.supabase.client.from("projets").insert([e]).select().single();if(o)throw o;return this.clearCache(),t})}updateProjet(e,t){return _(this,null,function*(){let{data:o,error:a}=yield this.supabase.client.from("projets").update(ge(I({},t),{updated_at:new Date().toISOString()})).eq("id",e).select().single();if(a)throw a;return this.clearCache(),o})}deleteProjet(e){return _(this,null,function*(){let{error:t}=yield this.supabase.client.from("projets").delete().eq("id",e);if(t)throw t;this.clearCache()})}calculateRAF(e){return e.chiffrage_previsionnel-e.temps_consomme}getAllEquipeProjetLinks(){return _(this,null,function*(){if(this._equipeProjetLinksCache)return this._equipeProjetLinksCache;let{data:e,error:t}=yield this.supabase.client.from("equipes_projets").select("*");if(t)throw t;return this._equipeProjetLinksCache=e||[],this._equipeProjetLinksCache})}linkProjectToTeam(e,t){return _(this,null,function*(){let{error:o}=yield this.supabase.client.from("equipes_projets").insert({projet_id:e,equipe_id:t});if(o)throw o;this.clearCache()})}unlinkProjectFromTeam(e,t){return _(this,null,function*(){let{error:o}=yield this.supabase.client.from("equipes_projets").delete().eq("projet_id",e).eq("equipe_id",t);if(o)throw o;this.clearCache()})}};r.\u0275fac=function(t){return new(t||r)(V(H))},r.\u0275prov=A({token:r,factory:r.\u0275fac,providedIn:"root"});let i=r;return i})();var hs=(()=>{let r=class r{constructor(e,t,o,a,d,m){this.supabase=e,this.servicesService=t,this.rolesService=o,this.personnesService=a,this.chargeService=d,this.projetService=m,this._chiffresCache=null}clearCache(){this._chiffresCache=null}getAllChiffres(){return _(this,null,function*(){if(this._chiffresCache)return this._chiffresCache;let{data:e,error:t}=yield this.supabase.client.from("chiffres").select("*").order("date_mise_a_jour",{ascending:!1});if(t)throw t;return this._chiffresCache=e||[],this._chiffresCache})}getChiffresByProject(e){return _(this,null,function*(){if(this._chiffresCache)return this._chiffresCache.filter(a=>a.id_projet===e);let{data:t,error:o}=yield this.supabase.client.from("chiffres").select("*").eq("id_projet",e).order("id_service");if(o)throw o;return t||[]})}getChiffre(e,t){return _(this,null,function*(){let{data:o,error:a}=yield this.supabase.client.from("chiffres").select("*").eq("id_projet",e).eq("id_service",t).maybeSingle();if(a)throw a;return o})}createChiffre(e){return _(this,null,function*(){let{data:t,error:o}=yield this.supabase.client.from("chiffres").insert([{id_projet:e.id_projet,id_service:e.id_service,initial:e.initial||0,revise:e.revise||0,previsionnel:e.previsionnel||0,consomme:e.consomme||0,date_mise_a_jour:e.date_mise_a_jour||new Date().toISOString()}]).select().single();if(o)throw o;return this.clearCache(),t})}updateChiffre(e,t){return _(this,null,function*(){let o={};t.initial!==void 0&&(o.initial=t.initial),t.revise!==void 0&&(o.revise=t.revise),t.previsionnel!==void 0&&(o.previsionnel=t.previsionnel),t.consomme!==void 0&&(o.consomme=t.consomme),t.date_mise_a_jour!==void 0&&(o.date_mise_a_jour=t.date_mise_a_jour),o.updated_at=new Date().toISOString();let{data:a,error:d}=yield this.supabase.client.from("chiffres").update(o).eq("id_chiffres",e).select().single();if(d)throw d;return this.clearCache(),a})}deleteChiffre(e){return _(this,null,function*(){let{error:t}=yield this.supabase.client.from("chiffres").delete().eq("id_chiffres",e);if(t)throw t;this.clearCache()})}getRAFByDate(e,t,o){return _(this,null,function*(){let a=yield this.projetService.getProjetIdUUID(e),d=yield this.chargeService.getChargesByProjectIdAndDate(a,o);console.log(d);let m=[];for(let b of d){if(b.role_id&&(yield this.rolesService.getIdServiceListFromRoleId(b.role_id)).includes(t)){m.push(b);let M=yield this.rolesService.getRole(b.role_id);M&&(b.jours_par_semaine=M.jours_par_semaine)}if(b.personne_id&&(yield this.personnesService.getServiceIdsByPersonneId(b.personne_id)).id_service===t){m.push(b);let M=yield this.personnesService.getPersonne(b.personne_id);M&&(b.jours_par_semaine=M.jours_par_semaine)}}return console.log("filteredData : "+m),m.reduce((b,x)=>b+(x.unite_ressource||0)*(x.jours_par_semaine||0),0)})}};r.\u0275fac=function(t){return new(t||r)(V(H),V(Bi),V(gn),V(Hi),V(Gi),V(at))},r.\u0275prov=A({token:r,factory:r.\u0275fac,providedIn:"root"});let i=r;return i})();function lp(i,r){if(i&1&&(s(0,"div",24),p(1),l()),i&2){let n=u(2);c(),P(" ",n.error," ")}}function cp(i,r){i&1&&(s(0,"div",25)(1,"p")(2,"strong"),p(3,"Delta:"),l(),p(4," Pr\xE9visionnel - R\xE9vis\xE9"),l(),s(5,"p")(6,"strong"),p(7,"Restant:"),l(),p(8," Pr\xE9visionnel - Consomm\xE9"),l(),s(9,"p")(10,"strong"),p(11,"RAF:"),l(),p(12," Ressources affect\xE9es \xE0 partir de la date s\xE9lectionn\xE9e"),l(),s(13,"p")(14,"strong"),p(15,"Copier-coller:"),l(),p(16," Vous pouvez copier des cellules Excel (Initial, R\xE9vis\xE9, Pr\xE9visionnel, Consomm\xE9) et les coller pour remplir automatiquement. "),l()())}function dp(i,r){if(i&1){let n=S();s(0,"tr",26)(1,"td",27),p(2),l(),s(3,"td")(4,"input",28),T("ngModelChange",function(t){let o=f(n).$implicit,a=u(2);return E(a.getChiffresData(a.getNumericId(o)).initial,t)||(a.getChiffresData(a.getNumericId(o)).initial=t),h(t)}),v("change",function(){let t=f(n).$implicit,o=u(2);return h(o.onValueChange(o.getNumericId(t),"initial"))})("paste",function(t){let o=f(n).$implicit,a=u(2);return h(a.handlePaste(t,a.getNumericId(o),"initial"))}),l()(),s(5,"td")(6,"input",28),T("ngModelChange",function(t){let o=f(n).$implicit,a=u(2);return E(a.getChiffresData(a.getNumericId(o)).revise,t)||(a.getChiffresData(a.getNumericId(o)).revise=t),h(t)}),v("change",function(){let t=f(n).$implicit,o=u(2);return h(o.onValueChange(o.getNumericId(t),"revise"))})("paste",function(t){let o=f(n).$implicit,a=u(2);return h(a.handlePaste(t,a.getNumericId(o),"revise"))}),l()(),s(7,"td")(8,"input",28),T("ngModelChange",function(t){let o=f(n).$implicit,a=u(2);return E(a.getChiffresData(a.getNumericId(o)).previsionnel,t)||(a.getChiffresData(a.getNumericId(o)).previsionnel=t),h(t)}),v("change",function(){let t=f(n).$implicit,o=u(2);return h(o.onValueChange(o.getNumericId(t),"previsionnel"))})("paste",function(t){let o=f(n).$implicit,a=u(2);return h(a.handlePaste(t,a.getNumericId(o),"previsionnel"))}),l()(),s(9,"td")(10,"input",28),T("ngModelChange",function(t){let o=f(n).$implicit,a=u(2);return E(a.getChiffresData(a.getNumericId(o)).consomme,t)||(a.getChiffresData(a.getNumericId(o)).consomme=t),h(t)}),v("change",function(){let t=f(n).$implicit,o=u(2);return h(o.onValueChange(o.getNumericId(t),"consomme"))})("paste",function(t){let o=f(n).$implicit,a=u(2);return h(a.handlePaste(t,a.getNumericId(o),"consomme"))}),l()(),s(11,"td",29),p(12),l(),s(13,"td",29),p(14),l(),s(15,"td",29),p(16),l(),s(17,"td")(18,"input",30),T("ngModelChange",function(t){let o=f(n).$implicit,a=u(2);return E(a.getChiffresData(a.getNumericId(o)).date_mise_a_jour,t)||(a.getChiffresData(a.getNumericId(o)).date_mise_a_jour=t),h(t)}),l()()()}if(i&2){let n,e,t,o=r.$implicit,a=u(2);c(2),P(" ",o.nom," "),c(2),k("ngModel",a.getChiffresData(a.getNumericId(o)).initial),c(2),k("ngModel",a.getChiffresData(a.getNumericId(o)).revise),c(2),k("ngModel",a.getChiffresData(a.getNumericId(o)).previsionnel),c(2),k("ngModel",a.getChiffresData(a.getNumericId(o)).consomme),c(2),P(" ",((n=a.getChiffresData(a.getNumericId(o)).delta)==null?null:n.toFixed(3))||"0.000"," "),c(2),P(" ",((e=a.getChiffresData(a.getNumericId(o)).restant)==null?null:e.toFixed(3))||"0.000"," "),c(2),P(" ",((t=a.getChiffresData(a.getNumericId(o)).raf)==null?null:t.toFixed(3))||"0.000"," "),c(2),k("ngModel",a.getChiffresData(a.getNumericId(o)).date_mise_a_jour)}}function pp(i,r){if(i&1){let n=S();s(0,"div",1),v("click",function(){f(n);let t=u();return h(t.onClose())}),s(1,"div",2),v("click",function(t){return f(n),h(t.stopPropagation())}),s(2,"div",3)(3,"h2"),p(4,"Chiffrage par service"),l(),s(5,"button",4),v("click",function(){f(n);let t=u();return h(t.onClose())}),p(6,"\xD7"),l()(),w(7,lp,2,1,"div",5),s(8,"div",6)(9,"div",7)(10,"div",8)(11,"label",9),p(12,"RAF au"),l(),s(13,"input",10),T("ngModelChange",function(t){f(n);let o=u();return E(o.rafDate,t)||(o.rafDate=t),h(t)}),v("change",function(){f(n);let t=u();return h(t.onRAFDateChange())}),l()(),s(14,"button",11),v("click",function(){f(n);let t=u();return h(t.showHelp=!t.showHelp)}),y(15,"lucide-icon",12),l()(),s(16,"div",13),w(17,cp,17,0,"div",14),l(),s(18,"div",15)(19,"table",16)(20,"thead")(21,"tr")(22,"th"),p(23,"SERVICE"),l(),s(24,"th"),p(25,"INITIAL"),l(),s(26,"th"),p(27,"R\xC9VIS\xC9"),l(),s(28,"th"),p(29,"PR\xC9VISIONNEL"),l(),s(30,"th"),p(31,"CONSOMM\xC9"),l(),s(32,"th"),p(33,"DELTA"),l(),s(34,"th"),p(35,"RESTANT"),l(),s(36,"th"),p(37,"RAF"),l(),s(38,"th"),p(39,"DATE MAJ"),l()()(),s(40,"tbody"),w(41,dp,19,9,"tr",17),l(),s(42,"tfoot")(43,"tr",18)(44,"td",19),p(45,"TOTAL"),l(),s(46,"td",20),p(47),l(),s(48,"td",20),p(49),l(),s(50,"td",20),p(51),l(),s(52,"td",20),p(53),l(),s(54,"td",20),p(55),l(),s(56,"td",20),p(57),l(),s(58,"td",20),p(59),l(),y(60,"td"),l()()()()(),s(61,"div",21)(62,"button",22),v("click",function(){f(n);let t=u();return h(t.onClose())}),p(63,"Annuler"),l(),s(64,"button",23),v("click",function(){f(n);let t=u();return h(t.save())}),p(65),l()()()()}if(i&2){let n=u();c(7),g("ngIf",n.error),c(6),k("ngModel",n.rafDate),c(2),g("name",n.LucideHelpCircle),c(2),g("ngIf",n.showHelp),c(24),g("ngForOf",n.services),c(6),P(" ",n.calculateTotal("initial")," "),c(2),P(" ",n.calculateTotal("revise")," "),c(2),P(" ",n.calculateTotal("previsionnel")," "),c(2),P(" ",n.calculateTotal("consomme")," "),c(2),P(" ",n.calculateTotal("delta")," "),c(2),P(" ",n.calculateTotal("restant")," "),c(2),P(" ",n.calculateTotal("raf")," "),c(3),g("disabled",n.isLoading),c(2),g("disabled",n.isLoading),c(),P(" ",n.isLoading?"Enregistrement...":"Enregistrer"," ")}}var _s=(()=>{let r=class r{constructor(e,t){this.chiffresService=e,this.resourceService=t,this.visible=!1,this.idProjet=null,this.close=new xe,this.saved=new xe,this.LucideCalculator=ri,this.LucideHelpCircle=Yr,this.services=[],this.chiffres=new Map,this.rafDate=new Date().toISOString().split("T")[0],this.isLoading=!1,this.showHelp=!1,this.error=""}ngOnInit(){this.loadServices()}ngOnChanges(e){e.visible&&e.visible.currentValue&&this.idProjet&&(console.log("Loading chiffres for project:",this.idProjet),this.loadChiffres())}loadServices(){return _(this,null,function*(){try{this.services=yield this.resourceService.getAllServices()}catch(e){console.error("Error loading services:",e),this.error="Erreur lors du chargement des services"}})}loadChiffres(){return _(this,null,function*(){if(this.idProjet)try{this.isLoading=!0;let e=yield this.chiffresService.getChiffresByProject(this.idProjet);this.chiffres.clear();for(let t of this.services){let o=e.find(d=>d.id_service===t.id_service),a={id_chiffres:o?.id_chiffres,id_service:o?.id_service,initial:o?.initial||void 0,revise:o?.revise||void 0,previsionnel:o?.previsionnel||void 0,consomme:o?.consomme||void 0,date_mise_a_jour:o?.date_mise_a_jour?o.date_mise_a_jour.split("T")[0]:new Date().toISOString().split("T")[0]};this.updateCalculatedFields(a),t.id_service!==void 0&&t.id_service!==null?this.chiffres.set(t.id_service,a):console.error("Le service n'a pas d'id_service !")}for(let t of this.chiffres.keys())this.updateRAF(t);this.isLoading=!1}catch(e){this.error="Erreur lors du chargement des chiffres",this.isLoading=!1,console.error(e)}})}getChiffresData(e){let t=this.chiffres.get(e);return t||{id_service:e,initial:0,revise:0,previsionnel:0,consomme:0,date_mise_a_jour:new Date().toISOString().split("T")[0],delta:0,restant:0,raf:0,raf_date:new Date().toISOString().split("T")[0]}}getServiceName(e){return this.services.find(t=>t.id===e.toString())?.nom||`Service ${e}`}getNumericId(e){return e?e.id_service||0:(console.error("Le service est undefined !"),0)}calculateTotal(e){let t=0;for(let o of this.chiffres.values()){let a=o[e];typeof a=="number"&&(t+=a)}return t.toFixed(3)}updateCalculatedFields(e){e.previsionnel!==void 0&&e.revise!==void 0&&(e.delta=e.previsionnel-e.revise),e.previsionnel!==void 0&&e.consomme!==void 0&&(e.restant=e.previsionnel-e.consomme)}updateRAF(e){return _(this,null,function*(){if(this.idProjet)try{let t=yield this.chiffresService.getRAFByDate(this.idProjet,e,this.rafDate+"T00:00:00"),o=this.chiffres.get(e);o&&(o.raf=t,o.raf_date=this.rafDate)}catch(t){console.error("Error calculating RAF:",t)}})}onValueChange(e,t){let o=this.chiffres.get(e);o&&this.updateCalculatedFields(o)}onRAFDateChange(){for(let e of this.chiffres.keys())this.updateRAF(e)}handlePaste(e,t,o){return _(this,null,function*(){e.preventDefault();let d=(e.clipboardData?.getData("text")||"").trim().split(`
`),m=["initial","revise","previsionnel","consomme"];console.log("fieldName",o);let C=o?m.indexOf(o):0;if(console.log("startFieldIndex",C),C!==-1){if(d.length===1){let b=d[0].split("	").map(x=>x.trim());this.fillRowWithValues(t,b,C)}else if(d.length>1){let b=this.services.findIndex(x=>this.getNumericId(x)===t);d.forEach((x,M)=>{let D=x.split("	").map(Q=>Q.trim());if(b+M<this.services.length){let Q=this.getNumericId(this.services[b+M]),ae=C;this.fillRowWithValues(Q,D,ae)}})}}})}fillRowWithValues(e,t,o){let a=this.getChiffresData(e);if(!a)return;let d=["initial","revise","previsionnel","consomme"];t.forEach((m,C)=>{let b=o+C;if(b<d.length&&m){let x=d[b],M=parseFloat(m.replace(",","."));if(!isNaN(M)){let D=d[b];a[D]=M,(D==="initial"||D==="revise"||D==="previsionnel"||D==="consomme")&&(a[D]=M)}}}),this.onValueChange(e,d[o])}parseNumber(e){let t=parseFloat(e.trim().replace(",","."));return isNaN(t)?0:t}save(){return _(this,null,function*(){if(this.idProjet)try{this.isLoading=!0;let e=[];for(let[t,o]of this.chiffres.entries()){let a={id_projet:this.idProjet,id_service:t,initial:o.initial||0,revise:o.revise||0,previsionnel:o.previsionnel||0,consomme:o.consomme||0,date_mise_a_jour:o.date_mise_a_jour};if(o.id_chiffres){let d=yield this.chiffresService.updateChiffre(o.id_chiffres,a);e.push(d)}else if(o.initial||o.revise||o.previsionnel||o.consomme){let d=yield this.chiffresService.createChiffre(a);e.push(d)}}this.isLoading=!1,this.saved.emit(e),this.onClose()}catch(e){this.error="Erreur lors de la sauvegarde des chiffres",this.isLoading=!1,console.error(e)}})}onClose(){this.error="",this.close.emit()}};r.\u0275fac=function(t){return new(t||r)(R(hs),R(un))},r.\u0275cmp=B({type:r,selectors:[["app-chiffres-modal"]],inputs:{visible:"visible",idProjet:"idProjet"},outputs:{close:"close",saved:"saved"},features:[dt],decls:1,vars:1,consts:[["class","modal-overlay",3,"click",4,"ngIf"],[1,"modal-overlay",3,"click"],[1,"modal",3,"click"],[1,"modal-header"],[1,"modal-close",3,"click"],["class","error-message",4,"ngIf"],[1,"modal-content"],[1,"raf-date-section"],[1,"raf-date-group"],["for","rafDate"],["type","date","id","rafDate",1,"raf-date-input",3,"ngModelChange","change","ngModel"],["type","button","title","Besoin d'aide ?",1,"help-toggle",3,"click"],["size","20",3,"name"],[1,"help-container"],["class","help-text",4,"ngIf"],[1,"table-container"],[1,"chiffres-table"],["class","service-row",4,"ngFor","ngForOf"],[1,"total-row"],[1,"total-label"],[1,"total-value"],[1,"modal-actions"],["type","button",1,"btn","btn-secondary",3,"click","disabled"],["type","button",1,"btn","btn-primary",3,"click","disabled"],[1,"error-message"],[1,"help-text"],[1,"service-row"],[1,"service-name"],["type","number","placeholder","0",1,"input-field",3,"ngModelChange","change","paste","ngModel"],[1,"calculated-field"],["type","date",1,"input-field",3,"ngModelChange","ngModel"]],template:function(t,o){t&1&&w(0,pp,66,15,"div",0),t&2&&g("ngIf",o.visible)},dependencies:[G,Oe,te,X,ie,Pt,oe,re,K,ne],styles:[".modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background-color:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000}.modal[_ngcontent-%COMP%]{background-color:#fff;border-radius:8px;box-shadow:0 4px 12px #00000026;max-width:90vw;max-height:90vh;width:1400px;display:flex;flex-direction:column;overflow:hidden}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:20px;border-bottom:1px solid #e0e0e0;background-color:#f5f5f5}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:20px;font-weight:600;color:#333}.modal-close[_ngcontent-%COMP%]{background:none;border:none;font-size:28px;cursor:pointer;color:#666;padding:0;width:32px;height:32px;display:flex;align-items:center;justify-content:center}.modal-close[_ngcontent-%COMP%]:hover{color:#000;background-color:#e0e0e0;border-radius:4px}.error-message[_ngcontent-%COMP%]{background-color:#ffebee;border-left:4px solid #f44336;color:#c62828;padding:12px 16px;margin:16px;border-radius:4px}.modal-content[_ngcontent-%COMP%]{flex:1;overflow-y:auto;padding:20px}.raf-date-section[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center;margin-bottom:24px;padding:16px;background-color:#f9f9f9;border-radius:6px;justify-content:space-between}.raf-date-group[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center}.raf-date-section[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;color:#333;margin:0}.raf-date-input[_ngcontent-%COMP%]{padding:8px 12px;border:1px solid #ddd;border-radius:4px;font-size:14px;min-width:140px}.raf-date-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#6366f1;box-shadow:0 0 0 3px #6366f11a}.table-container[_ngcontent-%COMP%]{overflow-x:auto;border:1px solid #e0e0e0;border-radius:6px;margin-bottom:20px}.chiffres-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse;font-size:14px}.chiffres-table[_ngcontent-%COMP%]   thead[_ngcontent-%COMP%]{background-color:#f5f5f5;border-bottom:2px solid #ddd;position:sticky;top:0}.chiffres-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:12px;text-align:left;font-weight:600;color:#333;white-space:nowrap;border-right:1px solid #e0e0e0}.chiffres-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]:last-child{border-right:none}.chiffres-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]{border-bottom:1px solid #e0e0e0;transition:background-color .2s}.chiffres-table[_ngcontent-%COMP%]   tbody[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background-color:#f9f9f9}.chiffres-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px;border-right:1px solid #e0e0e0}.chiffres-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]:last-child{border-right:none}.service-name[_ngcontent-%COMP%]{font-weight:500;color:#333;min-width:180px}.input-field[_ngcontent-%COMP%]{width:100%;padding:8px;border:1px solid #ddd;border-radius:4px;font-size:13px;font-family:Courier New,monospace;text-align:right;min-width:100px}.input-field[_ngcontent-%COMP%]:focus{outline:none;border-color:#6366f1;box-shadow:0 0 0 3px #6366f11a}.input-field[disabled][_ngcontent-%COMP%]{background-color:#f5f5f5;color:#999;cursor:not-allowed}.calculated-field[_ngcontent-%COMP%]{text-align:right;background-color:#f9f9f9;font-family:Courier New,monospace;color:#666;font-weight:500;min-width:100px}.help-toggle[_ngcontent-%COMP%]{background:none;border:none;color:#6366f1;cursor:pointer;display:flex;align-items:center;justify-content:center;padding:8px;border-radius:50%;transition:all .2s;background-color:#fff;border:1px solid #e0e0e0}.help-toggle[_ngcontent-%COMP%]:hover{background-color:#f0f1ff;color:#4f46e5;border-color:#6366f1;transform:scale(1.1)}.total-row[_ngcontent-%COMP%]{background-color:#f0f0f0;font-weight:600;border-top:2px solid #ddd;border-bottom:2px solid #ddd}.total-label[_ngcontent-%COMP%]{color:#333;font-weight:600}.total-value[_ngcontent-%COMP%]{text-align:right;background-color:#e8e8e8;font-family:Courier New,monospace;color:#000}.help-text[_ngcontent-%COMP%]{background-color:#e3f2fd;border-left:4px solid #2196f3;padding:16px;border-radius:4px;margin-top:20px}.help-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:4px 0;font-size:13px;color:#1565c0}.help-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:first-child{margin-top:0}.help-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:last-child{margin-bottom:0}.modal-actions[_ngcontent-%COMP%]{display:flex;gap:12px;justify-content:flex-end;padding:20px;border-top:1px solid #e0e0e0;background-color:#f5f5f5}.btn[_ngcontent-%COMP%]{padding:10px 24px;border:none;border-radius:6px;font-size:14px;font-weight:500;cursor:pointer;transition:all .2s;min-width:100px}.btn-primary[_ngcontent-%COMP%]{background-color:#6366f1;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover:not([disabled]){background-color:#4f46e5;box-shadow:0 2px 8px #6366f14d}.btn-primary[disabled][_ngcontent-%COMP%]{background-color:#c7c9e5;cursor:not-allowed}.btn-secondary[_ngcontent-%COMP%]{background-color:#e0e0e0;color:#333}.btn-secondary[_ngcontent-%COMP%]:hover:not([disabled]){background-color:#d0d0d0}.btn-secondary[disabled][_ngcontent-%COMP%]{cursor:not-allowed;opacity:.6}@media (max-width: 1400px){.modal[_ngcontent-%COMP%]{width:calc(100vw - 40px);max-width:none}}@media (max-width: 768px){.modal[_ngcontent-%COMP%]{width:calc(100vw - 20px);max-height:95vh}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{font-size:18px}.chiffres-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%], .chiffres-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:8px;font-size:12px}.service-name[_ngcontent-%COMP%]{min-width:120px}.input-field[_ngcontent-%COMP%]{min-width:70px;padding:6px}}"]});let i=r;return i})();function up(i,r){if(i&1){let n=S();be(0),s(1,"a",59),v("click",function(t){return f(n),h(t.stopPropagation())}),p(2),y(3,"lucide-icon",45),l(),we()}if(i&2){let n=u(2).$implicit,e=u(2);c(),g("href",e.externalReferenceUrl+n.reference_externe,mo),c(),P(" #",n.reference_externe," "),c(),g("img",e.ExternalLink)("size",12)}}function mp(i,r){if(i&1&&p(0),i&2){let n=u(2).$implicit;P(" #",n.reference_externe," ")}}function gp(i,r){if(i&1&&(s(0,"span",57),w(1,up,4,4,"ng-container",58)(2,mp,1,1,"ng-template",null,0,xn),l()),i&2){let n=Ht(3),e=u(3);c(),g("ngIf",e.externalReferenceUrl)("ngIfElse",n)}}function fp(i,r){if(i&1){let n=S();s(0,"div",60)(1,"button",61),v("click",function(){f(n);let t=u().$implicit,o=u(2);return h(o.openEditModal(t))}),y(2,"lucide-icon",45),p(3," Modifier "),l(),s(4,"button",61),v("click",function(){f(n);let t=u().$implicit,o=u(2);return h(o.openChiffresModal(t.id_projet))}),y(5,"lucide-icon",45),p(6," G\xE9rer les chiffres "),l(),s(7,"button",61),v("click",function(){f(n);let t=u().$implicit,o=u(2);return h(o.duplicateProjet(t))}),y(8,"lucide-icon",45),p(9," Dupliquer "),l(),s(10,"button",62),v("click",function(){f(n);let t=u().$implicit,o=u(2);return h(o.deleteProjet(t))}),y(11,"lucide-icon",45),p(12," Supprimer "),l()()}if(i&2){let n=u(3);c(2),g("img",n.Edit)("size",14),c(3),g("img",n.LucideCalculator)("size",14),c(3),g("img",n.Copy)("size",14),c(3),g("img",n.Trash2)("size",14)}}function hp(i,r){if(i&1&&(s(0,"p",63)(1,"span",64),p(2,"Chef de projet:"),l(),p(3),l()),i&2){let n=u().$implicit;c(3),P(" ",n.chef_projet," ")}}function _p(i,r){if(i&1&&(s(0,"p",65),p(1),l()),i&2){let n=u().$implicit;c(),O(n.description)}}function vp(i,r){if(i&1){let n=S();s(0,"div",35),v("click",function(){let t=f(n).$implicit,o=u(2);return h(o.openEditModal(t))}),s(1,"div",36)(2,"div",37)(3,"div",38)(4,"span",39),p(5),l(),w(6,gp,4,2,"span",40),l(),s(7,"div",41)(8,"span",42),p(9),l(),s(10,"div",43),v("click",function(t){return f(n),h(t.stopPropagation())}),s(11,"button",44),v("click",function(t){let o=f(n).$implicit,a=u(2);return h(a.toggleMenu(t,o.id))}),y(12,"lucide-icon",45),l(),w(13,fp,13,8,"div",46),l()()()(),s(14,"div",47)(15,"h3",48),p(16),l(),w(17,hp,4,1,"p",49)(18,_p,2,1,"p",50),s(19,"div",51)(20,"div",52)(21,"span",53),p(22,"Progression"),l(),s(23,"span",54),p(24),l()(),s(25,"div",55),y(26,"div",56),l()()()()}if(i&2){let n=r.$implicit,e=u(2);z("border-left-color",n.color||"#3b82f6"),$("menu-active",e.activeMenuId===n.id),c(4),z("color",n.color||"#3b82f6"),c(),O(n.code_projet),c(),g("ngIf",n.reference_externe),c(2),_e("data-status",n.statut),c(),O(n.statut),c(3),g("img",e.MoreVertical)("size",20),c(),g("ngIf",e.activeMenuId===n.id),c(3),O(n.nom_projet),c(),g("ngIf",n.chef_projet),c(),g("ngIf",n.description),c(6),P("",e.getProgressPercent(n),"%"),c(2),z("width",e.getProgressPercent(n),"%"),$("warning",e.getProgressPercent(n)>80&&e.getProgressPercent(n)<=100)("danger",e.getProgressPercent(n)>100)}}function Cp(i,r){i&1&&(s(0,"div",66)(1,"p"),p(2,"Aucun projet trouv\xE9"),l()())}function xp(i,r){if(i&1&&(s(0,"div",32),w(1,vp,27,23,"div",33)(2,Cp,3,0,"div",34),l()),i&2){let n=u();c(),g("ngForOf",n.filteredProjects),c(),g("ngIf",n.filteredProjects.length===0)}}function bp(i,r){if(i&1){let n=S();be(0),s(1,"a",59),v("click",function(t){return f(n),h(t.stopPropagation())}),p(2),y(3,"lucide-icon",45),l(),we()}if(i&2){let n=u(2).$implicit,e=u(2);c(),g("href",e.externalReferenceUrl+n.reference_externe,mo),c(),P(" #",n.reference_externe," "),c(),g("img",e.ExternalLink)("size",12)}}function wp(i,r){if(i&1&&p(0),i&2){let n=u(2).$implicit;P(" #",n.reference_externe," ")}}function yp(i,r){if(i&1&&(s(0,"span"),p(1," \u2022 "),s(2,"span",57),w(3,bp,4,4,"ng-container",58)(4,wp,1,1,"ng-template",null,1,xn),l()()),i&2){let n=Ht(5),e=u(3);c(3),g("ngIf",e.externalReferenceUrl)("ngIfElse",n)}}function Mp(i,r){if(i&1&&(s(0,"span"),p(1," \u2022 "),s(2,"span",78),p(3),l()()),i&2){let n=u().$implicit;c(3),O(n.chef_projet)}}function Pp(i,r){if(i&1){let n=S();s(0,"div",79)(1,"button",61),v("click",function(){f(n);let t=u().$implicit,o=u(2);return h(o.openEditModal(t))}),y(2,"lucide-icon",45),p(3," Modifier "),l(),s(4,"button",61),v("click",function(){f(n);let t=u().$implicit,o=u(2);return h(o.openChiffresModal(t.id_projet))}),y(5,"lucide-icon",45),p(6," G\xE9rer les chiffres "),l(),s(7,"button",61),v("click",function(){f(n);let t=u().$implicit,o=u(2);return h(o.duplicateProjet(t))}),y(8,"lucide-icon",45),p(9," Dupliquer "),l(),s(10,"button",62),v("click",function(){f(n);let t=u().$implicit,o=u(2);return h(o.deleteProjet(t))}),y(11,"lucide-icon",45),p(12," Supprimer "),l()()}if(i&2){let n=u(3);c(2),g("img",n.Edit)("size",14),c(3),g("img",n.LucideCalculator)("size",14),c(3),g("img",n.Copy)("size",14),c(3),g("img",n.Trash2)("size",14)}}function Sp(i,r){if(i&1){let n=S();s(0,"div",69),v("click",function(){let t=f(n).$implicit,o=u(2);return h(o.openEditModal(t))}),s(1,"div",70)(2,"div",71)(3,"div",72)(4,"span",48),p(5),l(),s(6,"span",73),p(7),l()(),s(8,"div",74)(9,"span",39),p(10),l(),w(11,yp,6,2,"span",75)(12,Mp,4,1,"span",75),l()()(),s(13,"div",76)(14,"div",43),v("click",function(t){return f(n),h(t.stopPropagation())}),s(15,"button",44),v("click",function(t){let o=f(n).$implicit,a=u(2);return h(a.toggleMenu(t,o.id))}),y(16,"lucide-icon",45),l(),w(17,Pp,13,8,"div",77),l()()()}if(i&2){let n=r.$implicit,e=u(2);z("border-left-color",n.color||"#3b82f6"),$("menu-active",e.activeMenuId===n.id),c(5),O(n.nom_projet),c(),_e("data-status",n.statut),c(),O(n.statut),c(3),O(n.code_projet),c(),g("ngIf",n.reference_externe),c(),g("ngIf",n.chef_projet),c(4),g("img",e.MoreVertical)("size",20),c(),g("ngIf",e.activeMenuId===n.id)}}function Op(i,r){i&1&&(s(0,"div",66)(1,"p"),p(2,"Aucun projet trouv\xE9"),l()())}function kp(i,r){if(i&1&&(s(0,"div",67),w(1,Sp,18,13,"div",68)(2,Op,3,0,"div",34),l()),i&2){let n=u();c(),g("ngForOf",n.filteredProjects),c(),g("ngIf",n.filteredProjects.length===0)}}function Ep(i,r){if(i&1){let n=S();s(0,"div",102),v("click",function(){let t=f(n).$implicit,o=u(2);return h(o.selectColor(t))}),l()}if(i&2){let n=r.$implicit,e=u(2);z("background-color",n),$("active",e.newProjet.color===n)}}function Tp(i,r){if(i&1&&y(0,"div",103),i&2){let n=u(2);z("background-color",n.newProjet.color)}}function Ip(i,r){if(i&1&&y(0,"lucide-icon",45),i&2){let n=u(2);g("img",n.Plus)("size",16)}}function jp(i,r){if(i&1){let n=S();s(0,"div",98)(1,"input",104),T("ngModelChange",function(t){f(n);let o=u(2);return E(o.newProjet.color,t)||(o.newProjet.color=t),h(t)}),l(),s(2,"input",105),T("ngModelChange",function(t){f(n);let o=u(2);return E(o.newProjet.color,t)||(o.newProjet.color=t),h(t)}),l()()}if(i&2){let n=u(2);c(),k("ngModel",n.newProjet.color),c(),k("ngModel",n.newProjet.color)}}function Rp(i,r){if(i&1){let n=S();s(0,"div",80),v("mousedown",function(t){f(n);let o=u();return h(o.onOverlayMouseDown(t))})("mouseup",function(t){f(n);let o=u();return h(o.onOverlayMouseUp(t))}),s(1,"div",81),v("click",function(t){return f(n),h(t.stopPropagation())}),s(2,"div",82)(3,"h2"),p(4),l(),s(5,"button",83),v("click",function(){f(n);let t=u();return h(t.closeModal())}),p(6,"\xD7"),l()(),s(7,"form",84),v("ngSubmit",function(){f(n);let t=u();return h(t.saveProjet())}),s(8,"div",85)(9,"div",86)(10,"label"),p(11,"Code Projet *"),l(),s(12,"input",87),T("ngModelChange",function(t){f(n);let o=u();return E(o.newProjet.code_projet,t)||(o.newProjet.code_projet=t),h(t)}),l()(),s(13,"div",86)(14,"label"),p(15,"R\xE9f\xE9rence Externe"),l(),s(16,"input",88),T("ngModelChange",function(t){f(n);let o=u();return E(o.newProjet.reference_externe,t)||(o.newProjet.reference_externe=t),h(t)}),l()()(),s(17,"div",89)(18,"label"),p(19,"Nom Projet *"),l(),s(20,"input",90),T("ngModelChange",function(t){f(n);let o=u();return E(o.newProjet.nom_projet,t)||(o.newProjet.nom_projet=t),h(t)}),l()(),s(21,"div",85)(22,"div",86)(23,"label"),p(24,"Statut"),l(),s(25,"select",91),T("ngModelChange",function(t){f(n);let o=u();return E(o.newProjet.statut,t)||(o.newProjet.statut=t),h(t)}),s(26,"option",13),p(27,"En cours"),l(),s(28,"option",14),p(29,"Planifi\xE9"),l(),s(30,"option",15),p(31,"Termin\xE9"),l(),s(32,"option",16),p(33,"En pause"),l(),s(34,"option",12),p(35,"Actif"),l()()(),s(36,"div",86)(37,"label"),p(38,"Chef de Projet"),l(),s(39,"input",92),T("ngModelChange",function(t){f(n);let o=u();return E(o.newProjet.chef_projet,t)||(o.newProjet.chef_projet=t),h(t)}),l()()(),s(40,"div",89)(41,"label"),p(42,"Description"),l(),s(43,"textarea",93),T("ngModelChange",function(t){f(n);let o=u();return E(o.newProjet.description,t)||(o.newProjet.description=t),h(t)}),l()(),s(44,"div",89)(45,"label"),p(46,"Couleur"),l(),s(47,"div",94),ue(48,Ep,1,4,"div",95,Bt),s(50,"div",96),v("click",function(){f(n);let t=u();return h(t.isCustomColor=!0)}),F(51,Tp,1,2,"div",97)(52,Ip,1,2,"lucide-icon",45),l()(),F(53,jp,3,2,"div",98),l(),s(54,"div",99)(55,"button",100),p(56),l(),s(57,"button",101),v("click",function(){f(n);let t=u();return h(t.closeModal())}),p(58,"Annuler"),l()()()()()}if(i&2){let n=u();c(4),O(n.editingProjetId?"Modifier le projet":"Nouveau Projet"),c(8),k("ngModel",n.newProjet.code_projet),c(4),k("ngModel",n.newProjet.reference_externe),c(4),k("ngModel",n.newProjet.nom_projet),c(5),k("ngModel",n.newProjet.statut),c(14),k("ngModel",n.newProjet.chef_projet),c(4),k("ngModel",n.newProjet.description),c(5),me(n.predefinedColors),c(2),$("active",n.isCustomColor),c(),q(n.isCustomColor?51:52),c(2),q(n.isCustomColor?53:-1),c(3),O(n.editingProjetId?"Mettre \xE0 jour":"Cr\xE9er")}}var vs=(()=>{let r=class r{constructor(e,t,o){this.projetService=e,this.settingsService=t,this.route=o,this.viewMode="list",this.searchQuery="",this.statusFilter="",this.LucideCalculator=ri,this.MoreVertical=Jt,this.Edit=li,this.Trash2=ci,this.Copy=Qr,this.ExternalLink=Kr,this.Plus=Ye,this.projets=[],this.filteredProjects=[],this.externalReferenceUrl=null,this.showProjectModal=!1,this.editingProjetId=null,this.activeMenuId=null,this.isMouseDownOnOverlay=!1,this.showChiffresModal=!1,this.selectedProjetId=null,this.predefinedColors=["#ef4444","#f97316","#f59e0b","#eab308","#84cc16","#22c55e","#10b981","#14b8a6","#06b6d4","#0ea5e9","#3b82f6","#6366f1","#8b5cf6","#a855f7","#d946ef","#ec4899","#f43f5e"],this.isCustomColor=!1,this.newProjet={code_projet:"",nom_projet:"",statut:"En cours",description:"",reference_externe:"",color:"#3b82f6"}}onDocumentClick(e){this.activeMenuId&&(this.activeMenuId=null)}toggleMenu(e,t){e.stopPropagation(),this.activeMenuId===t?this.activeMenuId=null:this.activeMenuId=t}ngOnInit(){return _(this,null,function*(){this.route.queryParams.subscribe(e=>{e.status&&(this.statusFilter=e.status)}),yield this.loadProjects(),this.externalReferenceUrl=yield this.settingsService.getSettingValue("external_reference_url","global")})}loadProjects(){return _(this,null,function*(){try{this.projets=yield this.projetService.getAllProjets(),this.filterProjects()}catch(e){console.error("Error loading projects:",e)}})}filterProjects(){this.filteredProjects=this.projets.filter(e=>{let t=!this.searchQuery||e.nom_projet.toLowerCase().includes(this.searchQuery.toLowerCase())||e.code_projet.toLowerCase().includes(this.searchQuery.toLowerCase()),o=!this.statusFilter||e.statut===this.statusFilter;return t&&o})}getProgressPercent(e){if(e.chiffrage_previsionnel===0)return 0;let t=e.temps_consomme/e.chiffrage_previsionnel*100;return Math.min(Math.round(t),100)}calculateRAF(e){return this.projetService.calculateRAF(e)}openCreateModal(){this.editingProjetId=null,this.newProjet={code_projet:"",nom_projet:"",statut:"En cours",description:"",reference_externe:"",color:"#3b82f6"},this.isCustomColor=!1,this.showProjectModal=!0,this.activeMenuId=null}selectColor(e){this.newProjet.color=e,this.isCustomColor=!1}openEditModal(e){this.editingProjetId=e.id,this.newProjet=I({},e),this.isCustomColor=!this.predefinedColors.includes(this.newProjet.color),this.showProjectModal=!0,this.activeMenuId=null}duplicateProjet(e){this.editingProjetId=null,console.log("PROJET Origine : ",e);let m=e,{id:t,created_at:o,updated_at:a}=m,d=ir(m,["id","created_at","updated_at"]);this.newProjet=ge(I({},d),{code_projet:`${e.code_projet}-COPY`,nom_projet:`${e.nom_projet} (Copie)`}),console.log("PROJET Copie : ",this.newProjet),this.showProjectModal=!0,this.activeMenuId=null}onOverlayMouseDown(e){e.target===e.currentTarget&&(this.isMouseDownOnOverlay=!0)}onOverlayMouseUp(e){this.isMouseDownOnOverlay&&e.target===e.currentTarget&&this.closeModal(),this.isMouseDownOnOverlay=!1}closeModal(){this.showProjectModal=!1,this.editingProjetId=null}deleteProjet(e){return _(this,null,function*(){if(this.activeMenuId=null,confirm(`\xCAtes-vous s\xFBr de vouloir supprimer le projet "${e.nom_projet}" ?`))try{yield this.projetService.deleteProjet(e.id),yield this.loadProjects()}catch(t){console.error("Error deleting project:",t)}})}saveProjet(){return _(this,null,function*(){try{this.editingProjetId?yield this.projetService.updateProjet(this.editingProjetId,this.newProjet):yield this.projetService.createProjet(this.newProjet),this.closeModal(),yield this.loadProjects()}catch(e){console.error("Error saving project:",e)}})}openChiffresModal(e){this.selectedProjetId=e,this.showChiffresModal=!0,this.activeMenuId=null}closeChiffresModal(){this.showChiffresModal=!1}onChiffresModalSaved(e){console.log("Chiffres sauvegard\xE9s:",e)}};r.\u0275fac=function(t){return new(t||r)(R(at),R(aa),R(Ne))},r.\u0275cmp=B({type:r,selectors:[["app-projects-view"]],hostBindings:function(t,o){t&1&&v("click",function(d){return o.onDocumentClick(d)},Qn)},decls:43,vars:11,consts:[["noLink",""],["noLinkList",""],[1,"projects-container"],[1,"projects-header"],[1,"subtitle"],[1,"btn","btn-primary",3,"click"],[1,"projects-controls"],[1,"search-box"],["type","text","placeholder","Rechercher un projet...",1,"search-input",3,"ngModelChange","ngModel"],[1,"controls-right"],[1,"filter-select",3,"ngModelChange","ngModel"],["value",""],["value","Actif"],["value","En cours"],["value","Planifi\xE9"],["value","Termin\xE9"],["value","En pause"],[1,"view-toggle"],["title","Vue en cartes",1,"toggle-btn",3,"click"],["width","20","height","20","viewBox","0 0 20 20","fill","currentColor"],["x","2","y","2","width","7","height","7","rx","1"],["x","11","y","2","width","7","height","7","rx","1"],["x","2","y","11","width","7","height","7","rx","1"],["x","11","y","11","width","7","height","7","rx","1"],["title","Vue en liste",1,"toggle-btn",3,"click"],["x","2","y","3","width","16","height","2","rx","1"],["x","2","y","8","width","16","height","2","rx","1"],["x","2","y","13","width","16","height","2","rx","1"],["class","projects-grid",4,"ngIf"],["class","projects-list-view",4,"ngIf"],["class","modal-overlay",3,"mousedown","mouseup",4,"ngIf"],[3,"close","saved","visible","idProjet"],[1,"projects-grid"],["class","project-card",3,"border-left-color","menu-active","click",4,"ngFor","ngForOf"],["class","empty-state",4,"ngIf"],[1,"project-card",3,"click"],[1,"card-header"],[1,"card-header-top"],[1,"project-identifiers"],[1,"project-code"],["class","external-ref-tag",4,"ngIf"],[1,"header-actions"],[1,"status-badge"],[1,"menu-container",3,"click"],[1,"menu-btn",3,"click"],[3,"img","size"],["class","dropdown-menu",4,"ngIf"],[1,"card-body"],[1,"project-name"],["class","project-manager",4,"ngIf"],["class","project-description",4,"ngIf"],[1,"progress-section"],[1,"progress-header"],[1,"progress-label"],[1,"progress-percent"],[1,"progress-bar"],[1,"progress-fill"],[1,"external-ref-tag"],[4,"ngIf","ngIfElse"],["target","_blank",1,"ref-link",3,"click","href"],[1,"dropdown-menu"],[1,"dropdown-item",3,"click"],[1,"dropdown-item","delete",3,"click"],[1,"project-manager"],[1,"label"],[1,"project-description"],[1,"empty-state"],[1,"projects-list-view"],["class","project-list-card",3,"border-left-color","menu-active","click",4,"ngFor","ngForOf"],[1,"project-list-card",3,"click"],[1,"card-left"],[1,"project-info"],[1,"project-name-row"],[1,"status-badge","small"],[1,"project-meta"],[4,"ngIf"],[1,"card-right"],["class","dropdown-menu right",4,"ngIf"],[1,"manager-name"],[1,"dropdown-menu","right"],[1,"modal-overlay",3,"mousedown","mouseup"],[1,"modal",3,"click"],[1,"modal-header"],[1,"modal-close",3,"click"],[1,"form",3,"ngSubmit"],[1,"grid","grid-2"],[1,"form-group"],["name","code","required","",3,"ngModelChange","ngModel"],["name","ref_ext","placeholder","ex: JIRA-123",3,"ngModelChange","ngModel"],[1,"form-group","full-width"],["name","nom","required","",3,"ngModelChange","ngModel"],["name","statut",3,"ngModelChange","ngModel"],["name","chef",3,"ngModelChange","ngModel"],["name","desc","rows","3",3,"ngModelChange","ngModel"],[1,"color-palette"],[1,"color-swatch",3,"background-color","active"],[1,"color-swatch","custom-trigger",3,"click"],[1,"custom-preview",3,"background-color"],[1,"custom-color-input-wrapper"],[1,"flex","gap-2","mt-4"],["type","submit",1,"btn","btn-primary"],["type","button",1,"btn","btn-secondary",3,"click"],[1,"color-swatch",3,"click"],[1,"custom-preview"],["type","color","name","customColor",1,"color-input",3,"ngModelChange","ngModel"],["type","text","name","customColorText","placeholder","#HEXCODE",1,"color-hex-input",3,"ngModelChange","ngModel"]],template:function(t,o){t&1&&(s(0,"div",2)(1,"div",3)(2,"div")(3,"h1"),p(4,"Projets"),l(),s(5,"p",4),p(6,"G\xE9rez vos projets et leur chiffrage"),l()(),s(7,"button",5),v("click",function(){return o.openCreateModal()}),p(8,"+ Nouveau projet"),l()(),s(9,"div",6)(10,"div",7)(11,"input",8),T("ngModelChange",function(d){return E(o.searchQuery,d)||(o.searchQuery=d),d}),v("ngModelChange",function(){return o.filterProjects()}),l()(),s(12,"div",9)(13,"select",10),T("ngModelChange",function(d){return E(o.statusFilter,d)||(o.statusFilter=d),d}),v("ngModelChange",function(){return o.filterProjects()}),s(14,"option",11),p(15,"Tous les statuts"),l(),s(16,"option",12),p(17,"Actif"),l(),s(18,"option",13),p(19,"En cours"),l(),s(20,"option",14),p(21,"Planifi\xE9"),l(),s(22,"option",15),p(23,"Termin\xE9"),l(),s(24,"option",16),p(25,"En pause"),l()(),s(26,"div",17)(27,"button",18),v("click",function(){return o.viewMode="card"}),xt(),s(28,"svg",19),y(29,"rect",20)(30,"rect",21)(31,"rect",22)(32,"rect",23),l()(),Dt(),s(33,"button",24),v("click",function(){return o.viewMode="list"}),xt(),s(34,"svg",19),y(35,"rect",25)(36,"rect",26)(37,"rect",27),l()()()()(),w(38,xp,3,2,"div",28)(39,kp,3,2,"div",29),l(),w(40,Rp,59,12,"div",30),Dt(),s(41,"div")(42,"app-chiffres-modal",31),v("close",function(){return o.closeChiffresModal()})("saved",function(d){return o.onChiffresModalSaved(d)}),l()()),t&2&&(c(11),k("ngModel",o.searchQuery),c(2),k("ngModel",o.statusFilter),c(14),$("active",o.viewMode==="card"),c(6),$("active",o.viewMode==="list"),c(5),g("ngIf",o.viewMode==="card"),c(),g("ngIf",o.viewMode==="list"),c(),g("ngIf",o.showProjectModal),c(2),g("visible",o.showChiffresModal)("idProjet",o.selectedProjetId))},dependencies:[G,Oe,te,X,Te,qe,Ue,ie,Fe,oe,ke,Ie,re,Ee,_s,K,ne],styles:['.projects-container[_ngcontent-%COMP%]{padding:32px;background:#f5f7fa;min-height:100vh}.projects-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:32px}.projects-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 4px;font-size:32px;font-weight:700;color:#111827}.subtitle[_ngcontent-%COMP%]{margin:0;color:#6b7280;font-size:16px}.projects-controls[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:16px;margin-bottom:24px;flex-wrap:wrap}.search-box[_ngcontent-%COMP%]{flex:1;min-width:300px;max-width:500px}.search-input[_ngcontent-%COMP%]{width:100%;padding:10px 16px;border:1px solid #e5e7eb;border-radius:8px;font-size:14px;transition:all .2s}.search-input[_ngcontent-%COMP%]:focus{outline:none;border-color:#4f46e5;box-shadow:0 0 0 3px #4f46e51a}.controls-right[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center}.filter-select[_ngcontent-%COMP%]{padding:10px 16px;border:1px solid #e5e7eb;border-radius:8px;background:#fff;font-size:14px;cursor:pointer;transition:all .2s}.filter-select[_ngcontent-%COMP%]:focus{outline:none;border-color:#4f46e5;box-shadow:0 0 0 3px #4f46e51a}.view-toggle[_ngcontent-%COMP%]{display:flex;gap:4px;background:#fff;padding:4px;border-radius:8px;border:1px solid #e5e7eb}.toggle-btn[_ngcontent-%COMP%]{padding:8px 12px;border:none;background:transparent;border-radius:6px;cursor:pointer;color:#6b7280;transition:all .2s;display:flex;align-items:center;justify-content:center}.toggle-btn[_ngcontent-%COMP%]:hover{background:#f3f4f6;color:#374151}.toggle-btn.active[_ngcontent-%COMP%]{background:#4f46e5;color:#fff}.projects-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(340px,1fr));gap:24px}.project-card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;position:relative;box-shadow:0 1px 3px #0000001a;transition:all .3s cubic-bezier(.4,0,.2,1);border-left:4px solid #4f46e5;cursor:pointer}.project-card.menu-active[_ngcontent-%COMP%], .project-list-card.menu-active[_ngcontent-%COMP%]{z-index:100;position:relative}.project-card[_ngcontent-%COMP%]:hover{box-shadow:0 10px 25px #00000026;transform:translateY(-4px)}.card-header[_ngcontent-%COMP%]{padding:16px 20px 12px;border-bottom:1px solid #f3f4f6}.card-header-top[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.header-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px}.project-identifiers[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;margin-bottom:4px}.project-code[_ngcontent-%COMP%]{font-family:Consolas,Monaco,monospace;font-weight:700;font-size:13px;letter-spacing:.5px}.status-badge[_ngcontent-%COMP%]{padding:4px 12px;border-radius:12px;font-size:12px;font-weight:600;text-transform:uppercase;letter-spacing:.3px}.status-badge[data-status=Actif][_ngcontent-%COMP%]{background:#d1fae5;color:#065f46}.status-badge[data-status="En cours"][_ngcontent-%COMP%]{background:#dbeafe;color:#1e40af}.status-badge[data-status=Planifi\\e9][_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.status-badge[data-status=Termin\\e9][_ngcontent-%COMP%]{background:#f3f4f6;color:#374151}.status-badge[data-status="En pause"][_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}.status-badge.small[_ngcontent-%COMP%]{padding:2px 8px;font-size:11px}.card-body[_ngcontent-%COMP%]{padding:20px}.project-name[_ngcontent-%COMP%]{margin:0 0 12px;font-size:18px;font-weight:600;color:#111827;line-height:1.4}.project-manager[_ngcontent-%COMP%]{margin:0 0 12px;color:#6b7280;font-size:14px}.project-manager[_ngcontent-%COMP%]   .label[_ngcontent-%COMP%]{font-weight:500;color:#9ca3af}.project-description[_ngcontent-%COMP%]{margin:0 0 16px;color:#6b7280;font-size:14px;line-height:1.6;display:-webkit-box;-webkit-line-clamp:2;-webkit-box-orient:vertical;overflow:hidden}.metrics[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);gap:12px;margin-bottom:20px;padding:16px;background:#f9fafb;border-radius:8px}.metric-row[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.metric-label[_ngcontent-%COMP%]{font-size:11px;font-weight:500;color:#9ca3af;text-transform:uppercase;letter-spacing:.5px}.metric-value[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#111827}.progress-section[_ngcontent-%COMP%]{margin-top:16px;padding-top:16px;border-top:1px solid #f3f4f6}.progress-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}.progress-label[_ngcontent-%COMP%]{font-size:12px;font-weight:500;color:#6b7280}.progress-value[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#111827}.progress-bar[_ngcontent-%COMP%]{height:8px;background:#e5e7eb;border-radius:4px;overflow:hidden;margin-bottom:8px}.progress-bar.small[_ngcontent-%COMP%]{height:6px;margin:0}.progress-fill[_ngcontent-%COMP%]{height:100%;background:#10b981;transition:width .3s ease;border-radius:4px}.progress-fill.warning[_ngcontent-%COMP%]{background:#f59e0b}.progress-fill.danger[_ngcontent-%COMP%]{background:#ef4444}.raf-info[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center}.raf-label[_ngcontent-%COMP%]{font-size:12px;font-weight:500;color:#6b7280}.raf-value[_ngcontent-%COMP%]{font-size:14px;font-weight:700;color:#10b981}.raf-value.negative[_ngcontent-%COMP%]{color:#ef4444}.projects-list-view[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px}.project-list-card[_ngcontent-%COMP%]{background:#fff;border:1px solid #e5e7eb;border-left:4px solid #4f46e5;border-radius:12px;padding:16px 20px;display:flex;justify-content:space-between;align-items:center;transition:all .2s;cursor:pointer}.project-list-card[_ngcontent-%COMP%]:hover{border-color:#4f46e5;box-shadow:0 4px 12px #0000000d;transform:translateY(-1px)}.card-left[_ngcontent-%COMP%]{display:flex;align-items:center;gap:16px}.project-info[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.project-name-row[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.project-name[_ngcontent-%COMP%]{font-weight:700;color:#111827;font-size:16px}.project-meta[_ngcontent-%COMP%]{font-size:13px;color:#6b7280;font-weight:500;display:flex;align-items:center;gap:4px}.manager-name[_ngcontent-%COMP%]{color:#4f46e5;font-weight:600}.external-ref-tag[_ngcontent-%COMP%]{display:inline-flex;align-items:center;background:#f3f4f6;padding:2px 8px;border-radius:6px;border:1px solid #e5e7eb;transition:all .2s}.external-ref-tag[_ngcontent-%COMP%]:hover{background:#e5e7eb;border-color:#d1d5db}.ref-link[_ngcontent-%COMP%]{color:#4f46e5;text-decoration:none;font-weight:600;font-size:12px;display:flex;align-items:center;gap:4px}.ref-link[_ngcontent-%COMP%]:hover{color:#4338ca;text-decoration:underline}.ref-link[_ngcontent-%COMP%]   lucide-icon[_ngcontent-%COMP%]{display:flex;align-items:center}.color-palette[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:10px;margin-top:4px}.color-swatch[_ngcontent-%COMP%]{width:32px;height:32px;border-radius:8px;cursor:pointer;transition:all .2s;border:2px solid transparent}.color-swatch[_ngcontent-%COMP%]:hover{transform:scale(1.1)}.color-swatch.active[_ngcontent-%COMP%]{border-color:#111827;box-shadow:0 0 0 2px #fff,0 0 0 4px #111827}.color-input[_ngcontent-%COMP%]{width:60px;height:40px;padding:2px;cursor:pointer;border-radius:8px;border:1px solid #d1d5db}.color-hex-input[_ngcontent-%COMP%]{flex:1;text-transform:uppercase}.custom-trigger[_ngcontent-%COMP%]{background:#f3f4f6;border:2px dashed #d1d5db;display:flex;align-items:center;justify-content:center;color:#6b7280}.custom-trigger.active[_ngcontent-%COMP%]{border:2px solid #111827;background:#fff;color:#111827}.custom-preview[_ngcontent-%COMP%]{width:100%;height:100%;border-radius:6px}.custom-color-input-wrapper[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center;margin-top:16px;padding:12px;background:#f9fafb;border-radius:12px;border:1px solid #e5e7eb}.form-group.full-width[_ngcontent-%COMP%]{grid-column:span 2}.empty-state[_ngcontent-%COMP%]{padding:48px;text-align:center;color:#9ca3af;font-size:15px;background:#fff;border-radius:16px;border:2px dashed #e5e7eb}.menu-container[_ngcontent-%COMP%]{position:relative;display:inline-block}.menu-btn[_ngcontent-%COMP%]{background:transparent;border:none;color:#9ca3af;padding:4px;border-radius:4px;cursor:pointer;display:flex;align-items:center;justify-content:center;transition:all .2s}.menu-btn[_ngcontent-%COMP%]:hover{background:#f3f4f6;color:#374151}.dropdown-menu[_ngcontent-%COMP%]{position:absolute;top:100%;right:0;width:160px;background:#fff;border-radius:8px;box-shadow:0 4px 12px #0000001a,0 0 0 1px #0000000d;padding:4px;z-index:50;margin-top:4px}.dropdown-menu.right[_ngcontent-%COMP%]{right:0}.dropdown-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;width:100%;padding:8px 12px;text-align:left;border:none;background:transparent;font-size:13px;color:#374151;cursor:pointer;border-radius:4px;transition:background .15s}.dropdown-item[_ngcontent-%COMP%]:hover{background:#f3f4f6}.dropdown-item[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#6b7280}.dropdown-item.delete[_ngcontent-%COMP%]{color:#ef4444}.dropdown-item.delete[_ngcontent-%COMP%]:hover{background:#fee2e2}.dropdown-item.delete[_ngcontent-%COMP%]   svg[_ngcontent-%COMP%]{color:#ef4444}.btn[_ngcontent-%COMP%]{padding:10px 20px;border:none;border-radius:8px;font-size:14px;font-weight:600;cursor:pointer;transition:all .2s;display:inline-flex;align-items:center;gap:8px}.btn-primary[_ngcontent-%COMP%]{background:#4f46e5;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{background:#4338ca;transform:translateY(-1px);box-shadow:0 4px 12px #4f46e54d}.btn-secondary[_ngcontent-%COMP%]{background:#f3f4f6;color:#374151}.btn-secondary[_ngcontent-%COMP%]:hover{background:#e5e7eb}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:2000;-webkit-backdrop-filter:blur(4px);backdrop-filter:blur(4px)}.modal[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:0;width:90%;max-width:600px;max-height:90vh;overflow-y:auto;box-shadow:0 20px 25px -5px #0000001a,0 10px 10px -5px #0000000a}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;padding:24px;border-bottom:1px solid #e5e7eb}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:24px;font-weight:700;color:#111827}.modal-close[_ngcontent-%COMP%]{width:32px;height:32px;border:none;background:#f3f4f6;border-radius:8px;font-size:24px;color:#6b7280;cursor:pointer;transition:all .2s;display:flex;align-items:center;justify-content:center}.modal-close[_ngcontent-%COMP%]:hover{background:#e5e7eb;color:#374151}.form[_ngcontent-%COMP%]{padding:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:20px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-size:14px;font-weight:600;color:#374151}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{width:100%;padding:10px 14px;border:1px solid #d1d5db;border-radius:8px;font-size:14px;transition:all .2s;font-family:inherit}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]:focus{outline:none;border-color:#4f46e5;box-shadow:0 0 0 3px #4f46e51a}.grid[_ngcontent-%COMP%]{display:grid;gap:16px}.grid-3[_ngcontent-%COMP%]{grid-template-columns:repeat(3,1fr)}.grid-2[_ngcontent-%COMP%]{grid-template-columns:repeat(2,1fr)}.flex[_ngcontent-%COMP%]{display:flex}.gap-2[_ngcontent-%COMP%]{gap:8px}.mt-4[_ngcontent-%COMP%]{margin-top:16px}']});let i=r;return i})();var Tt=(()=>{let r=class r{constructor(e){this.supabase=e,this._jalonsCache=null}clearCache(){this._jalonsCache=null}getAllJalons(){return _(this,null,function*(){if(this._jalonsCache)return this._jalonsCache;let{data:e,error:t}=yield this.supabase.client.from("jalons").select("*").order("date_jalon",{ascending:!0});if(t)throw t;return this._jalonsCache=e||[],this._jalonsCache})}getJalonsByProject(e){return _(this,null,function*(){let{data:t,error:o}=yield this.supabase.client.from("jalons").select("*").eq("projet_id",e).order("date_jalon",{ascending:!0});if(o)throw o;return t||[]})}createJalon(e){return _(this,null,function*(){let{data:t,error:o}=yield this.supabase.client.from("jalons").insert([e]).select().single();if(o)throw o;return this.clearCache(),t})}updateJalon(e,t){return _(this,null,function*(){let{data:o,error:a}=yield this.supabase.client.from("jalons").update(t).eq("id",e).select().single();if(a)throw a;return this.clearCache(),o})}deleteJalon(e){return _(this,null,function*(){let{error:t}=yield this.supabase.client.from("jalons").delete().eq("id",e);if(t)throw t;this.clearCache()})}};r.\u0275fac=function(t){return new(t||r)(V(H))},r.\u0275prov=A({token:r,factory:r.\u0275fac,providedIn:"root"});let i=r;return i})();function Vp(i,r){if(i&1&&(s(0,"option",20),p(1),l()),i&2){let n=r.$implicit;g("value",n.id),c(),O(n.nom_projet)}}function Dp(i,r){if(i&1){let n=S();s(0,"div",1),v("click",function(){f(n);let t=u();return h(t.close())}),s(1,"div",2),v("click",function(t){return f(n),h(t.stopPropagation())}),s(2,"div",3)(3,"h2"),p(4),l(),s(5,"button",4),v("click",function(){f(n);let t=u();return h(t.close())}),p(6,"\xD7"),l()(),s(7,"form",5),v("ngSubmit",function(){f(n);let t=u();return h(t.save())}),s(8,"div",6)(9,"label"),p(10,"Nom du jalon *"),l(),s(11,"input",7),T("ngModelChange",function(t){f(n);let o=u();return E(o.currentJalon.nom,t)||(o.currentJalon.nom=t),h(t)}),l()(),s(12,"div",6)(13,"label"),p(14,"Date *"),l(),s(15,"input",8),T("ngModelChange",function(t){f(n);let o=u();return E(o.currentJalon.date_jalon,t)||(o.currentJalon.date_jalon=t),h(t)}),l()(),s(16,"div",6)(17,"label"),p(18,"Projet"),l(),s(19,"select",9),T("ngModelChange",function(t){f(n);let o=u();return E(o.currentJalon.projet_id,t)||(o.currentJalon.projet_id=t),h(t)}),s(20,"option",10),p(21,"-- Aucun projet --"),l(),w(22,Vp,2,2,"option",11),l()(),s(23,"div",6)(24,"label"),p(25,"Type"),l(),s(26,"select",12),T("ngModelChange",function(t){f(n);let o=u();return E(o.currentJalon.type,t)||(o.currentJalon.type=t),h(t)}),s(27,"option",13),p(28,"Autre"),l(),s(29,"option",14),p(30,"Livraison (LV)"),l(),s(31,"option",15),p(32,"Mise en production (MEP)"),l(),s(33,"option",16),p(34,"Sprint (SP)"),l()()(),s(35,"div",17)(36,"button",18),v("click",function(){f(n);let t=u();return h(t.close())}),p(37,"Annuler"),l(),s(38,"button",19),p(39),l()()()()()}if(i&2){let n=u();c(4),O(n.isEditing?"Modifier le jalon":"Nouveau Jalon"),c(7),k("ngModel",n.currentJalon.nom),c(4),k("ngModel",n.currentJalon.date_jalon),c(4),k("ngModel",n.currentJalon.projet_id),c(),g("ngValue",void 0),c(2),g("ngForOf",n.projets),c(4),k("ngModel",n.currentJalon.type),c(13),O(n.isEditing?"Mettre \xE0 jour":"Cr\xE9er")}}var Yi=(()=>{let r=class r{constructor(e){this.jalonService=e,this.visible=!1,this.jalon=null,this.projets=[],this.visibleChange=new xe,this.saved=new xe,this.currentJalon={nom:"",date_jalon:"",type:""}}ngOnChanges(e){e.jalon&&this.jalon?this.currentJalon=I({},this.jalon):e.visible&&this.visible&&!this.jalon&&(this.currentJalon={nom:"",date_jalon:new Date().toISOString().split("T")[0],type:""})}get isEditing(){return!!this.currentJalon.id}close(){this.visible=!1,this.visibleChange.emit(!1)}save(){return _(this,null,function*(){if(!(!this.currentJalon.nom||!this.currentJalon.date_jalon))try{this.currentJalon.id?yield this.jalonService.updateJalon(this.currentJalon.id,this.currentJalon):yield this.jalonService.createJalon(this.currentJalon),this.saved.emit(),this.close()}catch(e){console.error("Error saving jalon:",e)}})}};r.\u0275fac=function(t){return new(t||r)(R(Tt))},r.\u0275cmp=B({type:r,selectors:[["app-milestone-modal"]],inputs:{visible:"visible",jalon:"jalon",projets:"projets"},outputs:{visibleChange:"visibleChange",saved:"saved"},features:[dt],decls:1,vars:1,consts:[["class","modal-overlay",3,"click",4,"ngIf"],[1,"modal-overlay",3,"click"],[1,"modal",3,"click"],[1,"modal-header"],[1,"modal-close",3,"click"],[1,"form",3,"ngSubmit"],[1,"form-group"],["name","nom","required","","placeholder","Ex: Livraison V1",3,"ngModelChange","ngModel"],["type","date","name","date_jalon","required","",3,"ngModelChange","ngModel"],["name","projet_id",3,"ngModelChange","ngModel"],[3,"ngValue"],[3,"value",4,"ngFor","ngForOf"],["name","type",3,"ngModelChange","ngModel"],["value",""],["value","LV"],["value","MEP"],["value","SP"],[1,"modal-actions"],["type","button",1,"btn","btn-secondary",3,"click"],["type","submit",1,"btn","btn-primary"],[3,"value"]],template:function(t,o){t&1&&w(0,Dp,40,8,"div",0),t&2&&g("ngIf",o.visible)},dependencies:[G,Oe,te,X,Te,qe,Ue,ie,Fe,oe,ke,Ie,re,Ee],styles:[".modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:1000}.modal[_ngcontent-%COMP%]{background:#fff;border-radius:12px;width:100%;max-width:500px;box-shadow:0 20px 25px -5px #0000001a,0 10px 10px -5px #0000000a;padding:24px}.modal-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:20px;font-weight:600;color:#111827}.modal-close[_ngcontent-%COMP%]{background:transparent;border:none;font-size:24px;color:#9ca3af;cursor:pointer}.form-group[_ngcontent-%COMP%]{margin-bottom:20px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-size:14px;font-weight:500;color:#374151}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%], .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{width:100%;padding:10px 12px;border:1px solid #d1d5db;border-radius:6px;font-size:14px;color:#111827;transition:all .2s}.form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, .form-group[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]:focus{outline:none;border-color:#4f46e5;box-shadow:0 0 0 3px #4f46e51a}.modal-actions[_ngcontent-%COMP%]{display:flex;justify-content:flex-end;gap:12px;margin-top:32px}.btn[_ngcontent-%COMP%]{padding:10px 20px;border-radius:8px;font-weight:500;cursor:pointer;border:none;transition:all .2s}.btn-primary[_ngcontent-%COMP%]{background:#4f46e5;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{background:#4338ca}.btn-secondary[_ngcontent-%COMP%]{background:#e5e7eb;color:#374151}.btn-secondary[_ngcontent-%COMP%]:hover{background:#d1d5db}"]});let i=r;return i})();var Ap=["bulkChargeInput"],Np=["headerScroll"],Lp=["dataScroll"],zp=["milestonesScroll"],Cs=(i,r,n)=>({"availability-positive":i,"availability-zero":r,"availability-negative":n});function Fp(i,r){if(i&1&&(s(0,"span",48),p(1),l()),i&2){let n=r.$implicit,e=u();c(),O(e.getEquipeName(n))}}function qp(i,r){i&1&&(s(0,"span",49),p(1,"Tous"),l())}function Up(i,r){if(i&1&&(s(0,"span",48),p(1),l()),i&2){let n=r.$implicit,e=u();c(),O(e.getProjetLabel(n))}}function Wp(i,r){i&1&&(s(0,"span",49),p(1,"Tous"),l())}function $p(i,r){if(i&1&&(s(0,"span",48),p(1),l()),i&2){let n=r.$implicit,e=u();c(),O(e.getResourceLabel(n))}}function Bp(i,r){i&1&&(s(0,"span",49),p(1,"Tous"),l())}function Hp(i,r){if(i&1){let n=S();s(0,"label",53)(1,"input",54),v("change",function(t){let o=f(n).$implicit,a=u(2);return h(a.onEquipeToggle(o.id,t))}),l(),p(2),l()}if(i&2){let n=r.$implicit,e=u(2);c(),g("value",n.id)("checked",e.filterEquipeIds.includes(n.id)),c(),P(" ",n.nom," ")}}function Gp(i,r){if(i&1){let n=S();s(0,"div",50),v("click",function(t){return f(n),h(t.stopPropagation())}),s(1,"div",51),w(2,Hp,3,3,"label",52),l()()}if(i&2){let n=u();c(2),g("ngForOf",n.allEquipes)}}function Jp(i,r){if(i&1){let n=S();s(0,"label",53)(1,"input",54),v("change",function(t){let o=f(n).$implicit,a=u(2);return h(a.onProjetToggle(o.id,t))}),l(),p(2),l()}if(i&2){let n=r.$implicit,e=u(2);c(),g("value",n.id)("checked",e.filterProjetIds.includes(n.id)),c(),Se(" ",n.code_projet," \u2014 ",n.nom_projet," ")}}function Yp(i,r){if(i&1){let n=S();s(0,"div",50),v("click",function(t){return f(n),h(t.stopPropagation())}),s(1,"div",51),w(2,Jp,3,4,"label",52),l()()}if(i&2){let n=u();c(2),g("ngForOf",n.allProjects)}}function Qp(i,r){if(i&1){let n=S();s(0,"label",53)(1,"input",54),v("change",function(t){let o=f(n).$implicit,a=u(2);return h(a.onResourceToggle("role:"+o.id,t))}),l(),p(2),l()}if(i&2){let n=r.$implicit,e=u(2);c(),g("value","role:"+n.id)("checked",e.filterResourceIds.includes("role:"+n.id)),c(),P(" ",n.nom," ")}}function Kp(i,r){if(i&1){let n=S();s(0,"label",53)(1,"input",54),v("change",function(t){let o=f(n).$implicit,a=u(2);return h(a.onResourceToggle("personne:"+o.id,t))}),l(),p(2),l()}if(i&2){let n=r.$implicit,e=u(2);c(),g("value","personne:"+n.id)("checked",e.filterResourceIds.includes("personne:"+n.id)),c(),Se(" ",n.prenom," ",n.nom," ")}}function Zp(i,r){if(i&1){let n=S();s(0,"div",50),v("click",function(t){return f(n),h(t.stopPropagation())}),s(1,"div",51)(2,"div",55),p(3,"R\xF4les"),l(),w(4,Qp,3,3,"label",52),s(5,"div",55),p(6,"Personnes"),l(),w(7,Kp,3,4,"label",52),l()()}if(i&2){let n=u();c(4),g("ngForOf",n.availableRoles),c(3),g("ngForOf",n.availablePersonnes)}}function Xp(i,r){if(i&1&&(s(0,"div",56)(1,"div",57),p(2),l(),s(3,"div",58),p(4),l()()),i&2){let n=r.$implicit,e=u();$("current-week",e.isCurrentWeek(n)),c(2),O(e.formatWeekHeader(n)),c(2),P("S",e.getWeekNumber(n))}}function eu(i,r){if(i&1){let n=S();s(0,"div",62),v("click",function(t){let o=f(n).$implicit,a=u(2);return h(a.openMilestoneModal(o,t))}),p(1),l()}if(i&2){let n=r.$implicit,e=u(2);z("background-color",e.getJalonColor(n.type))("color",e.getJalonTextColor(n.type)),g("title",n.date_jalon),c(),P(" ",n.nom||"\u2605"," ")}}function tu(i,r){if(i&1&&(s(0,"div",59)(1,"div",60),w(2,eu,2,6,"div",61),l()()),i&2){let n=r.$implicit,e=u();$("current-week",e.isCurrentWeek(n)),c(2),g("ngForOf",e.getJalonsForWeek(n))}}function nu(i,r){if(i&1&&y(0,"lucide-icon",80),i&2){let n=u().$implicit;g("name",n.expanded?"chevron-down":"chevron-right")("size",20)}}function iu(i,r){if(i&1&&(s(0,"span",81),p(1),l()),i&2){let n=u().$implicit;c(),O(n.code)}}function ou(i,r){i&1&&y(0,"div",84)}function ru(i,r){if(i&1&&(s(0,"div",82),w(1,ou,1,0,"div",83),l()),i&2){let n=r.$implicit,e=u().$implicit,t=u(2);c(),g("ngIf",t.getParentTotal(e,n)>0)}}function au(i,r){if(i&1&&y(0,"lucide-icon",80),i&2){let n=u().$implicit;g("name",n.expanded?"chevron-down":"chevron-right")("size",18)}}function su(i,r){if(i&1&&(s(0,"span",81),p(1),l()),i&2){let n=u().$implicit;c(),O(n.code)}}function lu(i,r){i&1&&y(0,"div",89)}function cu(i,r){if(i&1&&(s(0,"div",104),p(1),ce(2,"number"),l()),i&2){let n=u().$implicit,e=u().$implicit,t=u(6);c(),P(" ",de(2,1,t.getResourceValue(e,n),"1.0-1")," ")}}function du(i,r){if(i&1&&(s(0,"div",105),p(1),ce(2,"number"),l()),i&2){let n=u().$implicit,e=u().$implicit,t=u(2).$implicit,o=u(2).$implicit,a=u(2);g("ngClass",vo(6,Cs,a.getAvailability(e,n,a.viewMode==="project"?t.id:o.id)>0,a.getAvailability(e,n,a.viewMode==="project"?t.id:o.id)===0,a.getAvailability(e,n,a.viewMode==="project"?t.id:o.id)<0)),c(),Se(" ",a.getAvailability(e,n,a.viewMode==="project"?t.id:o.id)>0?"+":"","",de(2,3,a.getAvailability(e,n,a.viewMode==="project"?t.id:o.id),"1.0-1")," ")}}function pu(i,r){if(i&1&&(s(0,"div",100)(1,"div",101),w(2,cu,3,4,"div",102)(3,du,3,10,"div",103),l()()),i&2){let n=r.$implicit,e=r.index,t=u().$implicit,o=u(2).$implicit,a=u(2).$implicit,d=u(2);$("selected",d.isCellSelected(t,n))("has-capacity",d.getResourceValue(t,n)>0)("cell-positive",d.shouldShowAvailability(t,n,d.viewMode==="project"?o.id:a.id)&&d.getAvailability(t,n,d.viewMode==="project"?o.id:a.id)>0)("cell-zero",d.shouldShowAvailability(t,n,d.viewMode==="project"?o.id:a.id)&&d.getAvailability(t,n,d.viewMode==="project"?o.id:a.id)===0)("cell-negative",d.shouldShowAvailability(t,n,d.viewMode==="project"?o.id:a.id)&&d.getAvailability(t,n,d.viewMode==="project"?o.id:a.id)<0),_e("data-week-index",e),c(2),g("ngIf",d.getResourceValue(t,n)>0),c(),g("ngIf",d.shouldShowAvailability(t,n,d.viewMode==="project"?o.id:a.id))}}function uu(i,r){if(i&1){let n=S();s(0,"div",91),v("mousedown",function(t){let o=f(n).$implicit,a=u(2).$implicit,d=u(2).$implicit,m=u(2);return h(m.onMouseDown(t,o,a,d))})("mousemove",function(t){let o=f(n).$implicit,a=u(2).$implicit,d=u(2).$implicit,m=u(2);return h(m.onMouseMove(t,o,a,d))})("mouseup",function(){f(n);let t=u(6);return h(t.onMouseUp())})("mouseleave",function(){f(n);let t=u(6);return h(t.onMouseUp())}),s(1,"div",92)(2,"div",93)(3,"div",94)(4,"div",95),y(5,"lucide-icon",96),l(),s(6,"span",97),p(7),l()(),s(8,"button",98),v("click",function(t){let o=f(n).$implicit,a=u(2).$implicit,d=u(2).$implicit;return u(2).removeResource(o,a,d),h(t.stopPropagation())}),p(9," \xD7 "),l()()(),s(10,"div",32),w(11,pu,4,13,"div",99),l(),s(12,"div",77)(13,"div",78)(14,"div",79)(15,"label"),p(16,"2025:"),l(),s(17,"span"),p(18),ce(19,"number"),l()(),s(20,"div",79)(21,"label"),p(22,"2026:"),l(),s(23,"span"),p(24),ce(25,"number"),l()()()()()}if(i&2){let n=r.$implicit,e=u(2).$implicit,t=u(2).$implicit,o=u(2);_e("data-resource-id",o.getResourceUniqueId(n,e,t)),c(4),z("background-color",n.color||"#e2e8f0"),c(),g("name",n.type==="role"?"contact":"user")("size",14),c(2),O(n.label),c(4),g("ngForOf",o.displayedWeeks),c(7),P("",de(19,9,o.getResourceMetricsYear(n,2025),"1.0-0"),"j"),c(6),P("",de(25,12,o.getResourceMetricsYear(n,2026),"1.0-0"),"j")}}function mu(i,r){if(i&1&&(be(0),w(1,uu,26,15,"div",90),we()),i&2){let n=u().$implicit;c(),g("ngForOf",n.resources)}}function gu(i,r){if(i&1){let n=S();be(0),s(1,"div",64)(2,"div",65)(3,"div",85),v("click",function(){let t=f(n).$implicit,o=u(4);return h(o.toggleChild(t))}),w(4,au,1,2,"lucide-icon",67),s(5,"div",68)(6,"div",69),y(7,"div",86),l(),s(8,"div",71),w(9,su,2,1,"span",72),s(10,"span",73),p(11),l()()(),s(12,"button",87),v("click",function(t){let o=f(n).$implicit,a=u(2).$implicit;return u(2).openAddResourceModal(o,a),h(t.stopPropagation())}),y(13,"lucide-icon",75),l()()(),s(14,"div",32),w(15,lu,1,0,"div",88),l(),s(16,"div",77)(17,"div",78)(18,"div",79)(19,"label"),p(20,"2025:"),l(),s(21,"span"),p(22),ce(23,"number"),l()(),s(24,"div",79)(25,"label"),p(26,"2026:"),l(),s(27,"span"),p(28),ce(29,"number"),l()()()()(),w(30,mu,2,1,"ng-container",43),we()}if(i&2){let n=r.$implicit,e=u(4);c(4),g("ngIf",n.resources.length>0),c(3),z("background-color",n.color||"#cbd5e1"),c(2),g("ngIf",n.code),c(2),O(n.label),c(2),g("img",e.Plus)("size",16),c(2),g("ngForOf",e.displayedWeeks),c(7),P("",de(23,11,e.getChildMetricsYear(n,2025),"1.0-0"),"j"),c(6),P("",de(29,14,e.getChildMetricsYear(n,2026),"1.0-0"),"j"),c(2),g("ngIf",n.expanded)}}function fu(i,r){if(i&1&&(be(0),w(1,gu,31,17,"ng-container",63),we()),i&2){let n=u().$implicit;c(),g("ngForOf",n.children)}}function hu(i,r){if(i&1){let n=S();be(0),s(1,"div",64)(2,"div",65)(3,"div",66),v("click",function(){let t=f(n).$implicit,o=u(2);return h(o.toggleRow(t))}),w(4,nu,1,2,"lucide-icon",67),s(5,"div",68)(6,"div",69),y(7,"div",70),l(),s(8,"div",71),w(9,iu,2,1,"span",72),s(10,"span",73),p(11),l()()(),s(12,"button",74),v("click",function(t){let o=f(n).$implicit;return u(2).openLinkModal(o),h(t.stopPropagation())}),y(13,"lucide-icon",75),l()()(),s(14,"div",32),w(15,ru,2,1,"div",76),l(),s(16,"div",77)(17,"div",78)(18,"div",79)(19,"label"),p(20,"2025:"),l(),s(21,"span"),p(22),ce(23,"number"),l()(),s(24,"div",79)(25,"label"),p(26,"2026:"),l(),s(27,"span"),p(28),ce(29,"number"),l()()()()(),w(30,fu,2,1,"ng-container",43),we()}if(i&2){let n=r.$implicit,e=u(2);c(4),g("ngIf",n.children.length>0),c(3),z("background-color",n.color||"#94a3b8"),c(2),g("ngIf",n.code),c(2),O(n.label),c(2),g("img",e.Plus)("size",18),c(2),g("ngForOf",e.displayedWeeks),c(7),P("",de(23,11,e.getRowMetricsYear(n,2025),"1.0-0"),"j"),c(6),P("",de(29,14,e.getRowMetricsYear(n,2026),"1.0-0"),"j"),c(2),g("ngIf",n.expanded)}}function _u(i,r){if(i&1&&(be(0),w(1,hu,31,17,"ng-container",63),we()),i&2){let n=u();c(),g("ngForOf",n.rows)}}function vu(i,r){if(i&1&&(s(0,"div",104),p(1),ce(2,"number"),l()),i&2){let n=u().$implicit,e=u().$implicit,t=u(2);c(),P(" ",de(2,1,t.getResourceValue(e.resource,n),"1.0-1")," ")}}function Cu(i,r){if(i&1&&(s(0,"div",105),p(1),ce(2,"number"),l()),i&2){let n=u().$implicit,e=u().$implicit,t=u(2);g("ngClass",vo(6,Cs,t.getAvailability(e.resource,n,t.viewMode==="project"?e.child.id:e.parent.id)>0,t.getAvailability(e.resource,n,t.viewMode==="project"?e.child.id:e.parent.id)===0,t.getAvailability(e.resource,n,t.viewMode==="project"?e.child.id:e.parent.id)<0)),c(),Se(" ",t.getAvailability(e.resource,n,t.viewMode==="project"?e.child.id:e.parent.id)>0?"+":"","",de(2,3,t.getAvailability(e.resource,n,t.viewMode==="project"?e.child.id:e.parent.id),"1.0-1")," ")}}function xu(i,r){if(i&1&&(s(0,"div",100)(1,"div",101),w(2,vu,3,4,"div",102)(3,Cu,3,10,"div",103),l()()),i&2){let n=r.$implicit,e=r.index,t=u().$implicit,o=u(2);$("selected",o.isCellSelected(t.resource,n))("has-capacity",o.getResourceValue(t.resource,n)>0)("cell-positive",o.shouldShowAvailability(t.resource,n,o.viewMode==="project"?t.child.id:t.parent.id)&&o.getAvailability(t.resource,n,o.viewMode==="project"?t.child.id:t.parent.id)>0)("cell-zero",o.shouldShowAvailability(t.resource,n,o.viewMode==="project"?t.child.id:t.parent.id)&&o.getAvailability(t.resource,n,o.viewMode==="project"?t.child.id:t.parent.id)===0)("cell-negative",o.shouldShowAvailability(t.resource,n,o.viewMode==="project"?t.child.id:t.parent.id)&&o.getAvailability(t.resource,n,o.viewMode==="project"?t.child.id:t.parent.id)<0),_e("data-week-index",e),c(2),g("ngIf",o.getResourceValue(t.resource,n)>0),c(),g("ngIf",o.shouldShowAvailability(t.resource,n,o.viewMode==="project"?t.child.id:t.parent.id))}}function bu(i,r){if(i&1){let n=S();s(0,"div",91),v("mousedown",function(t){let o=f(n).$implicit,a=u(2);return h(a.onMouseDown(t,o.resource,o.child,o.parent))})("mousemove",function(t){let o=f(n).$implicit,a=u(2);return h(a.onMouseMove(t,o.resource,o.child,o.parent))})("mouseup",function(){f(n);let t=u(2);return h(t.onMouseUp())})("mouseleave",function(){f(n);let t=u(2);return h(t.onMouseUp())}),s(1,"div",106)(2,"div",107),p(3),l()(),s(4,"div",32),w(5,xu,4,13,"div",99),l(),s(6,"div",77)(7,"div",78)(8,"div",79)(9,"label"),p(10,"2025:"),l(),s(11,"span"),p(12),ce(13,"number"),l()(),s(14,"div",79)(15,"label"),p(16,"2026:"),l(),s(17,"span"),p(18),ce(19,"number"),l()()()()()}if(i&2){let n=r.$implicit,e=u(2);_e("data-resource-id",e.getResourceUniqueId(n.resource,n.child,n.parent)),c(2),g("title",Vr(n.fullLabel)),c(),P(" ",n.fullLabel," "),c(2),g("ngForOf",e.displayedWeeks),c(7),P("",de(13,7,e.getFlatRowMetricsYear(n,2025),"1.0-0"),"j"),c(6),P("",de(19,10,e.getFlatRowMetricsYear(n,2026),"1.0-0"),"j")}}function wu(i,r){if(i&1&&(be(0),w(1,bu,20,13,"div",90),we()),i&2){let n=u();c(),g("ngForOf",n.flatRows)}}function yu(i,r){i&1&&(s(0,"div",108)(1,"p"),p(2,"Aucune donn\xE9e"),l()())}function Mu(i,r){i&1&&y(0,"span",119)}function Pu(i,r){i&1&&(s(0,"div",120),y(1,"div",119),s(2,"span"),p(3,"Mise \xE0 jour..."),l()())}function Su(i,r){if(i&1){let n=S();s(0,"div",109)(1,"div",110),p(2),s(3,"div",111),p(4),ce(5,"number"),l()(),s(6,"div",112)(7,"input",113,4),T("ngModelChange",function(t){f(n);let o=u();return E(o.bulkChargeValue,t)||(o.bulkChargeValue=t),h(t)}),v("keydown.enter",function(){f(n);let t=u();return h(t.applyBulkCharge())}),l()(),s(9,"div",114)(10,"button",115),v("click",function(){f(n);let t=u();return h(t.clearSelection())}),p(11,"Annuler"),l(),s(12,"button",116),v("click",function(){f(n);let t=u();return h(t.applyBulkCharge())}),w(13,Mu,1,0,"span",117),p(14),l()(),w(15,Pu,4,0,"div",118),l()}if(i&2){let n=u();z("top",n.toolbarPosition==null?null:n.toolbarPosition.top,"px")("left",n.toolbarPosition==null?null:n.toolbarPosition.left,"px")("transform",n.toolbarTransform)("opacity",n.toolbarVisible?1:0),c(2),P(" ",n.selectedCells.length," semaine(s) s\xE9lectionn\xE9e(s) "),c(2),P(" Total jours s\xE9lectionn\xE9s: ",de(5,16,n.totalSelectedDays,"1.1-1"),"j "),c(3),k("ngModel",n.bulkChargeValue),c(3),g("disabled",n.isSaving),c(2),g("disabled",n.isSaving),c(),g("ngIf",n.isSaving),c(),P(" ",n.isSaving?"Application...":"Appliquer"," "),c(),g("ngIf",n.isSaving)}}function Ou(i,r){if(i&1&&(s(0,"option",132),p(1),l()),i&2){let n=r.$implicit;g("value",n.id),c(),P(" ",n.label," ")}}function ku(i,r){if(i&1){let n=S();s(0,"div",121),v("click",function(){f(n);let t=u();return h(t.closeLinkModal())}),s(1,"div",122),v("click",function(t){return f(n),h(t.stopPropagation())}),s(2,"div",123)(3,"h2"),p(4),l(),s(5,"button",124),v("click",function(){f(n);let t=u();return h(t.closeLinkModal())}),p(6,"\xD7"),l()(),s(7,"div",125)(8,"div",126)(9,"label"),p(10),l(),s(11,"select",127),T("ngModelChange",function(t){f(n);let o=u();return E(o.selectedIdToLink,t)||(o.selectedIdToLink=t),h(t)}),s(12,"option",128),p(13,"-- Choisir --"),l(),w(14,Ou,2,2,"option",129),l()(),s(15,"div",130)(16,"button",131),v("click",function(){f(n);let t=u();return h(t.linkItem())}),p(17,"Ajouter"),l(),s(18,"button",15),v("click",function(){f(n);let t=u();return h(t.closeLinkModal())}),p(19,"Annuler"),l()()()()()}if(i&2){let n=u();c(4),Se(" ",n.viewMode==="project"?"Ajouter une \xE9quipe":"Ajouter un projet"," \xE0 ",n.selectedParentRow==null?null:n.selectedParentRow.label," "),c(6),O(n.viewMode==="project"?"S\xE9lectionner une \xE9quipe":"S\xE9lectionner un projet"),c(),k("ngModel",n.selectedIdToLink),c(3),g("ngForOf",n.linkableItems),c(2),g("disabled",!n.selectedIdToLink)}}function Eu(i,r){i&1&&(s(0,"div",138)(1,"p"),p(2,"Aucun r\xF4le disponible. Tous les r\xF4les sont d\xE9j\xE0 utilis\xE9s pour cette combinaison."),l()())}function Tu(i,r){if(i&1&&(s(0,"option",132),p(1),l()),i&2){let n=r.$implicit;g("value",n.id),c(),Se(" ",n.nom," (",n.jours_par_semaine,"j/sem) ")}}function Iu(i,r){if(i&1){let n=S();s(0,"select",127),T("ngModelChange",function(t){f(n);let o=u(3);return E(o.selectedResourceId,t)||(o.selectedResourceId=t),h(t)}),s(1,"option",128),p(2,"-- Choisir un r\xF4le --"),l(),w(3,Tu,2,3,"option",129),l()}if(i&2){let n=u(3);k("ngModel",n.selectedResourceId),c(3),g("ngForOf",n.availableRoles)}}function ju(i,r){if(i&1&&(s(0,"div",126)(1,"label"),p(2,"S\xE9lectionner un r\xF4le"),l(),w(3,Eu,3,0,"div",136)(4,Iu,4,2,"select",137),l()),i&2){let n=u(2);c(3),g("ngIf",n.availableRoles.length===0),c(),g("ngIf",n.availableRoles.length>0)}}function Ru(i,r){i&1&&(s(0,"div",138)(1,"p"),p(2,"Aucune personne disponible. Tous les personnes sont d\xE9j\xE0 utilis\xE9es pour cette combinaison."),l()())}function Vu(i,r){if(i&1&&(s(0,"option",132),p(1),l()),i&2){let n=r.$implicit;g("value",n.id),c(),Zn(" ",n.prenom," ",n.nom," (",n.jours_par_semaine,"j/sem) ")}}function Du(i,r){if(i&1){let n=S();s(0,"select",127),T("ngModelChange",function(t){f(n);let o=u(3);return E(o.selectedResourceId,t)||(o.selectedResourceId=t),h(t)}),s(1,"option",128),p(2,"-- Choisir une personne --"),l(),w(3,Vu,2,4,"option",129),l()}if(i&2){let n=u(3);k("ngModel",n.selectedResourceId),c(3),g("ngForOf",n.availablePersonnes)}}function Au(i,r){if(i&1&&(s(0,"div",126)(1,"label"),p(2,"S\xE9lectionner une personne"),l(),w(3,Ru,3,0,"div",136)(4,Du,4,2,"select",137),l()),i&2){let n=u(2);c(3),g("ngIf",n.availablePersonnes.length===0),c(),g("ngIf",n.availablePersonnes.length>0)}}function Nu(i,r){if(i&1){let n=S();s(0,"div",121),v("click",function(){f(n);let t=u();return h(t.closeAddResourceModal())}),s(1,"div",122),v("click",function(t){return f(n),h(t.stopPropagation())}),s(2,"div",123)(3,"h2"),p(4),l(),s(5,"button",124),v("click",function(){f(n);let t=u();return h(t.closeAddResourceModal())}),p(6,"\xD7"),l()(),s(7,"div",125)(8,"div",126)(9,"label"),p(10,"Type de ressource"),l(),s(11,"select",127),T("ngModelChange",function(t){f(n);let o=u();return E(o.resourceTypeToAdd,t)||(o.resourceTypeToAdd=t),h(t)}),s(12,"option",133),p(13,"R\xF4le"),l(),s(14,"option",134),p(15,"Personne"),l()()(),w(16,ju,5,2,"div",135)(17,Au,5,2,"div",135),s(18,"div",130)(19,"button",131),v("click",function(){f(n);let t=u();return h(t.addResourceToCharge())}),p(20," Ajouter "),l(),s(21,"button",15),v("click",function(){f(n);let t=u();return h(t.closeAddResourceModal())}),p(22,"Annuler"),l()()()()()}if(i&2){let n=u();c(4),P("Ajouter une Ressource \xE0 ",n.selectedChildRow==null?null:n.selectedChildRow.label),c(7),k("ngModel",n.resourceTypeToAdd),c(5),g("ngIf",n.resourceTypeToAdd==="role"),c(),g("ngIf",n.resourceTypeToAdd==="personne"),c(2),g("disabled",!n.selectedResourceId||n.resourceTypeToAdd==="role"&&n.availableRoles.length===0||n.resourceTypeToAdd==="personne"&&n.availablePersonnes.length===0)}}var Lu=(()=>{let r=class r{};r.\u0275fac=function(t){return new(t||r)},r.\u0275mod=Je({type:r}),r.\u0275inj=He({imports:[K.pick({Plus:Ye,ChevronDown:yt,ChevronRight:Mt,User:Ze,Contact:Gt}),K]});let i=r;return i})(),xs=(()=>{let r=class r{openMilestoneModal(e,t){t.stopPropagation(),this.selectedJalon=e,this.showMilestoneModal=!0}onMilestoneSaved(){return _(this,null,function*(){yield this.loadData()})}constructor(e,t,o,a,d){this.teamService=e,this.projetService=t,this.chargeService=o,this.calendarService=a,this.jalonService=d,this.showMilestoneModal=!1,this.selectedJalon=null,this.viewMode="project",this.displayFormat="tree",this.showAvailability=!1,this.flatRows=[],this.usageMap=new Map,this.displayedWeeks=[],this.currentDate=new Date,this.rows=[],this.allProjects=[],this.allEquipes=[],this.allCharges=[],this.allCapacities=[],this.allLinks=[],this.rowsAll=[],this.filterEquipeIds=[],this.filterProjetIds=[],this.filterResourceIds=[],this.openEquipeDropdown=!1,this.openProjetDropdown=!1,this.openResourceDropdown=!1,this.showLinkModal=!1,this.selectedParentRow=null,this.linkableItems=[],this.selectedIdToLink="",this.showAddResourceModal=!1,this.selectedChildRow=null,this.selectedParentForResource=null,this.resourceTypeToAdd="role",this.selectedResourceId="",this.availableRoles=[],this.availablePersonnes=[],this.isDragging=!1,this.dragStartResource=null,this.dragStartWeekIndex=-1,this.dragEndWeekIndex=-1,this.selectedCells=[],this.isSelectionFinished=!1,this.toolbarPosition=null,this.toolbarTransform="translate(-50%, 10px)",this.toolbarVisible=!1,this.bulkChargeValue=null,this.isSaving=!1,this.jalons=[],this.Plus=Ye,this.Contact=Gt,this.User=Ze}ngOnInit(){return _(this,null,function*(){this.generateWeeks(),yield this.loadData()})}generateWeeks(){this.displayedWeeks=[];let e=new Date(this.currentDate);e.setDate(1);let t=this.calendarService.getWeekStart(e);for(let o=0;o<32;o++){let a=new Date(t);a.setDate(a.getDate()+o*7),this.displayedWeeks.push(a)}}loadData(){return _(this,null,function*(){try{let[e,t,o,a,d,m,C,b]=yield Promise.all([this.projetService.getAllProjets(),this.teamService.getAllEquipes(),this.chargeService.getAllCharges(),this.teamService.getAllCapacities(),this.projetService.getAllEquipeProjetLinks(),this.teamService.getAllRoles(),this.teamService.getAllPersonnes(),this.jalonService.getAllJalons()]);this.allProjects=e,this.allEquipes=t,this.allCharges=o,this.allCapacities=a,this.allLinks=d,this.availableRoles=m,this.availablePersonnes=C,this.jalons=b,this.calculateUsage(),this.buildTree()}catch(e){console.error("Error loading data",e)}})}getJalonsForWeek(e){let t=new Date(e);t.setHours(0,0,0,0);let o=new Date(t);return o.setDate(t.getDate()+6),o.setHours(23,59,59,999),this.jalons.filter(a=>{let d=new Date(a.date_jalon);return d>=t&&d<=o})}getJalonColor(e){switch(e){case"LV":return"#d1fae5";case"MEP":return"#dbeafe";case"SP":return"#fef3c7";default:return"#f3f4f6"}}getJalonTextColor(e){switch(e){case"LV":return"#065f46";case"MEP":return"#1e40af";case"SP":return"#92400e";default:return"#4b5563"}}calculateUsage(){this.usageMap.clear();for(let e of this.allCharges){if(!e.semaine_debut||!e.equipe_id)continue;let t=e.semaine_debut.split("T")[0],o=e.equipe_id,a="";if(e.role_id)a=`role_${e.role_id}`;else if(e.personne_id)a=`personne_${e.personne_id}`;else continue;let d=`${o}_${a}_${t}`,m=this.usageMap.get(d)||0;this.usageMap.set(d,m+e.unite_ressource)}}getAvailability(e,t,o){let a=t.toISOString().split("T")[0],d=`${e.type}_${e.id}`,m=`${o}_${d}_${a}`,C=this.usageMap.get(m)||0,b=this.allCapacities.find(M=>M.equipe_id===o&&M.semaine_debut.startsWith(a)&&(e.type==="role"?M.role_id===e.id:M.personne_id===e.id));return(b?b.capacite:0)-C}shouldShowAvailability(e,t,o){let a=this.getResourceValue(e,t),d=this.getAvailability(e,t,o);return a>0||this.showAvailability&&d!==0}switchViewMode(e){this.viewMode=e,this.buildTree()}buildTree(){if(this.rows=[],this.viewMode==="project"){let e=[...this.allProjects].sort((t,o)=>t.nom_projet.localeCompare(o.nom_projet));for(let t of e){let o=this.allCharges.filter(x=>x.projet_id===t.id),a=o.map(x=>x.equipe_id).filter(x=>!!x),d=this.allLinks.filter(x=>x.projet_id===t.id).map(x=>x.equipe_id),m=new Set([...a,...d]),C=[],b=new Map;m.forEach(x=>{let M=this.allEquipes.find(U=>U.id===x),D=M?M.nom:"No Team",Q=M?M.color:void 0,ae=M?M.code:void 0,se=new Map,Me=o.filter(U=>U.equipe_id===x),Le=[],ve=new Map;Me.forEach(U=>{let $e,It,st,jt=0,Rt;if(U.role_id){$e=`role_${U.role_id}`;let W=this.availableRoles.find(Be=>Be.id===U.role_id);It=W?W.nom:"Unknown Role",jt=W?.jours_par_semaine||0,st="role",Rt=W?.color}else if(U.personne_id){$e=`personne_${U.personne_id}`;let W=this.availablePersonnes.find(Be=>Be.id===U.personne_id);It=W?`${W.prenom} ${W.nom}`:"Unknown Person",jt=W?.jours_par_semaine||0,st="personne",Rt=W?.color}else return;if(!ve.has($e)){let W=`${t.id}_${x}_${U.role_id||U.personne_id}_${st}`;ve.set($e,{id:U.role_id||U.personne_id||"",uniqueId:W,label:It,type:st,jours_par_semaine:jt,charges:new Map,color:Rt})}let fn=ve.get($e);if(U.semaine_debut){let W=U.semaine_debut.split("T")[0],Be=fn.charges.get(W)||0;fn.charges.set(W,Be+U.unite_ressource);let Qi=se.get(W)||0;se.set(W,Qi+U.unite_ressource);let Ki=b.get(W)||0;b.set(W,Ki+U.unite_ressource)}}),Le.push(...ve.values()),C.push({id:x,label:D,code:ae,color:Q,expanded:!0,resources:Le,charges:se})}),C.sort((x,M)=>x.label.localeCompare(M.label)),C.forEach(x=>{x.resources.sort((M,D)=>M.label.localeCompare(D.label))}),this.rows.push({id:t.id,label:t.nom_projet,code:t.code_projet,color:t.color,expanded:!0,children:C,totalCharges:b})}}else{let e=[...this.allEquipes].sort((t,o)=>t.nom.localeCompare(o.nom));for(let t of e){let o=this.allCharges.filter(x=>x.equipe_id===t.id),a=o.map(x=>x.projet_id).filter(x=>!!x),d=this.allLinks.filter(x=>x.equipe_id===t.id).map(x=>x.projet_id),m=new Set([...a,...d]),C=[],b=new Map;m.forEach(x=>{let M=this.allProjects.find(U=>U.id===x),D=M?M.nom_projet:"Unknown Project",Q=M?M.color:void 0,ae=M?M.code_projet:void 0,se=new Map,Me=o.filter(U=>U.projet_id===x),Le=[],ve=new Map;Me.forEach(U=>{let $e,It,st,jt=0,Rt;if(U.role_id){$e=`role_${U.role_id}`;let W=this.availableRoles.find(Be=>Be.id===U.role_id);It=W?W.nom:"Unknown Role",jt=W?.jours_par_semaine||0,st="role",Rt=W?.color}else if(U.personne_id){$e=`personne_${U.personne_id}`;let W=this.availablePersonnes.find(Be=>Be.id===U.personne_id);It=W?`${W.prenom} ${W.nom}`:"Unknown Person",jt=W?.jours_par_semaine||0,st="personne",Rt=W?.color}else return;if(!ve.has($e)){let W=`${t.id}_${x}_${U.role_id||U.personne_id}_${st}`;ve.set($e,{id:U.role_id||U.personne_id||"",uniqueId:W,label:It,type:st,jours_par_semaine:jt,charges:new Map,color:Rt})}let fn=ve.get($e);if(U.semaine_debut){let W=U.semaine_debut.split("T")[0],Be=fn.charges.get(W)||0;fn.charges.set(W,Be+U.unite_ressource);let Qi=se.get(W)||0;se.set(W,Qi+U.unite_ressource);let Ki=b.get(W)||0;b.set(W,Ki+U.unite_ressource)}}),Le.push(...ve.values()),C.push({id:x,label:D,code:ae,color:Q,expanded:!0,resources:Le,charges:se})}),C.sort((x,M)=>x.label.localeCompare(M.label)),C.forEach(x=>{x.resources.sort((M,D)=>M.label.localeCompare(D.label))}),this.rows.push({id:t.id,label:t.nom,code:t.code,color:t.color,expanded:!0,children:C,totalCharges:b})}}this.rowsAll=[...this.rows],this.applyFilters()}toggleDisplayFormat(e){this.displayFormat=e}buildFlatList(){this.flatRows=[];for(let e of this.rows)for(let t of e.children)for(let o of t.resources){let a="";this.viewMode==="project"?a=`${e.label} / ${t.label} / ${o.label}`:a=`${e.label} / ${t.label} / ${o.label}`,this.flatRows.push({uniqueId:o.uniqueId,fullLabel:a,resource:o,child:t,parent:e})}this.flatRows.sort((e,t)=>e.fullLabel.localeCompare(t.fullLabel))}goToToday(){this.currentDate=new Date,this.generateWeeks()}goToPreviousMonth(){this.currentDate.setMonth(this.currentDate.getMonth()-1),this.generateWeeks()}goToNextMonth(){this.currentDate.setMonth(this.currentDate.getMonth()+1),this.generateWeeks()}toggleRow(e){e.expanded=!e.expanded}toggleChild(e){e.expanded=!e.expanded}formatWeekHeader(e){return e.toLocaleDateString("fr-FR",{day:"2-digit",month:"short"})}getWeekNumber(e){return this.calendarService.getWeekNumber(e)}isCurrentWeek(e){return this.calendarService.isCurrentWeek(e)}getParentTotal(e,t){let o=t.toISOString().split("T")[0];return e.totalCharges.get(o)||0}getChildValue(e,t){let o=t.toISOString().split("T")[0];return e.charges.get(o)||0}getResourceValue(e,t){let o=t.toISOString().split("T")[0];return e.charges.get(o)||0}onGridScroll(e){let o=e.target.scrollLeft;this.headerScroll&&(this.headerScroll.nativeElement.scrollLeft=o),this.milestonesScroll&&(this.milestonesScroll.nativeElement.scrollLeft=o)}openLinkModal(e){this.selectedParentRow=e,this.selectedIdToLink="";let t=new Set(e.children.map(o=>o.id));this.viewMode==="project"?this.linkableItems=this.allEquipes.filter(o=>!t.has(o.id)).map(o=>({id:o.id,label:o.nom})):this.linkableItems=this.allProjects.filter(o=>!t.has(o.id)).map(o=>({id:o.id,label:o.nom_projet})),this.showLinkModal=!0}closeLinkModal(){this.showLinkModal=!1,this.selectedParentRow=null,this.selectedIdToLink=""}linkItem(){return _(this,null,function*(){if(!(!this.selectedParentRow||!this.selectedIdToLink))try{this.viewMode==="project"?yield this.projetService.linkProjectToTeam(this.selectedParentRow.id,this.selectedIdToLink):yield this.projetService.linkProjectToTeam(this.selectedIdToLink,this.selectedParentRow.id),yield this.loadData(),this.closeLinkModal()}catch(e){console.error("Error linking item:",e),alert("Erreur lors de l'ajout du lien.")}})}openAddResourceModal(e,t){return _(this,null,function*(){this.selectedChildRow=e,this.selectedParentForResource=t,this.resourceTypeToAdd="role",this.selectedResourceId="",this.showAddResourceModal=!0;let o,a;this.viewMode==="project"?(o=t.id,a=e.id):(a=t.id,o=e.id);try{this.availableRoles=yield this.chargeService.getAvailableRolesForProjectTeam(o,a),this.availablePersonnes=yield this.chargeService.getAvailablePersonnesForProjectTeam(o,a)}catch(d){console.error("Error loading available resources:",d),this.availableRoles=[],this.availablePersonnes=[]}})}closeAddResourceModal(){this.showAddResourceModal=!1,this.selectedChildRow=null,this.selectedParentForResource=null,this.selectedResourceId=""}addResourceToCharge(){return _(this,null,function*(){if(!(!this.selectedChildRow||!this.selectedParentForResource||!this.selectedResourceId))try{let e,t;this.viewMode==="project"?(e=this.selectedParentForResource.id,t=this.selectedChildRow.id):(t=this.selectedParentForResource.id,e=this.selectedChildRow.id);let o=this.resourceTypeToAdd==="role"?this.selectedResourceId:void 0,a=this.resourceTypeToAdd==="personne"?this.selectedResourceId:void 0;yield this.chargeService.createChargeWithoutDates(e,t,o,a),yield this.loadData(),this.closeAddResourceModal()}catch(e){console.error("Error adding resource:",e),alert("Erreur lors de l'ajout de la ressource.")}})}getResourceUniqueId(e,t,o){return`${o.id}_${t.id}_${e.id}_${e.type}`}onMouseDown(e,t,o,a){this.isDragging=!0,this.isSelectionFinished=!1,this.dragStartResource=t;let m=e.target.closest(".week-cell");if(m){let C=m.getAttribute("data-week-index");C&&(this.dragStartWeekIndex=parseInt(C,10),this.dragEndWeekIndex=this.dragStartWeekIndex,this.updateSelection(o,a))}}onMouseMove(e,t,o,a){if(!this.isDragging||!this.dragStartResource||t.uniqueId!==this.dragStartResource.uniqueId)return;let m=e.target.closest(".week-cell");if(m){let C=m.getAttribute("data-week-index");if(C){let b=parseInt(C,10);b!==this.dragEndWeekIndex&&(this.dragEndWeekIndex=b,this.updateSelection(o,a))}}}onMouseUp(){this.isDragging=!1,this.selectedCells.length>0&&(this.isSelectionFinished=!0,this.updateToolbarPosition())}updateToolbarPosition(){!this.dragStartResource||this.dragEndWeekIndex<0||setTimeout(()=>{let e=this.selectedCells[0];if(!e)return;let o=`[data-resource-id="${this.getResourceUniqueId(e.resource,{id:e.childId},{id:e.parentId})}"]`,a=document.querySelector(o);if(a){let d=`[data-week-index="${this.dragEndWeekIndex}"]`,m=a.querySelector(d);if(m){let C=m.getBoundingClientRect(),b=window.innerHeight,x=window.innerWidth,M=150,D=320,Q=b-C.bottom,ae=C.bottom,se=C.left+C.width/2,Me="translate(-50%, 10px)";if(Q<M){let Le=x-C.right,ve=C.left;({top:ae,left:se,transform:Me}=this.calculateBestPosition(Le,D,ve,ae,C,se,Me,M))}this.toolbarPosition={top:ae,left:se},this.toolbarTransform=Me,this.toolbarVisible=!0,setTimeout(()=>{this.bulkChargeInput?.nativeElement.focus()},50)}}},0)}calculateBestPosition(e,t,o,a,d,m,C,b){let x=this.dragStartWeekIndex-this.dragEndWeekIndex<=0,M=null;return x?e>t?M="RIGHT":o>t&&(M="LEFT"):o>t?M="LEFT":e>t&&(M="RIGHT"),M==="RIGHT"?(a=d.top+d.height/2,m=d.right,C="translate(10px, -50%)"):M==="LEFT"?(a=d.top+d.height/2,m=d.left,C="translate(calc(-100% - 10px), -50%)"):d.top>b&&(a=d.top,m=d.left+d.width/2,C="translate(-50%, calc(-100% - 10px))"),{top:a,left:m,transform:C}}updateSelection(e,t){if(!this.dragStartResource||this.dragStartWeekIndex<0||this.dragEndWeekIndex<0)return;this.selectedCells=[];let o=Math.min(this.dragStartWeekIndex,this.dragEndWeekIndex),a=Math.max(this.dragStartWeekIndex,this.dragEndWeekIndex);for(let d=o;d<=a;d++)this.selectedCells.push({resource:this.dragStartResource,week:this.displayedWeeks[d],childId:e.id,parentId:t.id})}isCellSelected(e,t){return this.selectedCells.some(o=>o.resource.uniqueId===e.uniqueId&&o.week.getTime()===t.getTime())}clearSelection(){this.selectedCells=[],this.isSelectionFinished=!1,this.toolbarPosition=null,this.toolbarVisible=!1,this.dragStartResource=null,this.dragStartWeekIndex=-1,this.dragEndWeekIndex=-1,this.bulkChargeValue=null}applyBulkCharge(){return _(this,null,function*(){if(!(this.selectedCells.length===0||this.bulkChargeValue==null)){this.isSaving=!0;try{for(let e of this.selectedCells){let t=e.week.toISOString().split("T")[0],o,a;this.viewMode==="project"?(o=e.parentId,a=e.childId):(a=e.parentId,o=e.childId);let d=e.resource.type==="role"?e.resource.id:void 0,m=e.resource.type==="personne"?e.resource.id:void 0;yield this.chargeService.createOrUpdateCharge(o,a,t,this.bulkChargeValue,d,m)}yield this.loadData(),this.clearSelection()}catch(e){console.error("Error applying bulk charge:",e),alert("Erreur lors de l'application des charges.")}finally{this.isSaving=!1}}})}onDocumentClick(e){e.target.closest(".filters-bar")||(this.openEquipeDropdown=!1,this.openProjetDropdown=!1,this.openResourceDropdown=!1)}toggleDropdown(e,t){t.stopPropagation(),e==="equipe"?(this.openEquipeDropdown=!this.openEquipeDropdown,this.openProjetDropdown=!1,this.openResourceDropdown=!1):e==="projet"?(this.openProjetDropdown=!this.openProjetDropdown,this.openEquipeDropdown=!1,this.openResourceDropdown=!1):(this.openResourceDropdown=!this.openResourceDropdown,this.openEquipeDropdown=!1,this.openProjetDropdown=!1)}onEquipeToggle(e,t){if(!e)return;t.target.checked?this.filterEquipeIds.push(e):this.filterEquipeIds=this.filterEquipeIds.filter(a=>a!==e),this.applyFilters()}onProjetToggle(e,t){if(!e)return;t.target.checked?this.filterProjetIds.push(e):this.filterProjetIds=this.filterProjetIds.filter(a=>a!==e),this.applyFilters()}onResourceToggle(e,t){t.target.checked?this.filterResourceIds.push(e):this.filterResourceIds=this.filterResourceIds.filter(a=>a!==e),this.applyFilters()}getEquipeName(e){let t=this.allEquipes.find(o=>o.id===e);return t?t.nom:"\u2014"}getProjetLabel(e){let t=this.allProjects.find(o=>o.id===e);return t?`${t.code_projet} \u2014 ${t.nom_projet}`:"\u2014"}getResourceLabel(e){let[t,o]=e.split(":");if(t==="role"){let d=this.availableRoles.find(m=>m.id===o);return d?`Role: ${d.nom}`:"Role: \u2014"}let a=this.availablePersonnes.find(d=>d.id===o);return a?`${a.prenom} ${a.nom}`:"Pers: \u2014"}applyFilters(){if(!this.filterEquipeIds.length&&!this.filterProjetIds.length&&!this.filterResourceIds.length){this.rows=[...this.rowsAll],this.buildFlatList();return}let e=[];for(let t of this.rowsAll){let o={id:t.id,label:t.label,expanded:t.expanded,children:[],totalCharges:t.totalCharges};for(let C of t.children){let b=C.resources;this.filterResourceIds.length&&(b=C.resources.filter(ae=>this.filterResourceIds.some(se=>{let[Me,Le]=se.split(":");return Me==="role"&&ae.type==="role"&&ae.id===Le||Me==="personne"&&ae.type==="personne"&&ae.id===Le})));let x=!0,M=!0;this.filterEquipeIds.length&&(this.viewMode==="project"?x=this.filterEquipeIds.includes(C.id):x=!0),this.filterProjetIds.length&&(this.viewMode==="team"?M=this.filterProjetIds.includes(C.id):M=!0);let D=this.filterResourceIds.length?b.length>0:!0;x&&M&&D&&o.children.push({id:C.id,label:C.label,expanded:C.expanded,resources:b,charges:C.charges})}let a=!0,d=!0;this.filterEquipeIds.length&&(this.viewMode==="team"?a=this.filterEquipeIds.includes(t.id):a=!0),this.filterProjetIds.length&&(this.viewMode==="project"?d=this.filterProjetIds.includes(t.id):d=!0);let m=o.children.length>0;a&&d&&m&&e.push(o)}this.rows=e,this.buildFlatList()}getRowMetricsYear(e,t){let o=0;for(let a of e.children)o+=this.getChildMetricsYear(a,t);return o}getChildMetricsYear(e,t){let o=0;for(let a of e.resources)o+=this.getResourceMetricsYear(a,t);return o}getResourceMetricsYear(e,t){let o=0;for(let[a,d]of e.charges)new Date(a).getFullYear()===t&&(o+=d*e.jours_par_semaine);return o}getFlatRowMetricsYear(e,t){return this.getResourceMetricsYear(e.resource,t)}get totalSelectedDays(){let e=0;for(let t of this.selectedCells){let o=this.getResourceValue(t.resource,t.week)||0,a=t.resource.jours_par_semaine||0;e+=o*a}return e}removeResource(e,t,o){return _(this,null,function*(){let a=`\xCAtes-vous s\xFBr de vouloir supprimer "${e.label}" ?
Cela supprimera toutes les charges associ\xE9es \xE0 cette ressource.`;if(confirm(a))try{this.allCharges=this.allCharges.filter(d=>!(d.role_id===e.id&&e.type==="role"||d.personne_id===e.id&&e.type==="personne")),this.calculateUsage(),this.buildTree()}catch(d){console.error("Error removing resource:",d),alert("Erreur lors de la suppression de la ressource.")}})}};r.\u0275fac=function(t){return new(t||r)(R(Et),R(at),R(Gi),R($i),R(Tt))},r.\u0275cmp=B({type:r,selectors:[["app-plan-view"]],viewQuery:function(t,o){if(t&1&&(At(Ap,5),At(Np,5),At(Lp,5),At(zp,5)),t&2){let a;mt(a=gt())&&(o.bulkChargeInput=a.first),mt(a=gt())&&(o.headerScroll=a.first),mt(a=gt())&&(o.dataScroll=a.first),mt(a=gt())&&(o.milestonesScroll=a.first)}},hostBindings:function(t,o){t&1&&v("click",function(d){return o.onDocumentClick(d)},Qn)},decls:85,vars:38,consts:[["filtersContainer",""],["headerScroll",""],["milestonesScroll",""],["dataScroll",""],["bulkChargeInput",""],[1,"capacity-container"],[1,"capacity-header"],[1,"header-actions"],[1,"view-mode-toggle"],[1,"btn",3,"click"],[1,"toggle-container"],[1,"toggle-label"],[1,"switch"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"slider","round"],[1,"btn","btn-secondary",3,"click"],[1,"calendar-controls"],[1,"date-navigation"],[1,"btn","btn-sm",3,"click"],[1,"btn","btn-sm","btn-primary",3,"click"],[1,"filters-bar"],[1,"filter-pill",3,"click"],[1,"filter-title"],[1,"chip-list"],["class","chip",4,"ngFor","ngForOf"],["class","chip placeholder",4,"ngIf"],["class","filters-dropdown",3,"click",4,"ngIf"],[1,"calendar-container"],[1,"calendar-header-wrapper"],[1,"row-label","fixed-column","header-fixed"],[2,"font-weight","600"],[1,"header-scroll-container"],[1,"row-cells","scrollable-column"],["class","week-header",3,"current-week",4,"ngFor","ngForOf"],[1,"metrics-header-fixed"],[2,"font-weight","600","font-size","12px"],[1,"milestones-header-wrapper"],[1,"row-label","fixed-column","header-fixed","milestones-fixed-col"],[2,"font-weight","600","font-size","13px"],["class","week-cell milestone-week-cell",3,"current-week",4,"ngFor","ngForOf"],[1,"metrics-header-fixed","milestones-metrics-fixed"],[1,"calendar-grid-wrapper"],[1,"calendar-grid",3,"scroll"],[4,"ngIf"],["class","empty-state",4,"ngIf"],["class","selection-toolbar",3,"top","left","transform","opacity",4,"ngIf"],["class","modal-overlay",3,"click",4,"ngIf"],[3,"visibleChange","saved","visible","jalon","projets"],[1,"chip"],[1,"chip","placeholder"],[1,"filters-dropdown",3,"click"],[1,"dropdown-list"],["class","dropdown-item",4,"ngFor","ngForOf"],[1,"dropdown-item"],["type","checkbox",3,"change","value","checked"],[1,"dropdown-group"],[1,"week-header"],[1,"week-date"],[1,"week-number"],[1,"week-cell","milestone-week-cell"],[1,"milestones-container"],["class","jalon-item",3,"background-color","color","title","click",4,"ngFor","ngForOf"],[1,"jalon-item",3,"click","title"],[4,"ngFor","ngForOf"],[1,"calendar-row-wrapper"],[1,"row-label","fixed-column","px-0"],[1,"row-label-content",3,"click"],["class","expand-icon-l",3,"name","size",4,"ngIf"],[1,"row-info-stack-wrapper"],[1,"color-bar-container"],[1,"color-bar-v"],[1,"info-stack"],["class","info-code",4,"ngIf"],[1,"info-label"],["title","Ajouter",1,"btn-hover-add",3,"click"],[3,"img","size"],["class","week-cell team-cell",4,"ngFor","ngForOf"],[1,"metrics-cell"],[1,"metrics-group"],[1,"metric-row"],[1,"expand-icon-l",3,"name","size"],[1,"info-code"],[1,"week-cell","team-cell"],["class","team-summary",4,"ngIf"],[1,"team-summary"],[1,"row-label-content","child-row",2,"padding-left","24px",3,"click"],[1,"color-bar-v","small"],["title","Ajouter ressource",1,"btn-hover-add",3,"click"],["class","week-cell resource-cell",4,"ngFor","ngForOf"],[1,"week-cell","resource-cell"],["class","calendar-row-wrapper",3,"mousedown","mousemove","mouseup","mouseleave",4,"ngFor","ngForOf"],[1,"calendar-row-wrapper",3,"mousedown","mousemove","mouseup","mouseleave"],[1,"row-label","fixed-column","row-detail","px-0"],[1,"row-label-content","resource-row"],[1,"resource-detail-label",2,"padding-left","40px"],[1,"resource-icon-wrapper"],[1,"resource-icon",3,"name","size"],[1,"resource-detail-name"],["title","Supprimer cette ressource",1,"btn-hover-delete",3,"click"],["class","week-cell resource-detail-cell",3,"selected","has-capacity","cell-positive","cell-zero","cell-negative",4,"ngFor","ngForOf"],[1,"week-cell","resource-detail-cell"],[1,"cell-content"],["class","capacity-value",4,"ngIf"],["class","availability-indicator",3,"ngClass",4,"ngIf"],[1,"capacity-value"],[1,"availability-indicator",3,"ngClass"],[1,"row-label","fixed-column","row-detail"],[2,"padding","0 16px","font-weight","500","font-size","13px","white-space","nowrap","overflow","hidden","text-overflow","ellipsis",3,"title"],[1,"empty-state"],[1,"selection-toolbar"],[1,"selection-info"],[1,"selection-total"],[1,"selection-input-row"],["type","number","placeholder","Charge (unit\xE9s)","step","0.5","min","0",1,"bulk-input",3,"ngModelChange","keydown.enter","ngModel"],[1,"selection-actions"],[1,"btn","btn-sm","btn-secondary",3,"click","disabled"],[1,"btn","btn-sm","btn-primary",3,"click","disabled"],["class","spinner-small",4,"ngIf"],["class","loading-overlay-local",4,"ngIf"],[1,"spinner-small"],[1,"loading-overlay-local"],[1,"modal-overlay",3,"click"],[1,"modal",3,"click"],[1,"modal-header"],[1,"modal-close",3,"click"],[1,"modal-body"],[1,"form-group"],[1,"form-control",3,"ngModelChange","ngModel"],["value",""],[3,"value",4,"ngFor","ngForOf"],[1,"modal-actions"],[1,"btn","btn-primary",3,"click","disabled"],[3,"value"],["value","role"],["value","personne"],["class","form-group",4,"ngIf"],["class","no-roles-message",4,"ngIf"],["class","form-control",3,"ngModel","ngModelChange",4,"ngIf"],[1,"no-roles-message"]],template:function(t,o){if(t&1){let a=S();s(0,"div",5)(1,"div",6)(2,"h1"),p(3,"Vue Planification"),l(),s(4,"div",7)(5,"div",8)(6,"button",9),v("click",function(){return f(a),h(o.switchViewMode("project"))}),p(7," Par Projet "),l(),s(8,"button",9),v("click",function(){return f(a),h(o.switchViewMode("team"))}),p(9," Par \xC9quipe "),l()(),s(10,"div",8)(11,"button",9),v("click",function(){return f(a),h(o.toggleDisplayFormat("tree"))}),p(12," Arborescence "),l(),s(13,"button",9),v("click",function(){return f(a),h(o.toggleDisplayFormat("flat"))}),p(14," \xC0 plat "),l()(),s(15,"div",10)(16,"span",11),p(17,"Dispo."),l(),s(18,"label",12)(19,"input",13),T("ngModelChange",function(m){return f(a),E(o.showAvailability,m)||(o.showAvailability=m),h(m)}),l(),y(20,"span",14),l()(),s(21,"button",15),v("click",function(){return f(a),h(o.goToToday())}),p(22,"Aujourd'hui"),l()()(),s(23,"div",16)(24,"div",17)(25,"button",18),v("click",function(){return f(a),h(o.goToPreviousMonth())}),p(26,"\u2190 Mois pr\xE9c\xE9dent"),l(),s(27,"button",19),v("click",function(){return f(a),h(o.goToToday())}),p(28,"Aujourd'hui"),l(),s(29,"button",18),v("click",function(){return f(a),h(o.goToNextMonth())}),p(30,"Mois suivant \u2192"),l()(),s(31,"div",20,0)(33,"div",21),v("click",function(m){return f(a),h(o.toggleDropdown("equipe",m))}),s(34,"span",22),p(35,"\xC9quipes"),l(),s(36,"span",23),w(37,Fp,2,1,"span",24)(38,qp,2,0,"span",25),l()(),s(39,"div",21),v("click",function(m){return f(a),h(o.toggleDropdown("projet",m))}),s(40,"span",22),p(41,"Projets"),l(),s(42,"span",23),w(43,Up,2,1,"span",24)(44,Wp,2,0,"span",25),l()(),s(45,"div",21),v("click",function(m){return f(a),h(o.toggleDropdown("resource",m))}),s(46,"span",22),p(47,"R\xF4le / Personne"),l(),s(48,"span",23),w(49,$p,2,1,"span",24)(50,Bp,2,0,"span",25),l()(),w(51,Gp,3,1,"div",26)(52,Yp,3,1,"div",26)(53,Zp,8,2,"div",26),l()(),s(54,"div",27)(55,"div",28)(56,"div",29)(57,"span",30),p(58),l()(),s(59,"div",31,1)(61,"div",32),w(62,Xp,5,4,"div",33),l()(),s(63,"div",34)(64,"div",35),p(65,"M\xE9triques"),l()()(),s(66,"div",36)(67,"div",37)(68,"span",38),p(69,"Jalons"),l()(),s(70,"div",31,2)(72,"div",32),w(73,tu,3,3,"div",39),l()(),y(74,"div",40),l(),s(75,"div",41)(76,"div",42,3),v("scroll",function(m){return f(a),h(o.onGridScroll(m))}),w(78,_u,2,1,"ng-container",43)(79,wu,2,1,"ng-container",43)(80,yu,3,0,"div",44),l()(),w(81,Su,16,19,"div",45),l(),w(82,ku,20,6,"div",46)(83,Nu,23,5,"div",46),s(84,"app-milestone-modal",47),T("visibleChange",function(m){return f(a),E(o.showMilestoneModal,m)||(o.showMilestoneModal=m),h(m)}),v("saved",function(){return f(a),h(o.onMilestoneSaved())}),l()()}t&2&&(c(6),$("btn-primary",o.viewMode==="project")("btn-secondary",o.viewMode!=="project"),c(2),$("btn-primary",o.viewMode==="team")("btn-secondary",o.viewMode!=="team"),c(3),$("btn-primary",o.displayFormat==="tree")("btn-secondary",o.displayFormat!=="tree"),c(2),$("btn-primary",o.displayFormat==="flat")("btn-secondary",o.displayFormat!=="flat"),c(6),k("ngModel",o.showAvailability),c(18),g("ngForOf",o.filterEquipeIds),c(),g("ngIf",o.filterEquipeIds.length===0),c(5),g("ngForOf",o.filterProjetIds),c(),g("ngIf",o.filterProjetIds.length===0),c(5),g("ngForOf",o.filterResourceIds),c(),g("ngIf",o.filterResourceIds.length===0),c(),g("ngIf",o.openEquipeDropdown),c(),g("ngIf",o.openProjetDropdown),c(),g("ngIf",o.openResourceDropdown),c(5),O(o.viewMode==="project"?"Projets / \xC9quipes":"\xC9quipes / Projets"),c(4),g("ngForOf",o.displayedWeeks),c(11),g("ngForOf",o.displayedWeeks),c(5),g("ngIf",o.displayFormat==="tree"),c(),g("ngIf",o.displayFormat==="flat"),c(),g("ngIf",o.rows.length===0),c(),g("ngIf",o.selectedCells.length>0&&o.isSelectionFinished),c(),g("ngIf",o.showLinkModal),c(),g("ngIf",o.showAddResourceModal),c(),k("visible",o.showMilestoneModal),g("jalon",o.selectedJalon)("projets",o.allProjects))},dependencies:[G,ni,Oe,te,X,qe,Ue,ie,Pt,di,Fe,oe,Zt,re,Lu,ne,Yi,ii],styles:['.capacity-container[_ngcontent-%COMP%]{padding:20px;background:#f5f7fa;min-height:100vh;display:flex;flex-direction:column;overflow-x:hidden}.capacity-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:24px}.header-actions[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center}.view-mode-toggle[_ngcontent-%COMP%]{display:flex;background:#e2e8f0;padding:4px;border-radius:8px;gap:4px;margin-right:16px}.view-mode-toggle[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{padding:6px 12px;font-size:14px;border:none;border-radius:6px;cursor:pointer}.view-mode-toggle[_ngcontent-%COMP%]   .btn-primary[_ngcontent-%COMP%]{background:#fff;color:#1e293b;box-shadow:0 1px 3px #0000001a;font-weight:600}.view-mode-toggle[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]{background:transparent;color:#64748b}.calendar-controls[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px;padding:16px;background:#fff;border-radius:8px;box-shadow:0 1px 3px #0000001a}.date-navigation[_ngcontent-%COMP%]{display:flex;gap:8px}.filters-bar[_ngcontent-%COMP%]{display:flex;gap:12px;align-items:center;position:relative}.filter-pill[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:8px 12px;background:#fff;border:1px solid #e5e7eb;border-radius:999px;cursor:pointer;box-shadow:0 1px 2px #10182808;min-width:140px}.filter-title[_ngcontent-%COMP%]{font-weight:600;color:#374151;font-size:13px}.chip-list[_ngcontent-%COMP%]{display:flex;gap:6px;flex-wrap:wrap}.chip[_ngcontent-%COMP%]{background:#eef2ff;color:#3730a3;padding:4px 8px;border-radius:999px;font-size:12px}.chip.placeholder[_ngcontent-%COMP%]{background:transparent;color:#94a3b8}.filters-dropdown[_ngcontent-%COMP%]{position:absolute;top:48px;left:0;background:#fff;border:1px solid #e5e7eb;border-radius:8px;box-shadow:0 6px 20px #02061714;padding:8px;z-index:1200;max-height:320px;overflow:auto;min-width:260px}.dropdown-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px;padding:4px}.dropdown-item[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:13px;padding:6px;border-radius:6px}.dropdown-item[_ngcontent-%COMP%]:hover{background:#f8fafc}.dropdown-group[_ngcontent-%COMP%]{font-size:12px;color:#6b7280;padding:8px 4px 2px}.btn[_ngcontent-%COMP%]{padding:8px 16px;border-radius:6px;border:1px solid transparent;cursor:pointer;font-weight:500;transition:all .2s}.btn-sm[_ngcontent-%COMP%]{padding:6px 12px;font-size:13px}.btn-xs[_ngcontent-%COMP%]{padding:2px 4px;font-size:11px}.row-label-content[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;width:100%;height:100%;cursor:pointer;padding:0 12px;position:relative}.row-label-content[_ngcontent-%COMP%]:hover{background-color:#f1f5f9}.row-info-stack-wrapper[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;flex:1;overflow:hidden}.color-bar-container[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;width:12px}.color-bar-v[_ngcontent-%COMP%]{width:6px;height:32px;border-radius:3px;flex-shrink:0}.color-bar-v.small[_ngcontent-%COMP%]{height:24px;width:4px}.info-stack[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1px;overflow:hidden}.info-code[_ngcontent-%COMP%]{font-family:JetBrains Mono,Cascadia Code,monospace;font-size:10px;font-weight:600;color:#94a3b8;letter-spacing:.5px;text-transform:uppercase;white-space:nowrap}.resource-detail-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px;overflow:hidden}.resource-icon-wrapper[_ngcontent-%COMP%]{width:24px;height:24px;border-radius:6px;display:flex;align-items:center;justify-content:center;flex-shrink:0;color:#fff}.resource-icon[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center}.resource-detail-name[_ngcontent-%COMP%]{font-size:14px;color:#334155;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.info-label[_ngcontent-%COMP%]{font-size:13px;font-weight:700;color:#1e293b;white-space:nowrap;overflow:hidden;text-overflow:ellipsis}.btn-hover-add[_ngcontent-%COMP%]{background:transparent;border:none;color:#64748b;cursor:pointer;padding:6px;border-radius:4px;display:flex;align-items:center;justify-content:center;opacity:0;position:absolute;right:12px}.row-label-content[_ngcontent-%COMP%]:hover   .btn-hover-add[_ngcontent-%COMP%]{opacity:1}.btn-hover-add[_ngcontent-%COMP%]:hover{background-color:#e2e8f0;color:#0f172a}.btn-hover-delete[_ngcontent-%COMP%]{background:transparent;border:none;color:#ef4444;cursor:pointer;padding:4px 8px;border-radius:4px;display:flex;align-items:center;justify-content:center;font-size:18px;font-weight:700;opacity:0;position:absolute;right:12px}.row-label-content[_ngcontent-%COMP%]:hover   .btn-hover-delete[_ngcontent-%COMP%]{opacity:1}.btn-hover-delete[_ngcontent-%COMP%]:hover{background-color:#fee2e2;color:#b91c1c}.px-0[_ngcontent-%COMP%]{padding-left:0!important;padding-right:0!important}.btn-danger[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;background:#fecaca;color:#991b1b;border:1px solid #fca5a5;padding:2px 6px;border-radius:4px;cursor:pointer;font-size:16px;line-height:1}.btn-danger[_ngcontent-%COMP%]:hover{background:#fca5a5;color:#7f1d1d}.btn-primary[_ngcontent-%COMP%]{background:#3b82f6;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{background:#2563eb}.btn-secondary[_ngcontent-%COMP%]{background:#fff;border:1px solid #d1d5db;color:#374151}.btn-secondary[_ngcontent-%COMP%]:hover{background:#f3f4f6}.calendar-wrapper[_ngcontent-%COMP%]{display:flex;background:#fff;border-radius:8px;box-shadow:0 1px 3px #0000001a;overflow:hidden;max-height:calc(100vh - 250px);position:relative}.calendar-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1;background:#fff;border-radius:8px;box-shadow:0 1px 3px #0000001a;overflow:hidden;max-height:calc(100vh - 250px)}.calendar-header-wrapper[_ngcontent-%COMP%]{display:flex;border-bottom:2px solid #e2e8f0;min-height:60px;background:#f9fafb;flex-shrink:0}.milestones-header-wrapper[_ngcontent-%COMP%]{display:flex;border-bottom:2px solid #e2e8f0;min-height:40px;background:#fff;flex-shrink:0}.milestones-fixed-col[_ngcontent-%COMP%]{background:#fff}.milestones-metrics-fixed[_ngcontent-%COMP%]{background:#fff;border-left:2px solid #e2e8f0;width:200px;flex-shrink:0}.milestone-week-cell[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;padding:2px;background:#fff;border-right:1px solid #e2e8f0}.milestones-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:2px;justify-content:center;width:100%}.jalon-item[_ngcontent-%COMP%]{font-size:10px;font-weight:700;padding:3px 6px;border-radius:12px;cursor:help;box-shadow:0 1px 2px #0000000d;display:inline-flex;align-items:center;justify-content:center;min-width:20px;line-height:1.2;text-align:center;white-space:nowrap}.header-fixed[_ngcontent-%COMP%]{display:flex;align-items:center;padding:0 16px;background:#f9fafb;border-right:2px solid #e2e8f0;z-index:10}.header-scroll-container[_ngcontent-%COMP%]{flex:1;overflow-x:hidden;overflow-y:hidden;display:flex}.metrics-header-fixed[_ngcontent-%COMP%]{width:200px;flex-shrink:0;padding:0 16px;display:flex;align-items:center;justify-content:center;background:#f9fafb;border-left:2px solid #e2e8f0;z-index:10;text-align:center}.calendar-row-wrapper[_ngcontent-%COMP%]{display:flex;min-height:48px}.calendar-grid-wrapper[_ngcontent-%COMP%]{display:flex;flex:1;position:relative;overflow:hidden}.row-label[_ngcontent-%COMP%]{display:flex;align-items:center;padding:0 16px;border-bottom:1px solid #e2e8f0}.fixed-column[_ngcontent-%COMP%]{width:300px;flex-shrink:0;border-right:2px solid #e2e8f0;background:#f9fafb;position:sticky;left:0;z-index:5}.calendar-row-wrapper[_ngcontent-%COMP%]   .row-label.fixed-column.row-detail[_ngcontent-%COMP%]{background:#fff}.row-cells[_ngcontent-%COMP%]{display:flex;flex:1;border-bottom:1px solid #e2e8f0}.scrollable-column[_ngcontent-%COMP%]{position:relative}.metrics-cell[_ngcontent-%COMP%]{width:200px;flex-shrink:0;padding:12px 16px;border-left:2px solid #e2e8f0;background:#fff;position:sticky;right:0;z-index:8;display:flex;align-items:center;justify-content:center;min-height:48px;font-size:12px}.metrics-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px}.metric-row[_ngcontent-%COMP%]{display:flex;justify-content:space-between;gap:12px}.metric-row[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{font-weight:600;color:#374151;min-width:50px}.metric-row[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{font-weight:500;color:#1e293b}.calendar-grid[_ngcontent-%COMP%]{display:flex;flex-direction:column;flex:1;overflow-x:auto;overflow-y:auto}.calendar-row-wrapper[_ngcontent-%COMP%]   .fixed-column[_ngcontent-%COMP%]{background:#f9fafb}.week-header[_ngcontent-%COMP%]{min-width:80px;width:80px;padding:8px;border-right:1px solid #e2e8f0;text-align:center;display:flex;flex-direction:column;align-items:center;justify-content:center;flex-shrink:0;font-weight:600;background:#f9fafb}.week-date[_ngcontent-%COMP%]{font-size:12px;color:#6b7280}.week-number[_ngcontent-%COMP%]{font-size:13px;font-weight:700;color:#374151}.week-header.current-week[_ngcontent-%COMP%]{background:#dbeafe;border-left:3px solid #3b82f6}.week-cell[_ngcontent-%COMP%]{min-width:80px;width:80px;padding:8px;border-right:1px solid #e2e8f0;text-align:center;display:flex;align-items:center;justify-content:center;flex-shrink:0}.team-cell[_ngcontent-%COMP%]{background:#f9fafb}.resource-cell[_ngcontent-%COMP%]{background:#f9fafb;transition:background .15s ease}.resource-cell.has-capacity[_ngcontent-%COMP%]{background:#d1fae5;font-weight:600;color:#059669}.cell-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:center;justify-content:center;line-height:1.1;-webkit-user-select:none;user-select:none}.capacity-value[_ngcontent-%COMP%]{font-size:13px;font-weight:600}.team-summary[_ngcontent-%COMP%]{color:#6b7280;display:flex;flex-direction:column;align-items:center;justify-content:center;line-height:1.1;-webkit-user-select:none;user-select:none}.empty-state-weeks[_ngcontent-%COMP%]{padding:40px;text-align:center;color:#6b7280}.modal-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;background:#00000080;display:flex;align-items:center;justify-content:center;z-index:2000}.modal[_ngcontent-%COMP%]{background:#fff;border-radius:12px;min-width:400px;max-width:90vw;max-height:90vh;overflow:auto}.modal-header[_ngcontent-%COMP%]{padding:20px 24px;border-bottom:1px solid #e2e8f0;display:flex;justify-content:space-between;align-items:center}.modal-header[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{margin:0;font-size:18px}.modal-close[_ngcontent-%COMP%]{background:none;border:none;font-size:24px;cursor:pointer;color:#6b7280;padding:0;width:32px;height:32px;display:flex;align-items:center;justify-content:center;border-radius:4px}.modal-close[_ngcontent-%COMP%]:hover{background:#f3f4f6}.modal-body[_ngcontent-%COMP%]{padding:24px}.form-group[_ngcontent-%COMP%]{margin-bottom:16px}.form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:8px;font-weight:500;color:#374151}.form-control[_ngcontent-%COMP%]{width:100%;padding:8px 12px;border:1px solid #d1d5db;border-radius:6px;font-size:14px}.modal-actions[_ngcontent-%COMP%]{display:flex;gap:12px;margin-top:24px;justify-content:flex-end}.no-roles-message[_ngcontent-%COMP%]{padding:9px;background:#fef3c7;border:1px solid #f59e0b;border-radius:6px;color:#92400e;text-align:center}.no-roles-message[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin:0;font-size:14px}.resource-detail-cell[_ngcontent-%COMP%]{cursor:crosshair;position:relative}.resource-detail-cell[_ngcontent-%COMP%]:hover{background:#f3f4f6}.resource-detail-cell.selected[_ngcontent-%COMP%]{background:#dbeafe;border:2px solid #3b82f6}.resource-detail-cell.has-capacity.selected[_ngcontent-%COMP%]{background:#bfdbfe;border:2px solid #3b82f6}.availability-indicator[_ngcontent-%COMP%]{font-size:10px;margin-top:2px;font-weight:500}.availability-positive[_ngcontent-%COMP%]{color:#059669}.cell-positive[_ngcontent-%COMP%]{background:#d1fae5!important}.cell-zero[_ngcontent-%COMP%]{background:#fef3c7!important}.cell-negative[_ngcontent-%COMP%]{background:#fee2e2!important}.text-positive[_ngcontent-%COMP%]{color:#059669}.text-zero[_ngcontent-%COMP%]{color:#d97706}.text-negative[_ngcontent-%COMP%]{color:#dc2626}.selection-toolbar[_ngcontent-%COMP%]{position:fixed;background:#fff;padding:16px 24px;border-radius:12px;box-shadow:0 10px 25px #0003;align-items:center;gap:16px;z-index:1000;transition:top .2s ease,left .2s ease;min-width:260px}.selection-info[_ngcontent-%COMP%]{font-weight:600;color:#374151;margin-bottom:8px}.selection-total[_ngcontent-%COMP%]{font-weight:500;font-size:13px;margin-top:6px;margin-bottom:10px;color:#065f46}.selection-input-row[_ngcontent-%COMP%]{margin-bottom:12px}.selection-input-row[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{width:100%}.selection-actions[_ngcontent-%COMP%]{display:flex;gap:8px;align-items:center;justify-content:center}.selection-actions[_ngcontent-%COMP%]   button[_ngcontent-%COMP%]{flex:1}.bulk-input[_ngcontent-%COMP%]{width:100%;padding:6px 12px;border:1px solid #d1d5db;border-radius:6px}.toggle-container[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;background:#fff;padding:4px 12px;border-radius:8px;border:1px solid #e5e7eb;height:38px}.toggle-label[_ngcontent-%COMP%]{font-size:13px;font-weight:500;color:#374151}.switch[_ngcontent-%COMP%]{position:relative;display:inline-block;width:32px;height:18px}.switch[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{opacity:0;width:0;height:0}.slider[_ngcontent-%COMP%]{position:absolute;cursor:pointer;inset:0;background-color:#ccc;-webkit-transition:.4s;transition:.4s;border-radius:34px}.slider[_ngcontent-%COMP%]:before{position:absolute;content:"";height:14px;width:14px;left:2px;bottom:2px;background-color:#fff;-webkit-transition:.4s;transition:.4s;border-radius:50%}input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]{background-color:#3b82f6}input[_ngcontent-%COMP%]:focus + .slider[_ngcontent-%COMP%]{box-shadow:0 0 1px #3b82f6}input[_ngcontent-%COMP%]:checked + .slider[_ngcontent-%COMP%]:before{-webkit-transform:translateX(14px);-ms-transform:translateX(14px);transform:translate(14px)}.loading-overlay-local[_ngcontent-%COMP%]{position:absolute;inset:0;background:#fffc;border-radius:12px;display:flex;align-items:center;justify-content:center;gap:12px;z-index:10;font-weight:600;color:#6366f1}.spinner-small[_ngcontent-%COMP%]{display:inline-block;width:16px;height:16px;border:2px solid rgba(99,102,241,.2);border-top:2px solid #6366f1;border-radius:50%;animation:_ngcontent-%COMP%_spin 1s linear infinite}@keyframes _ngcontent-%COMP%_spin{0%{transform:rotate(0)}to{transform:rotate(360deg)}}']});let i=r;return i})();function zu(i,r){if(i&1&&(s(0,"span",23),p(1),l()),i&2){let n,e=u().$implicit,t=u();c(),P(" ",(n=t.getProject(e.projet_id))==null?null:n.nom_projet," ")}}function Fu(i,r){i&1&&(s(0,"span",24),p(1,"-"),l())}function qu(i,r){if(i&1){let n=S();s(0,"tr")(1,"td",10),p(2),ce(3,"date"),l(),s(4,"td",11),p(5),l(),s(6,"td"),w(7,zu,2,1,"span",12)(8,Fu,2,0,"span",13),l(),s(9,"td")(10,"span",14),p(11),l()(),s(12,"td",15)(13,"button",16),v("click",function(){let t=f(n).$implicit,o=u();return h(o.openEditModal(t))}),xt(),s(14,"svg",17),y(15,"path",18)(16,"path",19),l()(),Dt(),s(17,"button",20),v("click",function(){let t=f(n).$implicit,o=u();return h(o.deleteJalon(t))}),xt(),s(18,"svg",17),y(19,"polyline",21)(20,"path",22),l()()()()}if(i&2){let n=r.$implicit,e=u();c(2),O(de(3,6,n.date_jalon,"dd/MM/yyyy")),c(3),O(n.nom),c(2),g("ngIf",e.getProject(n.projet_id)),c(),g("ngIf",!n.projet_id),c(2),_e("data-type",n.type),c(),P(" ",n.type||"Autre"," ")}}function Uu(i,r){i&1&&(s(0,"tr")(1,"td",25),p(2,"Aucun jalon trouv\xE9"),l()())}var bs=(()=>{let r=class r{constructor(e,t){this.jalonService=e,this.projetService=t,this.jalons=[],this.projets=[],this.showModal=!1,this.currentJalon=null}ngOnInit(){return _(this,null,function*(){yield this.loadData()})}loadData(){return _(this,null,function*(){try{let[e,t]=yield Promise.all([this.jalonService.getAllJalons(),this.projetService.getAllProjets()]);this.jalons=e,this.projets=t}catch(e){console.error("Error loading data:",e)}})}getProject(e){if(e)return this.projets.find(t=>t.id===e)}openCreateModal(){this.currentJalon=null,this.showModal=!0}openEditModal(e){this.currentJalon=e,this.showModal=!0}onJalonSaved(){return _(this,null,function*(){yield this.loadData()})}deleteJalon(e){return _(this,null,function*(){if(!(!e.id||!confirm("\xCAtes-vous s\xFBr de vouloir supprimer ce jalon ?")))try{yield this.jalonService.deleteJalon(e.id),yield this.loadData()}catch(t){console.error("Error deleting jalon:",t)}})}};r.\u0275fac=function(t){return new(t||r)(R(Tt),R(at))},r.\u0275cmp=B({type:r,selectors:[["app-milestones-view"]],decls:27,vars:5,consts:[[1,"milestones-container"],[1,"milestones-header"],[1,"subtitle"],[1,"btn","btn-primary",3,"click"],[1,"milestones-list"],[1,"milestones-table"],[2,"width","100px"],[4,"ngFor","ngForOf"],[4,"ngIf"],[3,"visibleChange","saved","visible","jalon","projets"],[1,"date-cell"],[1,"name-cell"],["class","project-badge",4,"ngIf"],["class","no-project",4,"ngIf"],[1,"type-badge"],[1,"actions-cell"],["title","Modifier",1,"action-btn","edit",3,"click"],["width","16","height","16","viewBox","0 0 24 24","fill","none","stroke","currentColor","stroke-width","2"],["d","M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7"],["d","M18.5 2.5a2.121 2.121 0 0 1 3 3L12 15l-4 1 1-4 9.5-9.5z"],["title","Supprimer",1,"action-btn","delete",3,"click"],["points","3 6 5 6 21 6"],["d","M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"],[1,"project-badge"],[1,"no-project"],["colspan","5",1,"empty-state"]],template:function(t,o){t&1&&(s(0,"div",0)(1,"div",1)(2,"div")(3,"h1"),p(4,"Jalons"),l(),s(5,"p",2),p(6,"G\xE9rez les jalons de vos projets"),l()(),s(7,"button",3),v("click",function(){return o.openCreateModal()}),p(8," + Nouveau Jalon "),l()(),s(9,"div",4)(10,"table",5)(11,"thead")(12,"tr")(13,"th"),p(14,"Date"),l(),s(15,"th"),p(16,"Nom"),l(),s(17,"th"),p(18,"Projet"),l(),s(19,"th"),p(20,"Type"),l(),s(21,"th",6),p(22,"Actions"),l()()(),s(23,"tbody"),w(24,qu,21,9,"tr",7)(25,Uu,3,0,"tr",8),l()()()(),s(26,"app-milestone-modal",9),T("visibleChange",function(d){return E(o.showModal,d)||(o.showModal=d),d}),v("saved",function(){return o.onJalonSaved()}),l()),t&2&&(c(24),g("ngForOf",o.jalons),c(),g("ngIf",o.jalons.length===0),c(),k("visible",o.showModal),g("jalon",o.currentJalon)("projets",o.projets))},dependencies:[G,Oe,te,X,Yi,Wr],styles:[".milestones-container[_ngcontent-%COMP%]{padding:32px;background:#f5f7fa;min-height:100vh}.milestones-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:32px}.milestones-header[_ngcontent-%COMP%]   h1[_ngcontent-%COMP%]{margin:0 0 4px;font-size:32px;font-weight:700;color:#111827}.subtitle[_ngcontent-%COMP%]{margin:0;color:#6b7280;font-size:16px}.btn[_ngcontent-%COMP%]{padding:10px 20px;border-radius:8px;font-weight:500;cursor:pointer;border:none;transition:all .2s}.btn-primary[_ngcontent-%COMP%]{background:#4f46e5;color:#fff}.btn-primary[_ngcontent-%COMP%]:hover{background:#4338ca}.milestones-list[_ngcontent-%COMP%]{background:#fff;border-radius:12px;box-shadow:0 1px 3px #0000001a;overflow:hidden}.milestones-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.milestones-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:16px;text-align:left;font-size:12px;font-weight:600;color:#6b7280;text-transform:uppercase;letter-spacing:.5px;border-bottom:2px solid #e5e7eb;background:#f9fafb}.milestones-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:16px;border-bottom:1px solid #f3f4f6;color:#374151;font-size:14px}.milestones-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]{border-bottom:none}.milestones-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover{background:#f9fafb}.date-cell[_ngcontent-%COMP%]{font-family:Consolas,Monaco,monospace;color:#6b7280}.name-cell[_ngcontent-%COMP%]{font-weight:500;color:#111827}.project-badge[_ngcontent-%COMP%]{display:inline-block;padding:2px 8px;background:#e0e7ff;color:#4338ca;border-radius:12px;font-size:12px;font-weight:500}.no-project[_ngcontent-%COMP%]{color:#9ca3af;font-style:italic}.type-badge[_ngcontent-%COMP%]{padding:4px 12px;border-radius:12px;font-size:12px;font-weight:600;text-transform:uppercase;background:#f3f4f6;color:#4b5563}.type-badge[data-type=LV][_ngcontent-%COMP%]{background:#d1fae5;color:#065f46}.type-badge[data-type=MEP][_ngcontent-%COMP%]{background:#dbeafe;color:#1e40af}.type-badge[data-type=SP][_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.actions-cell[_ngcontent-%COMP%]{display:flex;gap:8px}.action-btn[_ngcontent-%COMP%]{padding:6px;border:none;background:transparent;cursor:pointer;color:#9ca3af;border-radius:4px;transition:all .2s;display:flex;align-items:center;justify-content:center}.action-btn[_ngcontent-%COMP%]:hover{background:#f3f4f6}.action-btn.edit[_ngcontent-%COMP%]:hover{color:#4f46e5}.action-btn.delete[_ngcontent-%COMP%]:hover{color:#ef4444}.empty-state[_ngcontent-%COMP%]{text-align:center;color:#9ca3af;padding:40px!important}"]});let i=r;return i})();var Wu=()=>["/plan-globale"],ws=()=>["/projets"],$u=()=>["/ressources"],Bu=()=>["/organisation"],Hu=()=>["/jalons"],Gu=(i,r)=>r.statut,ys=(i,r)=>r.id;function Ju(i,r){if(i&1){let n=S();s(0,"div",25),v("mouseenter",function(){let t=f(n).$implicit,o=u(2);return h(o.hoveredStatus=t.statut)})("mouseleave",function(){f(n);let t=u(2);return h(t.hoveredStatus=null)}),s(1,"div",26),p(2),l(),s(3,"div",27)(4,"span",28),p(5),l()()()}if(i&2){let n=r.$implicit;c(),z("color","#3b82f6"),c(),O(n.count),c(3),O(n.statut.toLowerCase())}}function Yu(i,r){if(i&1&&ue(0,Ju,6,4,"div",24,Gu),i&2){let n=u();me(n.projectStatusCounts)}}function Qu(i,r){i&1&&(s(0,"div",16),p(1,"Aucun projet"),l())}function Ku(i,r){if(i&1){let n=S();s(0,"div",25),v("mouseenter",function(){f(n);let t=u();return h(t.hoveredResource="roles")})("mouseleave",function(){f(n);let t=u();return h(t.hoveredResource=null)}),s(1,"div",26),p(2),l(),s(3,"div",27)(4,"span",28),p(5,"R\xF4les"),l()()(),s(6,"div",25),v("mouseenter",function(){f(n);let t=u();return h(t.hoveredResource="personnes")})("mouseleave",function(){f(n);let t=u();return h(t.hoveredResource=null)}),s(7,"div",26),p(8),l(),s(9,"div",27)(10,"span",28),p(11,"Personnes"),l()()()}if(i&2){let n=u();c(),z("color","#10b981"),c(),O(n.rolesCount),c(5),z("color","#10b981"),c(),O(n.personnesCount)}}function Zu(i,r){i&1&&(s(0,"div",16),p(1,"Aucune ressource"),l())}function Xu(i,r){if(i&1&&(s(0,"div",24)(1,"div",26),p(2),l(),s(3,"div",27)(4,"span",28),p(5,"Services"),l()()(),s(6,"div",24)(7,"div",26),p(8),l(),s(9,"div",27)(10,"span",28),p(11,"\xC9quipes"),l()()()),i&2){let n=u();c(),z("color","#8b5cf6"),c(),O(n.servicesCount),c(5),z("color","#8b5cf6"),c(),O(n.equipesCount)}}function e0(i,r){i&1&&(s(0,"div",16),p(1,"Aucune organisation"),l())}function t0(i,r){if(i&1&&(s(0,"div",30)(1,"div",31)(2,"div",32)(3,"span",33),p(4),l(),s(5,"span",34),p(6),l()(),s(7,"div",35),p(8),l(),s(9,"div",36)(10,"div",37),y(11,"div",38),l(),s(12,"span",39),p(13),l()()()()),i&2){let n=r.$implicit,e=u(2);z("border-left-color",n.color||"#3b82f6"),c(3),z("color",n.color||"#3b82f6"),c(),O(n.code_projet),c(),_e("data-status",n.statut),c(),O(n.statut),c(2),O(n.nom_projet),c(3),z("width",e.getProgressPercent(n),"%"),c(2),O(e.getProgressText(n))}}function n0(i,r){if(i&1&&ue(0,t0,14,11,"div",29,ys),i&2){let n=u();me(n.recentProjects)}}function i0(i,r){i&1&&(s(0,"div",23),p(1,"Aucun projet r\xE9cent"),l())}function o0(i,r){if(i&1&&(s(0,"div",40),y(1,"div",41),s(2,"div",42)(3,"div",43)(4,"div",44),p(5),l(),s(6,"div",45),p(7),l()(),s(8,"div",46)(9,"div",47),p(10),l(),s(11,"div",48),p(12),l()()()()),i&2){let n=r.$implicit,e=u(2);c(),z("background-color",e.getMilestoneColor(n)),c(4),O(n.nom),c(2),O(e.formatDate(n.date_jalon)),c(3),P(" ",e.getProjectName(n.projet_id)," "),c(),$("urgent",e.getDaysRemaining(n.date_jalon)<=7),c(),P(" ",e.getDaysRemainingText(n.date_jalon)," ")}}function r0(i,r){if(i&1&&ue(0,o0,13,8,"div",40,ys),i&2){let n=u();me(n.upcomingJalons)}}function a0(i,r){i&1&&(s(0,"div",23),p(1,"Aucun jalon \xE0 venir"),l())}var Ms=(()=>{let r=class r{constructor(e,t,o,a,d,m,C){this.projetService=e,this.rolesService=t,this.personnesService=o,this.servicesService=a,this.teamService=d,this.jalonService=m,this.router=C,this.Calendar=ai,this.FolderKanban=si,this.Users=Xe,this.Building2=wt,this.projets=[],this.jalons=[],this.projectStatusCounts=[],this.rolesCount=0,this.personnesCount=0,this.servicesCount=0,this.equipesCount=0,this.recentProjects=[],this.upcomingJalons=[],this.hoveredStatus=null,this.hoveredResource=null}ngOnInit(){return _(this,null,function*(){yield Promise.all([this.loadProjects(),this.loadJalons(),this.loadResources(),this.loadOrganization()]),this.processData()})}loadProjects(){return _(this,null,function*(){try{this.projets=yield this.projetService.getAllProjets()}catch(e){console.error("Error loading projects:",e)}})}loadJalons(){return _(this,null,function*(){try{this.jalons=yield this.jalonService.getAllJalons()}catch(e){console.error("Error loading jalons:",e)}})}loadResources(){return _(this,null,function*(){try{let e=yield this.rolesService.getAllRoles(),t=yield this.personnesService.getAllPersonnes();this.rolesCount=e.length,this.personnesCount=t.length}catch(e){console.error("Error loading resources:",e)}})}loadOrganization(){return _(this,null,function*(){try{let e=yield this.servicesService.getAllServices(),t=yield this.teamService.getAllEquipes();this.servicesCount=e.length,this.equipesCount=t.length}catch(e){console.error("Error loading organization:",e)}})}processData(){let e=new Map;this.projets.forEach(o=>{let a=e.get(o.statut)||0;e.set(o.statut,a+1)}),this.projectStatusCounts=Array.from(e.entries()).map(([o,a])=>({statut:o,count:a})).sort((o,a)=>a.count-o.count),this.recentProjects=[...this.projets].sort((o,a)=>{let d=o.updated_at?new Date(o.updated_at).getTime():0;return(a.updated_at?new Date(a.updated_at).getTime():0)-d}).slice(0,5);let t=new Date;t.setHours(0,0,0,0),this.upcomingJalons=this.jalons.filter(o=>{let a=new Date(o.date_jalon);return a.setHours(0,0,0,0),a>=t}).sort((o,a)=>{let d=new Date(o.date_jalon).getTime(),m=new Date(a.date_jalon).getTime();return d-m}).slice(0,7)}getProgressPercent(e){if(e.chiffrage_previsionnel===0)return 0;let t=e.temps_consomme/e.chiffrage_previsionnel*100;return Math.min(Math.round(t),100)}getProgressText(e){return`${e.temps_consomme}j / ${e.chiffrage_previsionnel}j`}getProjectName(e){return e&&this.projets.find(o=>o.id===e)?.nom_projet||null}getMilestoneColor(e){let t=this.getDaysRemaining(e.date_jalon);return t<=7?"#ef4444":t<=30?"#f59e0b":"#3b82f6"}getDaysRemaining(e){let t=new Date;t.setHours(0,0,0,0);let o=new Date(e);o.setHours(0,0,0,0);let a=o.getTime()-t.getTime();return Math.ceil(a/(1e3*60*60*24))}getDaysRemainingText(e){let t=this.getDaysRemaining(e);return t===0?"Aujourd'hui":t===1?"Demain":t<0?"En retard":`Dans ${t}j`}formatDate(e){let t=new Date(e),o=t.getDate(),a=t.toLocaleDateString("fr-FR",{month:"short"});return`${o} ${a}`}};r.\u0275fac=function(t){return new(t||r)(R(at),R(gn),R(Hi),R(Bi),R(Et),R(Tt),R(pe))},r.\u0275cmp=B({type:r,selectors:[["app-dashboard"]],decls:67,vars:31,consts:[[1,"dashboard-container"],[1,"dashboard-header"],[1,"header-left"],[1,"dashboard-title"],[1,"dashboard-subtitle"],[1,"header-actions"],[1,"btn-planning",3,"routerLink"],[3,"img","size"],[1,"summary-cards"],[1,"summary-card"],[1,"card-header"],[1,"card-title-group"],[1,"card-icon"],[1,"card-title"],[1,"card-link",3,"routerLink"],[1,"card-content"],[1,"empty-message"],[1,"main-content"],[1,"content-card"],[1,"content-card-header"],[1,"content-card-title"],[1,"content-card-link",3,"routerLink"],[1,"content-card-body"],[1,"empty-state"],[1,"stat-item"],[1,"stat-item",3,"mouseenter","mouseleave"],[1,"stat-number"],[1,"stat-label-wrapper"],[1,"stat-label"],[1,"project-item",3,"border-left-color"],[1,"project-item"],[1,"project-info"],[1,"project-header"],[1,"project-code"],[1,"project-status"],[1,"project-name"],[1,"project-progress"],[1,"progress-bar"],[1,"progress-fill"],[1,"progress-text"],[1,"milestone-item"],[1,"milestone-bar"],[1,"milestone-content"],[1,"milestone-header"],[1,"milestone-title"],[1,"milestone-date"],[1,"milestone-meta"],[1,"milestone-project"],[1,"milestone-days"]],template:function(t,o){t&1&&(s(0,"div",0)(1,"div",1)(2,"div",2)(3,"h1",3),p(4,"Tableau de bord"),l(),s(5,"p",4),p(6,"Vue d'ensemble de vos ressources et projets"),l()(),s(7,"div",5)(8,"a",6),y(9,"lucide-icon",7),p(10," Voir la planification "),l()()(),s(11,"div",8)(12,"div",9)(13,"div",10)(14,"div",11)(15,"div",12),y(16,"lucide-icon",7),l(),s(17,"h3",13),p(18,"Projets"),l()(),s(19,"a",14),p(20,"Voir tout \u2192"),l()(),s(21,"div",15),F(22,Yu,2,0)(23,Qu,2,0,"div",16),l()(),s(24,"div",9)(25,"div",10)(26,"div",11)(27,"div",12),y(28,"lucide-icon",7),l(),s(29,"h3",13),p(30,"Ressources"),l()(),s(31,"a",14),p(32,"Voir tout \u2192"),l()(),s(33,"div",15),F(34,Ku,12,6)(35,Zu,2,0,"div",16),l()(),s(36,"div",9)(37,"div",10)(38,"div",11)(39,"div",12),y(40,"lucide-icon",7),l(),s(41,"h3",13),p(42,"Organisation"),l()(),s(43,"a",14),p(44,"Voir tout \u2192"),l()(),s(45,"div",15),F(46,Xu,12,6)(47,e0,2,0,"div",16),l()()(),s(48,"div",17)(49,"div",18)(50,"div",19)(51,"h3",20),p(52,"Projets r\xE9cents"),l(),s(53,"a",21),p(54,"Voir tout \u2192"),l()(),s(55,"div",22),F(56,n0,2,0)(57,i0,2,0,"div",23),l()(),s(58,"div",18)(59,"div",19)(60,"h3",20),p(61,"Jalons \xE0 venir"),l(),s(62,"a",21),p(63,"Voir tout \u2192"),l()(),s(64,"div",22),F(65,r0,2,0)(66,a0,2,0,"div",23),l()()()()),t&2&&(c(8),g("routerLink",ft(25,Wu)),c(),g("img",o.Calendar)("size",18),c(6),z("background-color","#3b82f6"),c(),g("img",o.FolderKanban)("size",24),c(3),g("routerLink",ft(26,ws)),c(3),q(o.projectStatusCounts.length>0?22:23),c(5),z("background-color","#10b981"),c(),g("img",o.Users)("size",24),c(3),g("routerLink",ft(27,$u)),c(3),q(o.rolesCount>0||o.personnesCount>0?34:35),c(5),z("background-color","#8b5cf6"),c(),g("img",o.Building2)("size",24),c(3),g("routerLink",ft(28,Bu)),c(3),q(o.servicesCount>0||o.equipesCount>0?46:47),c(7),g("routerLink",ft(29,ws)),c(3),q(o.recentProjects.length>0?56:57),c(6),g("routerLink",ft(30,Hu)),c(3),q(o.upcomingJalons.length>0?65:66))},dependencies:[G,kt,K,ne],styles:['.dashboard-container[_ngcontent-%COMP%]{padding:32px;background:#f5f7fa;min-height:100vh;font-family:Inter,sans-serif}.dashboard-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:flex-end;margin-bottom:32px;gap:24px}.header-left[_ngcontent-%COMP%]{flex:1}.dashboard-title[_ngcontent-%COMP%]{font-size:32px;font-weight:700;color:#1e293b;margin:0 0 4px}.dashboard-subtitle[_ngcontent-%COMP%]{font-size:14px;color:#64748b;margin:0;font-weight:500}.header-actions[_ngcontent-%COMP%]{display:flex;gap:12px}.btn-planning[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:10px 20px;background:#3b82f6;color:#fff;border-radius:8px;text-decoration:none;font-weight:600;font-size:14px;transition:all .2s}.btn-planning[_ngcontent-%COMP%]:hover{background:#2563eb;transform:translateY(-1px);box-shadow:0 4px 12px #3b82f64d}.summary-cards[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fit,minmax(280px,1fr));gap:24px;margin-bottom:32px}.summary-card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:20px;box-shadow:0 1px 3px #0000001a;transition:all .2s}.summary-card[_ngcontent-%COMP%]:hover{box-shadow:0 4px 12px #0000001a}.card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px}.card-title-group[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px}.card-icon[_ngcontent-%COMP%]{width:48px;height:48px;border-radius:12px;display:flex;align-items:center;justify-content:center;color:#fff}.card-title[_ngcontent-%COMP%]{font-size:18px;font-weight:700;color:#1e293b;margin:0}.card-link[_ngcontent-%COMP%]{font-size:14px;color:#3b82f6;text-decoration:none;font-weight:600;transition:color .2s}.card-link[_ngcontent-%COMP%]:hover{color:#2563eb}.card-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(3,1fr);column-gap:16px;row-gap:24px}.stat-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px;position:relative}.stat-number[_ngcontent-%COMP%]{font-size:48px;font-weight:700;line-height:1;letter-spacing:-.02em}.stat-label-wrapper[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-items:flex-start;gap:4px}.stat-label[_ngcontent-%COMP%]{font-size:14px;color:#94a3b8;font-weight:500;text-transform:capitalize}.stat-link[_ngcontent-%COMP%]{font-size:12px;color:#3b82f6;text-decoration:none;font-weight:600;transition:color .2s,opacity .2s,transform .2s;opacity:0;transform:translateY(-4px)}.stat-item[_ngcontent-%COMP%]:hover   .stat-link[_ngcontent-%COMP%]{opacity:1;transform:translateY(0)}.stat-link[_ngcontent-%COMP%]:hover{color:#2563eb}.empty-message[_ngcontent-%COMP%]{font-size:14px;color:#94a3b8;font-style:italic}.main-content[_ngcontent-%COMP%]{display:grid;grid-template-columns:5fr 4fr;gap:24px}.content-card[_ngcontent-%COMP%]{background:#fff;border-radius:16px;padding:24px;box-shadow:0 1px 3px #0000001a}.content-card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:20px}.content-card-title[_ngcontent-%COMP%]{font-size:20px;font-weight:700;color:#1e293b;margin:0}.content-card-link[_ngcontent-%COMP%]{font-size:14px;color:#3b82f6;text-decoration:none;font-weight:600;display:flex;align-items:center;gap:4px;transition:color .2s}.content-card-link[_ngcontent-%COMP%]:hover{color:#2563eb}.content-card-body[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:16px}.project-item[_ngcontent-%COMP%]{padding:16px;background:#f9fafb;border-radius:12px;border-left:3px solid #3b82f6;transition:all .2s}.project-item[_ngcontent-%COMP%]:hover{background:#f3f4f6;transform:translate(2px)}.project-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}.project-code[_ngcontent-%COMP%]{font-family:Consolas,Monaco,monospace;font-weight:700;font-size:13px;letter-spacing:.5px}.project-status[_ngcontent-%COMP%]{padding:4px 10px;border-radius:12px;font-size:11px;font-weight:600;text-transform:uppercase;letter-spacing:.3px}.project-status[data-status=Actif][_ngcontent-%COMP%]{background:#d1fae5;color:#065f46}.project-status[data-status="En cours"][_ngcontent-%COMP%]{background:#dbeafe;color:#1e40af}.project-status[data-status=Planifi\\e9][_ngcontent-%COMP%]{background:#fef3c7;color:#92400e}.project-status[data-status=Termin\\e9][_ngcontent-%COMP%]{background:#f3f4f6;color:#374151}.project-status[data-status="En pause"][_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}.project-name[_ngcontent-%COMP%]{font-size:16px;font-weight:600;color:#1e293b;margin-bottom:12px}.project-progress[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px}.progress-bar[_ngcontent-%COMP%]{height:6px;background:#e5e7eb;border-radius:3px;overflow:hidden}.progress-fill[_ngcontent-%COMP%]{height:100%;background:#3b82f6;transition:width .3s ease}.progress-text[_ngcontent-%COMP%]{font-size:12px;color:#64748b;font-weight:500}.milestone-item[_ngcontent-%COMP%]{display:flex;gap:12px;padding:12px;background:#f9fafb;border-radius:12px;transition:all .2s}.milestone-item[_ngcontent-%COMP%]:hover{background:#f3f4f6}.milestone-bar[_ngcontent-%COMP%]{width:4px;border-radius:2px;flex-shrink:0}.milestone-content[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;gap:4px}.milestone-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;gap:12px}.milestone-title[_ngcontent-%COMP%]{font-size:15px;font-weight:600;color:#1e293b;flex:1}.milestone-meta[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-top:2px}.milestone-date[_ngcontent-%COMP%]{font-size:11px;font-weight:700;color:#64748b;letter-spacing:.5px;background:#f1f5f9;padding:2px 6px;border-radius:4px}.milestone-project[_ngcontent-%COMP%]{font-size:13px;color:#94a3b8;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;flex:1;margin-right:12px}.milestone-days[_ngcontent-%COMP%]{font-size:12px;font-weight:600;color:#3b82f6}.milestone-days.urgent[_ngcontent-%COMP%]{color:#f59e0b}.empty-state[_ngcontent-%COMP%]{padding:32px;text-align:center;color:#94a3b8;font-size:14px}@media (max-width: 1200px){.main-content[_ngcontent-%COMP%]{grid-template-columns:1fr}}']});let i=r;return i})();var Ps=(()=>{let r=class r{constructor(){this.email=ee(""),this.password=ee(""),this.showPassword=ee(!1),this.loading=!1,this.Eye=Qt,this.EyeOff=Yt,this.supabaseService=j(H),this.router=j(pe)}togglePasswordVisibility(){this.showPassword.update(e=>!e)}signInWithEmail(){return _(this,null,function*(){this.loading=!0;try{let{error:e}=yield this.supabaseService.signInWithEmail({email:this.email(),password:this.password()});e?alert("Error signing in: "+e.message):this.router.navigate(["/"])}finally{this.loading=!1}})}navigateToSignup(){this.router.navigate(["/signup"])}navigateToForgot(){this.router.navigate(["/forgot-password"])}};r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=B({type:r,selectors:[["app-login"]],decls:19,vars:6,consts:[[1,"container"],[3,"ngSubmit"],["type","email","name","email","placeholder","Email","required","","autocomplete","email",3,"ngModelChange","ngModel"],[1,"password-container"],["name","password","placeholder","Password","required","","autocomplete","current-password",3,"ngModelChange","type","ngModel"],["type","button","tabindex","-1",1,"toggle-password",3,"click"],["size","20",3,"img"],["type","submit",3,"disabled"],[3,"click"]],template:function(t,o){t&1&&(s(0,"div",0)(1,"h2"),p(2,"Login"),l(),s(3,"form",1),v("ngSubmit",function(){return o.signInWithEmail()}),s(4,"input",2),T("ngModelChange",function(d){return E(o.email,d)||(o.email=d),d}),l(),s(5,"div",3)(6,"input",4),T("ngModelChange",function(d){return E(o.password,d)||(o.password=d),d}),l(),s(7,"button",5),v("click",function(){return o.togglePasswordVisibility()}),y(8,"lucide-icon",6),l()(),s(9,"button",7),p(10),l()(),s(11,"p"),p(12,"Don't have an account? "),s(13,"a",8),v("click",function(){return o.navigateToSignup()}),p(14,"Sign Up"),l()(),s(15,"p"),p(16,"Forgot your password ? "),s(17,"a",8),v("click",function(){return o.navigateToForgot()}),p(18,"Send me a link"),l()()()),t&2&&(c(4),k("ngModel",o.email),c(2),g("type",o.showPassword()?"text":"password"),k("ngModel",o.password),c(2),g("img",o.showPassword()?o.EyeOff:o.Eye),c(),g("disabled",o.loading),c(),P(" ",o.loading?"Loading...":"Sign In"," "))},dependencies:[X,Te,ie,oe,ke,Ie,re,Ee,K,ne],styles:[".container[_ngcontent-%COMP%]{max-width:400px;margin:2rem auto;padding:2rem;background:#fff;border-radius:8px;box-shadow:0 4px 6px -1px #0000001a}h2[_ngcontent-%COMP%]{text-align:center;color:#1e293b;margin-bottom:2rem}form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}input[_ngcontent-%COMP%]{padding:.75rem;border:1px solid #e2e8f0;border-radius:6px;font-size:1rem;width:100%;box-sizing:border-box}button[type=submit][_ngcontent-%COMP%]{padding:.75rem;background:#2563eb;color:#fff;border:none;border-radius:6px;font-size:1rem;font-weight:500;cursor:pointer;transition:background .2s}button[type=submit][_ngcontent-%COMP%]:hover{background:#1d4ed8}button[type=submit][_ngcontent-%COMP%]:disabled{background:#94a3b8;cursor:not-allowed}p[_ngcontent-%COMP%]{text-align:center;margin-top:1.5rem;color:#64748b}a[_ngcontent-%COMP%]{color:#2563eb;text-decoration:none;cursor:pointer;font-weight:500}a[_ngcontent-%COMP%]:hover{text-decoration:underline}.password-container[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.toggle-password[_ngcontent-%COMP%]{position:absolute;right:10px;background:none;border:none;cursor:pointer;padding:0;display:flex;align-items:center;color:#64748b}.toggle-password[_ngcontent-%COMP%]:hover{color:#1e293b}body.dark-mode[_nghost-%COMP%]   .container[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   .container[_ngcontent-%COMP%]{background:#1e293b;box-shadow:0 4px 6px -1px #00000080}body.dark-mode[_nghost-%COMP%]   h2[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   h2[_ngcontent-%COMP%]{color:#f8fafc}body.dark-mode[_nghost-%COMP%]   input[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   input[_ngcontent-%COMP%]{background:#334155;border-color:#475569;color:#f8fafc}body.dark-mode[_nghost-%COMP%]   input[_ngcontent-%COMP%]:focus, body.dark-mode   [_nghost-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#3b82f6}body.dark-mode[_nghost-%COMP%]   .toggle-password[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   .toggle-password[_ngcontent-%COMP%]{color:#94a3b8}body.dark-mode[_nghost-%COMP%]   .toggle-password[_ngcontent-%COMP%]:hover, body.dark-mode   [_nghost-%COMP%]   .toggle-password[_ngcontent-%COMP%]:hover{color:#f8fafc}body.dark-mode[_nghost-%COMP%]   p[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   p[_ngcontent-%COMP%]{color:#cbd5e1}body.dark-mode[_nghost-%COMP%]   a[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   a[_ngcontent-%COMP%]{color:#60a5fa}body.dark-mode[_nghost-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill, body.dark-mode   [_nghost-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill, body.dark-mode[_nghost-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:hover, body.dark-mode   [_nghost-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:hover, body.dark-mode[_nghost-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:focus, body.dark-mode   [_nghost-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:focus, body.dark-mode[_nghost-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:active, body.dark-mode   [_nghost-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:active{-webkit-box-shadow:0 0 0 30px #334155 inset!important;-webkit-text-fill-color:#f8fafc!important;caret-color:#f8fafc}"]});let i=r;return i})();function s0(i,r){if(i&1&&(s(0,"div",12),p(1),l()),i&2){let n=u();c(),P(" ",n.error()," ")}}function l0(i,r){if(i&1&&(s(0,"div",13),p(1),l()),i&2){let n=u();c(),P(" ",n.message()," ")}}var Ss=(()=>{let r=class r{constructor(){this.name="",this.email="",this.password=ee(""),this.confirmPassword=ee(""),this.showPassword=ee(!1),this.showConfirmPassword=ee(!1),this.loading=!1,this.error=ee(null),this.message=ee(null),this.Eye=Qt,this.EyeOff=Yt,this.supabaseService=j(H),this.router=j(pe)}togglePasswordVisibility(){this.showPassword.update(e=>!e)}toggleConfirmPasswordVisibility(){this.showConfirmPassword.update(e=>!e)}signUp(){return _(this,null,function*(){if(this.error.set(null),this.message.set(null),this.password().length<6){this.error.set("Le mot de passe doit contenir au moins 6 caract\xE8res.");return}if(this.password()!==this.confirmPassword()){this.error.set("Les mots de passe ne correspondent pas.");return}let{error:e}=yield this.supabaseService.signUpWithEmail({name:this.name,email:this.email,password:this.password()});e?alert("Error signing up: "+e.message):(alert("Check your email to confirm your account!"),this.router.navigate(["/login"]))})}navigateToLogin(){this.router.navigate(["/login"])}};r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=B({type:r,selectors:[["app-signup"]],decls:22,vars:10,consts:[[1,"container"],["type","text","name","name","placeholder","Full Name","required","","autocomplete","name",3,"ngModelChange","ngModel"],["type","email","name","email","placeholder","Email","required","","autocomplete","email",3,"ngModelChange","ngModel"],[1,"password-container"],["name","password","minlength","6","placeholder","Mot de passe (Minimum 6 caract\xE8res)","required","","autocomplete","new-password",3,"ngModelChange","type","ngModel"],["type","button","tabindex","-1",1,"toggle-password",3,"click"],["size","20",3,"img"],["id","confirmPassword","name","confirmPassword","placeholder","Confirmez votre mot de passe","minlength","6","required","","autocomplete","new-password",3,"ngModelChange","type","ngModel"],["type","button",3,"click"],["class","message error",4,"ngIf"],["class","message success",4,"ngIf"],[3,"click"],[1,"message","error"],[1,"message","success"]],template:function(t,o){t&1&&(s(0,"div",0)(1,"h2"),p(2,"Sign Up"),l(),s(3,"form")(4,"input",1),T("ngModelChange",function(d){return E(o.name,d)||(o.name=d),d}),l(),s(5,"input",2),T("ngModelChange",function(d){return E(o.email,d)||(o.email=d),d}),l(),s(6,"div",3)(7,"input",4),v("ngModelChange",function(d){return o.password.set(d)}),l(),s(8,"button",5),v("click",function(){return o.togglePasswordVisibility()}),y(9,"lucide-icon",6),l()(),s(10,"div",3)(11,"input",7),v("ngModelChange",function(d){return o.confirmPassword.set(d)}),l(),s(12,"button",5),v("click",function(){return o.toggleConfirmPasswordVisibility()}),y(13,"lucide-icon",6),l()(),s(14,"button",8),v("click",function(){return o.signUp()}),p(15,"Sign Up"),l()(),w(16,s0,2,1,"div",9)(17,l0,2,1,"div",10),s(18,"p"),p(19,"Already have an account? "),s(20,"a",11),v("click",function(){return o.navigateToLogin()}),p(21,"Log In"),l()()()),t&2&&(c(4),k("ngModel",o.name),c(),k("ngModel",o.email),c(2),g("type",o.showPassword()?"text":"password")("ngModel",o.password()),c(2),g("img",o.showPassword()?o.EyeOff:o.Eye),c(2),g("type",o.showConfirmPassword()?"text":"password")("ngModel",o.confirmPassword()),c(2),g("img",o.showConfirmPassword()?o.EyeOff:o.Eye),c(3),g("ngIf",o.error()),c(),g("ngIf",o.message()))},dependencies:[X,Te,ie,oe,ke,Ie,pi,re,Ee,G,te,K,ne],styles:[".container[_ngcontent-%COMP%]{max-width:400px;margin:2rem auto;padding:2rem;background:#fff;border-radius:8px;box-shadow:0 4px 6px -1px #0000001a}h2[_ngcontent-%COMP%]{text-align:center;color:#1e293b;margin-bottom:2rem}form[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:1rem}input[_ngcontent-%COMP%]{padding:.75rem;border:1px solid #e2e8f0;border-radius:6px;font-size:1rem;width:100%;box-sizing:border-box}button[_ngcontent-%COMP%]{padding:.75rem;background:#2563eb;color:#fff;border:none;border-radius:6px;font-size:1rem;font-weight:500;cursor:pointer;transition:background .2s}button[_ngcontent-%COMP%]:hover{background:#1d4ed8}.message[_ngcontent-%COMP%]{padding:1rem;border-radius:6px;margin-top:1rem;text-align:center}.error[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}.success[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}p[_ngcontent-%COMP%]{text-align:center;margin-top:1.5rem;color:#64748b}a[_ngcontent-%COMP%]{color:#2563eb;text-decoration:none;cursor:pointer;font-weight:500}a[_ngcontent-%COMP%]:hover{text-decoration:underline}.password-container[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.toggle-password[_ngcontent-%COMP%]{position:absolute;right:10px;background:none;border:none;cursor:pointer;padding:0;display:flex;align-items:center;color:#64748b}.toggle-password[_ngcontent-%COMP%]:hover{background:none;color:#1e293b}body.dark-mode[_nghost-%COMP%]   .container[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   .container[_ngcontent-%COMP%]{background:#1e293b;box-shadow:0 4px 6px -1px #00000080}body.dark-mode[_nghost-%COMP%]   h2[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   h2[_ngcontent-%COMP%]{color:#f8fafc}body.dark-mode[_nghost-%COMP%]   input[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   input[_ngcontent-%COMP%]{background:#334155;border-color:#475569;color:#f8fafc}body.dark-mode[_nghost-%COMP%]   input[_ngcontent-%COMP%]:focus, body.dark-mode   [_nghost-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#3b82f6}body.dark-mode[_nghost-%COMP%]   .toggle-password[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   .toggle-password[_ngcontent-%COMP%]{color:#94a3b8}body.dark-mode[_nghost-%COMP%]   .toggle-password[_ngcontent-%COMP%]:hover, body.dark-mode   [_nghost-%COMP%]   .toggle-password[_ngcontent-%COMP%]:hover{color:#f8fafc}body.dark-mode[_nghost-%COMP%]   p[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   p[_ngcontent-%COMP%]{color:#cbd5e1}body.dark-mode[_nghost-%COMP%]   a[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   a[_ngcontent-%COMP%]{color:#60a5fa}body.dark-mode[_nghost-%COMP%]   .error[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   .error[_ngcontent-%COMP%]{background:#7f1d1d;color:#fecaca}body.dark-mode[_nghost-%COMP%]   .success[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   .success[_ngcontent-%COMP%]{background:#14532d;color:#bbf7d0}body.dark-mode[_nghost-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill, body.dark-mode   [_nghost-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill, body.dark-mode[_nghost-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:hover, body.dark-mode   [_nghost-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:hover, body.dark-mode[_nghost-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:focus, body.dark-mode   [_nghost-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:focus, body.dark-mode[_nghost-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:active, body.dark-mode   [_nghost-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:active{-webkit-box-shadow:0 0 0 30px #334155 inset!important;-webkit-text-fill-color:#f8fafc!important;caret-color:#f8fafc}"]});let i=r;return i})();function c0(i,r){if(i&1&&(s(0,"div",8),p(1),l()),i&2){let n=u();c(),P(" ",n.message," ")}}var Os=(()=>{let r=class r{constructor(e){this.supabaseService=e,this.email="",this.message="",this.loading=!1,this.router=j(pe)}onSubmit(){return _(this,null,function*(){this.loading=!0;try{yield this.supabaseService.resetPasswordForEmail(this.email),this.message="Un lien de r\xE9initialisation a \xE9t\xE9 envoy\xE9 \xE0 votre adresse email."}catch(e){this.message=`Erreur : ${e.message}`}finally{this.loading=!1}})}navigateToLogin(){this.router.navigate(["/login"])}};r.\u0275fac=function(t){return new(t||r)(R(H))},r.\u0275cmp=B({type:r,selectors:[["app-forgot-password"]],decls:14,vars:2,consts:[[1,"forgot-password-container"],[3,"ngSubmit"],[1,"form-group"],["for","email"],["type","email","id","email","name","email","required","","placeholder","Votre email",3,"ngModelChange","ngModel"],["type","submit"],["class","message",4,"ngIf"],[3,"click"],[1,"message"]],template:function(t,o){t&1&&(s(0,"div",0)(1,"h2"),p(2,"Mot de passe oubli\xE9"),l(),s(3,"form",1),v("ngSubmit",function(){return o.onSubmit()}),s(4,"div",2)(5,"label",3),p(6,"Email"),l(),s(7,"input",4),T("ngModelChange",function(d){return E(o.email,d)||(o.email=d),d}),l()(),s(8,"button",5),p(9,"Envoyer le lien de r\xE9initialisation"),l()(),w(10,c0,2,1,"div",6),s(11,"p")(12,"a",7),v("click",function(){return o.navigateToLogin()}),p(13,"Retour au Log In"),l()()()),t&2&&(c(7),k("ngModel",o.email),c(3),g("ngIf",o.message))},dependencies:[X,Te,ie,oe,ke,Ie,re,Ee,G,te],styles:[".forgot-password-container[_ngcontent-%COMP%]{max-width:500px;margin:2rem auto;padding:2rem;background:#fff;border-radius:12px;box-shadow:0 6px 18px #0000001a;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif}.forgot-password-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#2c3e50;text-align:center;margin-bottom:2rem;font-weight:500}.forgot-password-container[_ngcontent-%COMP%]   form[_ngcontent-%COMP%]{display:flex;flex-direction:column}.forgot-password-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]{margin-bottom:1.5rem}.forgot-password-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;color:#2c3e50;font-weight:500}.forgot-password-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=email][_ngcontent-%COMP%]{width:100%;padding:.85rem;border:1px solid #ddd;border-radius:6px;font-size:1rem;transition:border-color .3s ease,box-shadow .3s ease}.forgot-password-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=email][_ngcontent-%COMP%]:focus{outline:none;border-color:#3498db;box-shadow:0 0 0 2px #3498db33}.forgot-password-container[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]{width:100%;padding:.85rem;background-color:#3498db;color:#fff;border:none;border-radius:6px;font-size:1rem;font-weight:500;cursor:pointer;transition:background-color .3s ease;margin-top:.5rem}.forgot-password-container[_ngcontent-%COMP%]   button[type=submit][_ngcontent-%COMP%]:hover{background-color:#2980b9}.forgot-password-container[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{margin-top:1.5rem;padding:1rem;text-align:center;border-radius:6px;background-color:#e8f4fc;color:#2c3e50;border:1px solid #b8d8f0}p[_ngcontent-%COMP%]{text-align:center;margin-top:1.5rem;color:#555;font-size:.9rem}a[_ngcontent-%COMP%]{color:#3498db;text-decoration:none;font-weight:500;cursor:pointer;transition:color .3s ease}.container[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#2980b9;text-decoration:underline}body.dark-mode[_nghost-%COMP%]   .forgot-password-container[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   .forgot-password-container[_ngcontent-%COMP%]{background:#1e293b;box-shadow:0 6px 18px #0000004d}body.dark-mode[_nghost-%COMP%]   .forgot-password-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   .forgot-password-container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], body.dark-mode[_nghost-%COMP%]   .forgot-password-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   .forgot-password-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:#f8fafc}body.dark-mode[_nghost-%COMP%]   .forgot-password-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=email][_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   .forgot-password-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[type=email][_ngcontent-%COMP%]{background:#334155;border-color:#475569;color:#f8fafc}body.dark-mode[_nghost-%COMP%]   .forgot-password-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus, body.dark-mode   [_nghost-%COMP%]   .forgot-password-container[_ngcontent-%COMP%]   .form-group[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#38bdf8;box-shadow:0 0 0 2px #38bdf833}body.dark-mode[_nghost-%COMP%]   .forgot-password-container[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   .forgot-password-container[_ngcontent-%COMP%]   .message[_ngcontent-%COMP%]{background-color:#0f172a;color:#e2e8f0;border-color:#334155}body.dark-mode[_nghost-%COMP%]   p[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   p[_ngcontent-%COMP%]{color:#cbd5e1}body.dark-mode[_nghost-%COMP%]   a[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   a[_ngcontent-%COMP%]{color:#38bdf8}body.dark-mode[_nghost-%COMP%]   a[_ngcontent-%COMP%]:hover, body.dark-mode   [_nghost-%COMP%]   a[_ngcontent-%COMP%]:hover{color:#7dd3fc}body.dark-mode[_nghost-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill, body.dark-mode   [_nghost-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill, body.dark-mode[_nghost-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:hover, body.dark-mode   [_nghost-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:hover, body.dark-mode[_nghost-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:focus, body.dark-mode   [_nghost-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:focus, body.dark-mode[_nghost-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:active, body.dark-mode   [_nghost-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:active{-webkit-box-shadow:0 0 0 30px #334155 inset!important;-webkit-text-fill-color:#f8fafc!important;transition:background-color 5000s ease-in-out 0s}"]});let i=r;return i})();var ks=(i,r)=>_(null,null,function*(){if(!ra.enableAuth)return!0;let n=j(H),e=j(pe),{data:t}=yield n.getUser();return t.user?!0:(e.navigate(["/login"],{queryParams:{returnUrl:r.url}}),!1)});function d0(i,r){if(i&1&&(pt(0,"div",2)(1,"p"),p(2),ut(),pt(3,"p"),p(4),ut(),pt(5,"p"),p(6),ut()()),i&2){let n=u();c(2),P("User ID: ",n.user.id),c(2),P("Email: ",n.user.email),c(2),P("Display Name: ",n.user.user_metadata.displayName)}}var Es=(()=>{let r=class r{constructor(){this.user=null,this.loading=!1,this.showInfo=!1,this.supabaseService=j(H),this.router=j(pe)}ngOnInit(){}toggleUserInfo(){return _(this,null,function*(){this.user?this.showInfo=!this.showInfo:(yield this.fetchUser(),this.showInfo=!0)})}fetchUser(){return _(this,null,function*(){this.loading=!0;try{let{data:e}=yield this.supabaseService.getUser();this.user=e.user,this.user||this.router.navigate(["/login"])}finally{this.loading=!1}})}signOut(){return _(this,null,function*(){yield this.supabaseService.signOut(),this.router.navigate(["/login"])})}updatePassword(){return _(this,null,function*(){this.router.navigate(["/update-password"])})}};r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=B({type:r,selectors:[["app-profile"]],decls:12,vars:3,consts:[[1,"container"],[1,"btn","btn-primary",3,"click","disabled"],[1,"user-info"],[1,"btn","btn-secondary",3,"click"],[1,"btn",3,"click"]],template:function(t,o){t&1&&(pt(0,"div",0)(1,"h2"),p(2,"User Profile"),ut(),pt(3,"p"),p(4,"Congratulations! Welcome to secure auth with Angular + Supabase is running. \u{1F389}"),ut(),pt(5,"button",1),Kn("click",function(){return o.toggleUserInfo()}),p(6),ut(),F(7,d0,7,3,"div",2),pt(8,"button",3),Kn("click",function(){return o.updatePassword()}),p(9,"Modifier le mot de passe"),ut(),pt(10,"button",4),Kn("click",function(){return o.signOut()}),p(11,"Sign Out"),ut()()),t&2&&(c(5),jr("disabled",o.loading),c(),P(" ",o.loading?"Chargement...":o.showInfo?"Masquer les informations":"Afficher les informations personnelles"," "),c(),q(o.showInfo&&o.user?7:-1))},dependencies:[K,G],styles:[".container[_ngcontent-%COMP%]{max-width:500px;margin:2rem auto;padding:2rem;background:#fff;border-radius:12px;box-shadow:0 6px 18px #0000001a;font-family:Segoe UI,Tahoma,Geneva,Verdana,sans-serif;text-align:left}.container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#2c3e50;margin-bottom:1.5rem;font-weight:500;text-align:left}.container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:1rem;color:#555;line-height:1.5;text-align:left}.container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:first-of-type{font-size:1.1rem;margin-bottom:2rem;color:#27ae60}.container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:not(:first-of-type){font-weight:500;color:#2c3e50;word-break:break-all}.container[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:.5rem;width:100%;padding:.85rem;margin-top:1rem;background-color:#e74c3c;color:#fff;border:none;border-radius:6px;font-size:1rem;font-weight:500;cursor:pointer;transition:background-color .3s ease}.container[_ngcontent-%COMP%]   .btn[_ngcontent-%COMP%]:hover{background-color:#c0392b}.container[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]{background-color:#6c757d;margin-top:2rem}.container[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]:hover{background-color:#5a6268}.container[_ngcontent-%COMP%]   .btn-theme[_ngcontent-%COMP%]{background-color:#3498db;margin-top:2rem}.container[_ngcontent-%COMP%]   .btn-theme[_ngcontent-%COMP%]:hover{background-color:#2980b9}body.dark-mode[_nghost-%COMP%]   .container[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   .container[_ngcontent-%COMP%]{background:#1e293b;box-shadow:0 6px 18px #0000004d}body.dark-mode[_nghost-%COMP%]   .container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   .container[_ngcontent-%COMP%]   h2[_ngcontent-%COMP%]{color:#f8fafc}body.dark-mode[_nghost-%COMP%]   .container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   .container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#cbd5e1}body.dark-mode[_nghost-%COMP%]   .container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:first-of-type, body.dark-mode   [_nghost-%COMP%]   .container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:first-of-type{color:#4ade80}body.dark-mode[_nghost-%COMP%]   .container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:not(:first-of-type), body.dark-mode   [_nghost-%COMP%]   .container[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]:not(:first-of-type){color:#f8fafc}body.dark-mode[_nghost-%COMP%]   .container[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   .container[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]{background-color:#334155;color:#cbd5e1}body.dark-mode[_nghost-%COMP%]   .container[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]:hover, body.dark-mode   [_nghost-%COMP%]   .container[_ngcontent-%COMP%]   .btn-secondary[_ngcontent-%COMP%]:hover{background-color:#475569;color:#f8fafc}.user-info[_ngcontent-%COMP%]{margin-top:1.5rem;padding:1rem;background:#f8f9fa;border-radius:8px;border:1px solid #e9ecef}body.dark-mode[_nghost-%COMP%]   .user-info[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   .user-info[_ngcontent-%COMP%]{background:#334155;border-color:#475569}.theme-selector[_ngcontent-%COMP%]{margin-top:2rem;padding:1.5rem;background:#f8f9fa;border-radius:8px;border:1px solid #e9ecef}.theme-selector[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:block;margin-bottom:1rem;font-weight:600;color:#2c3e50;font-size:.95rem}.theme-buttons[_ngcontent-%COMP%]{display:flex;gap:.75rem;justify-content:flex-start}.theme-btn[_ngcontent-%COMP%]{flex:1;display:flex;flex-direction:column;align-items:center;justify-content:center;gap:.5rem;padding:1rem .75rem;background:#fff;color:#2c3e50;border:2px solid #e9ecef;border-radius:6px;font-size:.85rem;font-weight:500;cursor:pointer;transition:all .3s ease}.theme-btn[_ngcontent-%COMP%]:hover{border-color:#3498db;background:#f0f7ff}.theme-btn.active[_ngcontent-%COMP%]{background:#3498db;color:#fff;border-color:#3498db;box-shadow:0 2px 8px #3498db4d}.theme-btn[_ngcontent-%COMP%]   lucide-icon[_ngcontent-%COMP%]{display:block}.theme-btn[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{display:block}body.dark-mode[_nghost-%COMP%]   .theme-selector[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   .theme-selector[_ngcontent-%COMP%]{background:#334155;border-color:#475569}body.dark-mode[_nghost-%COMP%]   .theme-selector[_ngcontent-%COMP%]   label[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   .theme-selector[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:#f8fafc}body.dark-mode[_nghost-%COMP%]   .theme-btn[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   .theme-btn[_ngcontent-%COMP%]{background:#1e293b;color:#cbd5e1;border-color:#475569}body.dark-mode[_nghost-%COMP%]   .theme-btn[_ngcontent-%COMP%]:hover, body.dark-mode   [_nghost-%COMP%]   .theme-btn[_ngcontent-%COMP%]:hover{border-color:#64b5f6;background:#0f172a}body.dark-mode[_nghost-%COMP%]   .theme-btn.active[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   .theme-btn.active[_ngcontent-%COMP%]{background:#3b82f6;color:#fff;border-color:#3b82f6;box-shadow:0 2px 8px #3b82f64d}"]});let i=r;return i})();function p0(i,r){if(i&1){let n=S();s(0,"form",8),v("ngSubmit",function(){f(n);let t=u();return h(t.onSubmit())}),s(1,"div",9)(2,"label",10),p(3,"Nouveau mot de passe"),l(),s(4,"div",11)(5,"input",12),v("ngModelChange",function(t){f(n);let o=u();return h(o.newPassword.set(t))}),l(),s(6,"button",13),v("click",function(){f(n);let t=u();return h(t.toggleNewPasswordVisibility())}),y(7,"lucide-icon",14),l()()(),s(8,"div",9)(9,"label",15),p(10,"Confirmer le mot de passe"),l(),s(11,"div",11)(12,"input",16),v("ngModelChange",function(t){f(n);let o=u();return h(o.confirmPassword.set(t))}),l(),s(13,"button",13),v("click",function(){f(n);let t=u();return h(t.toggleConfirmPasswordVisibility())}),y(14,"lucide-icon",14),l()()(),s(15,"button",17),p(16),l()()}if(i&2){let n=u();c(5),g("type",n.showNewPassword()?"text":"password")("ngModel",n.newPassword())("disabled",n.loading),c(2),g("img",n.showNewPassword()?n.EyeOff:n.Eye),c(5),g("type",n.showConfirmPassword()?"text":"password")("ngModel",n.confirmPassword())("disabled",n.loading),c(2),g("img",n.showConfirmPassword()?n.EyeOff:n.Eye),c(),g("disabled",n.loading),c(),P(" ",n.loading?"Mise \xE0 jour...":"Mettre \xE0 jour le mot de passe"," ")}}function u0(i,r){if(i&1&&(s(0,"div",18),p(1),l()),i&2){let n=u();c(),P(" ",n.error()," ")}}function m0(i,r){if(i&1&&(s(0,"div",19),p(1),l()),i&2){let n=u();c(),P(" ",n.message()," ")}}var Ts=(()=>{let r=class r{constructor(){this.newPassword=ee(""),this.confirmPassword=ee(""),this.showNewPassword=ee(!1),this.showConfirmPassword=ee(!1),this.message=ee(null),this.error=ee(null),this.loading=!1,this.success=!1,this.Eye=Qt,this.EyeOff=Yt,this.supabaseService=j(H),this.router=j(pe)}ngOnInit(){return _(this,null,function*(){let{data:e}=yield this.supabaseService.getSession();e.session||this.error.set("Session invalide. Veuillez demander un nouveau lien de r\xE9initialisation.")})}toggleNewPasswordVisibility(){this.showNewPassword.update(e=>!e)}toggleConfirmPasswordVisibility(){this.showConfirmPassword.update(e=>!e)}onSubmit(){return _(this,null,function*(){if(this.error.set(null),this.message.set(null),this.newPassword().length<6){this.error.set("Le mot de passe doit contenir au moins 6 caract\xE8res.");return}if(this.newPassword()!==this.confirmPassword()){this.error.set("Les mots de passe ne correspondent pas.");return}this.loading=!0;try{let{error:e}=yield this.supabaseService.updatePassword(this.newPassword());e?this.error.set("Erreur : "+e.message):(this.message.set("Mot de passe mis \xE0 jour avec succ\xE8s !"),this.success=!0)}catch(e){this.error.set("Une erreur est survenue : "+e.message)}finally{this.loading=!1}})}goToProfile(){this.router.navigate(["/profile"])}goToLogin(){this.router.navigate(["/login"])}};r.\u0275fac=function(t){return new(t||r)},r.\u0275cmp=B({type:r,selectors:[["app-update-password"]],decls:13,vars:3,consts:[[1,"update-password-container"],[1,"update-password-card"],[1,"subtitle"],[3,"ngSubmit",4,"ngIf"],["class","message error",4,"ngIf"],["class","message success",4,"ngIf"],[1,"profile-button",3,"click"],[1,"login-button",3,"click"],[3,"ngSubmit"],[1,"form-group"],["for","newPassword"],[1,"password-container"],["id","newPassword","name","newPassword","required","","minlength","6","placeholder","Minimum 6 caract\xE8res","autocomplete","new-password",3,"ngModelChange","type","ngModel","disabled"],["type","button","tabindex","-1",1,"toggle-password",3,"click"],["size","20",3,"img"],["for","confirmPassword"],["id","confirmPassword","name","confirmPassword","required","","minlength","6","placeholder","Confirmez votre mot de passe","autocomplete","new-password",3,"ngModelChange","type","ngModel","disabled"],["type","submit",3,"disabled"],[1,"message","error"],[1,"message","success"]],template:function(t,o){t&1&&(s(0,"div",0)(1,"div",1)(2,"h2"),p(3,"Mettre \xE0 jour votre mot de passe"),l(),s(4,"p",2),p(5,"Veuillez entrer votre nouveau mot de passe"),l(),w(6,p0,17,10,"form",3)(7,u0,2,1,"div",4)(8,m0,2,1,"div",5),s(9,"button",6),v("click",function(){return o.goToProfile()}),p(10,"Retour au profil"),l(),s(11,"button",7),v("click",function(){return o.goToLogin()}),p(12,"Retour \xE0 la connexion"),l()()()),t&2&&(c(6),g("ngIf",!o.success&&(!o.error()||o.newPassword())),c(),g("ngIf",o.error()),c(),g("ngIf",o.message()))},dependencies:[X,Te,ie,oe,ke,Ie,pi,re,Ee,G,te,K,ne],styles:[".update-password-container[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;min-height:100vh;background-color:#f3f4f6;padding:1rem}.update-password-card[_ngcontent-%COMP%]{background:#fff;padding:2rem;border-radius:8px;box-shadow:0 4px 6px -1px #0000001a;width:100%;max-width:400px}h2[_ngcontent-%COMP%]{text-align:center;color:#1e293b;margin-bottom:.5rem}.subtitle[_ngcontent-%COMP%]{text-align:center;color:#64748b;margin-bottom:2rem;font-size:.875rem}.form-group[_ngcontent-%COMP%]{margin-bottom:1rem}label[_ngcontent-%COMP%]{display:block;margin-bottom:.5rem;color:#475569;font-weight:500}input[_ngcontent-%COMP%]{width:100%;padding:.75rem;border:1px solid #e2e8f0;border-radius:6px;font-size:1rem;box-sizing:border-box}input[_ngcontent-%COMP%]:focus{outline:none;border-color:#2563eb;ring:2px solid #2563eb}button[type=submit][_ngcontent-%COMP%]{width:100%;padding:.75rem;background:#2563eb;color:#fff;border:none;border-radius:6px;font-size:1rem;font-weight:500;cursor:pointer;transition:background .2s;margin-top:1rem}button[type=submit][_ngcontent-%COMP%]:hover{background:#1d4ed8}button[type=submit][_ngcontent-%COMP%]:disabled{background:#94a3b8;cursor:not-allowed}.message[_ngcontent-%COMP%]{padding:1rem;border-radius:6px;margin-top:1rem;text-align:center}.error[_ngcontent-%COMP%]{background:#fee2e2;color:#991b1b}.success[_ngcontent-%COMP%]{background:#dcfce7;color:#166534}.profile-button[_ngcontent-%COMP%], .login-button[_ngcontent-%COMP%]{width:100%;padding:.75rem;background:#fff;color:#64748b;border:1px solid #e2e8f0;border-radius:6px;font-size:.875rem;font-weight:500;cursor:pointer;transition:all .2s;margin-top:.5rem}.profile-button[_ngcontent-%COMP%]:hover, .login-button[_ngcontent-%COMP%]:hover{background:#f8fafc;color:#1e293b;border-color:#cbd5e1}.password-container[_ngcontent-%COMP%]{position:relative;display:flex;align-items:center}.toggle-password[_ngcontent-%COMP%]{position:absolute;right:10px;background:none;border:none;cursor:pointer;padding:0;display:flex;align-items:center;color:#64748b}.toggle-password[_ngcontent-%COMP%]:hover{background:none;color:#1e293b}body.dark-mode[_nghost-%COMP%]   .update-password-container[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   .update-password-container[_ngcontent-%COMP%]{background-color:#0f172a}body.dark-mode[_nghost-%COMP%]   .update-password-card[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   .update-password-card[_ngcontent-%COMP%]{background:#1e293b;box-shadow:0 4px 6px -1px #00000080}body.dark-mode[_nghost-%COMP%]   h2[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   h2[_ngcontent-%COMP%]{color:#f8fafc}body.dark-mode[_nghost-%COMP%]   .subtitle[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   .subtitle[_ngcontent-%COMP%]{color:#cbd5e1}body.dark-mode[_nghost-%COMP%]   label[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   label[_ngcontent-%COMP%]{color:#e2e8f0}body.dark-mode[_nghost-%COMP%]   input[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   input[_ngcontent-%COMP%]{background:#334155;border-color:#475569;color:#f8fafc}body.dark-mode[_nghost-%COMP%]   input[_ngcontent-%COMP%]:focus, body.dark-mode   [_nghost-%COMP%]   input[_ngcontent-%COMP%]:focus{border-color:#3b82f6}body.dark-mode[_nghost-%COMP%]   .toggle-password[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   .toggle-password[_ngcontent-%COMP%]{color:#94a3b8}body.dark-mode[_nghost-%COMP%]   .toggle-password[_ngcontent-%COMP%]:hover, body.dark-mode   [_nghost-%COMP%]   .toggle-password[_ngcontent-%COMP%]:hover{color:#f8fafc}body.dark-mode[_nghost-%COMP%]   .error[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   .error[_ngcontent-%COMP%]{background:#7f1d1d;color:#fecaca}body.dark-mode[_nghost-%COMP%]   .success[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   .success[_ngcontent-%COMP%]{background:#14532d;color:#bbf7d0}body.dark-mode[_nghost-%COMP%]   .profile-button[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   .profile-button[_ngcontent-%COMP%], body.dark-mode[_nghost-%COMP%]   .login-button[_ngcontent-%COMP%], body.dark-mode   [_nghost-%COMP%]   .login-button[_ngcontent-%COMP%]{background:#334155;color:#e2e8f0;border-color:#475569}body.dark-mode[_nghost-%COMP%]   .profile-button[_ngcontent-%COMP%]:hover, body.dark-mode   [_nghost-%COMP%]   .profile-button[_ngcontent-%COMP%]:hover, body.dark-mode[_nghost-%COMP%]   .login-button[_ngcontent-%COMP%]:hover, body.dark-mode   [_nghost-%COMP%]   .login-button[_ngcontent-%COMP%]:hover{background:#475569;color:#f8fafc;border-color:#64748b}body.dark-mode[_nghost-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill, body.dark-mode   [_nghost-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill, body.dark-mode[_nghost-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:hover, body.dark-mode   [_nghost-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:hover, body.dark-mode[_nghost-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:focus, body.dark-mode   [_nghost-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:focus, body.dark-mode[_nghost-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:active, body.dark-mode   [_nghost-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:active{-webkit-box-shadow:0 0 0 30px #334155 inset!important;-webkit-text-fill-color:#f8fafc!important;caret-color:#f8fafc}"]});let i=r;return i})();var Is=[{path:"login",component:Ps},{path:"signup",component:Ss},{path:"forgot-password",component:Os},{path:"",canActivate:[ks],children:[{path:"",redirectTo:"/dashboard",pathMatch:"full"},{path:"dashboard",component:Ms},{path:"organisation",component:cs},{path:"ressources",component:ds},{path:"capacite",component:us},{path:"projets",component:vs},{path:"plan-globale",component:xs},{path:"jalons",component:bs},{path:"settings",loadComponent:()=>import("./chunk-PPD3U3HJ.js").then(i=>i.SettingsComponent)},{path:"profile",component:Es},{path:"update-password",component:Ts}]},{path:"**",redirectTo:"login"}];var g0=(()=>{let r=class r{constructor(e){this.sidebarService=e,this.sidebarCollapsed=!1}ngOnInit(){this.sidebarService.collapsed$.subscribe(e=>{this.sidebarCollapsed=e})}};r.\u0275fac=function(t){return new(t||r)(R(Ui))},r.\u0275cmp=B({type:r,selectors:[["app-root"]],decls:4,vars:2,consts:[[1,"app-layout"],[1,"main-content"]],template:function(t,o){t&1&&(s(0,"div",0),y(1,"app-sidebar-navigation"),s(2,"main",1),y(3,"router-outlet"),l()()),t&2&&(c(2),$("sidebar-collapsed",o.sidebarCollapsed))},dependencies:[G,Un,ss],styles:[".app-layout[_ngcontent-%COMP%]{display:flex;min-height:100vh;overflow-x:hidden}.main-content[_ngcontent-%COMP%]{flex:1;margin-left:256px;transition:margin-left .3s cubic-bezier(.4,0,.2,1);overflow-x:hidden}.main-content.sidebar-collapsed[_ngcontent-%COMP%]{margin-left:80px}"]});let i=r;return i})();Oo(g0,{providers:[Zo(Is)]});export{g0 as App};
